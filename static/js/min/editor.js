/*
 jQuery JavaScript Library v1.4.2
 http://jquery.com/

 Copyright 2010, John Resig
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license

 Includes Sizzle.js
 http://sizzlejs.com/
 Copyright 2010, The Dojo Foundation
 Released under the MIT, BSD, and GPL Licenses.

 Date: Sat Feb 13 22:33:48 2010 -0500
*/
(function(d,c){function h(){if(!f.isReady){try{F.documentElement.doScroll("left")}catch(a){setTimeout(h,1);return}f.ready()}}function m(a,e){e.src?f.ajax({url:e.src,async:false,dataType:"script"}):f.globalEval(e.text||e.textContent||e.innerHTML||"");e.parentNode&&e.parentNode.removeChild(e)}function o(a,e,g,k,l,r){var s=a.length;if(typeof e==="object"){for(var A in e)o(a,A,e[A],k,l,g);return a}if(g!==c){k=!r&&k&&f.isFunction(g);for(A=0;A<s;A++)l(a[A],e,k?g.call(a[A],A,l(a[A],e)):g,r);return a}return s?
l(a[0],e):c}function q(){return(new Date).getTime()}function C(){return false}function H(){return true}function Q(a,e,g){g[0].type=a;return f.event.handle.apply(e,g)}function K(a){var e,g=[],k=[],l=arguments,r,s,A,u,B,G;s=f.data(this,"events");if(!(a.liveFired===this||!s||!s.live||a.button&&a.type==="click")){a.liveFired=this;var L=s.live.slice(0);for(u=0;u<L.length;u++){s=L[u];s.origType.replace(pa,"")===a.type?k.push(s.selector):L.splice(u--,1)}r=f(a.target).closest(k,a.currentTarget);B=0;for(G=
r.length;B<G;B++)for(u=0;u<L.length;u++){s=L[u];if(r[B].selector===s.selector){A=r[B].elem;k=null;if(s.preType==="mouseenter"||s.preType==="mouseleave")k=f(a.relatedTarget).closest(s.selector)[0];if(!k||k!==A)g.push({elem:A,handleObj:s})}}B=0;for(G=g.length;B<G;B++){r=g[B];a.currentTarget=r.elem;a.data=r.handleObj.data;a.handleObj=r.handleObj;if(r.handleObj.origHandler.apply(r.elem,l)===false){e=false;break}}return e}}function O(a,e){return"live."+(a&&a!=="*"?a+".":"")+e.replace(/\./g,"`").replace(/ /g,
"&")}function S(a,e){var g=0;e.each(function(){if(this.nodeName===(a[g]&&a[g].nodeName)){var k=f.data(a[g++]),l=f.data(this,k);if(k=k&&k.events){delete l.handle;l.events={};for(var r in k)for(var s in k[r])f.event.add(this,r,k[r][s],k[r][s].data)}}})}function W(a,e,g){var k,l,r;e=e&&e[0]?e[0].ownerDocument||e[0]:F;if(a.length===1&&typeof a[0]==="string"&&a[0].length<512&&e===F&&!Ka.test(a[0])&&(f.support.checkClone||!La.test(a[0]))){l=true;if(r=f.fragments[a[0]])if(r!==1)k=r}if(!k){k=e.createDocumentFragment();
f.clean(a,e,k,g)}if(l)f.fragments[a[0]]=r?k:1;return{fragment:k,cacheable:l}}function U(a,e){var g={};f.each(Ma.concat.apply([],Ma.slice(0,e)),function(){g[this]=a});return g}function P(a){return"scrollTo"in a&&a.document?a:a.nodeType===9?a.defaultView||a.parentWindow:false}var f=function(a,e){return new f.fn.init(a,e)},Y=d.jQuery,N=d.$,F=d.document,ia,qa=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,ca=/^.[^:#\[\.,]*$/,ea=/\S/,X=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,da=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,aa=navigator.userAgent,
ta=false,ja=[],ba,ua=Object.prototype.toString,ya=Object.prototype.hasOwnProperty,za=Array.prototype.push,ra=Array.prototype.slice,Na=Array.prototype.indexOf;f.fn=f.prototype={init:function(a,e){var g,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a;this.length=1;return this}if(a==="body"&&!e){this.context=F;this[0]=F.body;this.selector="body";this.length=1;return this}if(typeof a==="string")if((g=qa.exec(a))&&(g[1]||!e))if(g[1]){k=e?e.ownerDocument||e:F;if(a=da.exec(a))if(f.isPlainObject(e)){a=
[F.createElement(a[1])];f.fn.attr.call(a,e,true)}else a=[k.createElement(a[1])];else{a=W([g[1]],[k]);a=(a.cacheable?a.fragment.cloneNode(true):a.fragment).childNodes}return f.merge(this,a)}else{if(e=F.getElementById(g[2])){if(e.id!==g[2])return ia.find(a);this.length=1;this[0]=e}this.context=F;this.selector=a;return this}else if(!e&&/^\w+$/.test(a)){this.selector=a;this.context=F;a=F.getElementsByTagName(a);return f.merge(this,a)}else return!e||e.jquery?(e||ia).find(a):f(e).find(a);else if(f.isFunction(a))return ia.ready(a);
if(a.selector!==c){this.selector=a.selector;this.context=a.context}return f.makeArray(a,this)},selector:"",jquery:"1.4.2",length:0,size:function(){return this.length},toArray:function(){return ra.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this.slice(a)[0]:this[a]},pushStack:function(a,e,g){var k=f();f.isArray(a)?za.apply(k,a):f.merge(k,a);k.prevObject=this;k.context=this.context;if(e==="find")k.selector=this.selector+(this.selector?" ":"")+g;else if(e)k.selector=this.selector+
"."+e+"("+g+")";return k},each:function(a,e){return f.each(this,a,e)},ready:function(a){f.bindReady();if(f.isReady)a.call(F,f);else ja&&ja.push(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(ra.apply(this,arguments),"slice",ra.call(arguments).join(","))},map:function(a){return this.pushStack(f.map(this,function(e,g){return a.call(e,g,e)}))},end:function(){return this.prevObject||
f(null)},push:za,sort:[].sort,splice:[].splice};f.fn.init.prototype=f.fn;f.extend=f.fn.extend=function(){var a=arguments[0]||{},e=1,g=arguments.length,k=false,l,r,s,A;if(typeof a==="boolean"){k=a;a=arguments[1]||{};e=2}if(typeof a!=="object"&&!f.isFunction(a))a={};if(g===e){a=this;--e}for(;e<g;e++)if((l=arguments[e])!=null)for(r in l){s=a[r];A=l[r];if(a!==A)if(k&&A&&(f.isPlainObject(A)||f.isArray(A))){s=s&&(f.isPlainObject(s)||f.isArray(s))?s:f.isArray(A)?[]:{};a[r]=f.extend(k,s,A)}else if(A!==c)a[r]=
A}return a};f.extend({noConflict:function(a){d.$=N;if(a)d.jQuery=Y;return f},isReady:false,ready:function(){if(!f.isReady){if(!F.body)return setTimeout(f.ready,13);f.isReady=true;if(ja){for(var a,e=0;a=ja[e++];)a.call(F,f);ja=null}f.fn.triggerHandler&&f(F).triggerHandler("ready")}},bindReady:function(){if(!ta){ta=true;if(F.readyState==="complete")return f.ready();if(F.addEventListener){F.addEventListener("DOMContentLoaded",ba,false);d.addEventListener("load",f.ready,false)}else if(F.attachEvent){F.attachEvent("onreadystatechange",
ba);d.attachEvent("onload",f.ready);var a=false;try{a=d.frameElement==null}catch(e){}F.documentElement.doScroll&&a&&h()}}},isFunction:function(a){return ua.call(a)==="[object Function]"},isArray:function(a){return ua.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||ua.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!ya.call(a,"constructor")&&!ya.call(a.constructor.prototype,"isPrototypeOf"))return false;var e;for(e in a);return e===c||ya.call(a,e)},
isEmptyObject:function(a){for(var e in a)return false;return true},error:function(a){throw a;},parseJSON:function(a){if(typeof a!=="string"||!a)return null;a=f.trim(a);if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d.JSON&&d.JSON.parse?d.JSON.parse(a):(new Function("return "+a))();else f.error("Invalid JSON: "+a)},noop:function(){},globalEval:function(a){if(a&&
ea.test(a)){var e=F.getElementsByTagName("head")[0]||F.documentElement,g=F.createElement("script");g.type="text/javascript";if(f.support.scriptEval)g.appendChild(F.createTextNode(a));else g.text=a;e.insertBefore(g,e.firstChild);e.removeChild(g)}},nodeName:function(a,e){return a.nodeName&&a.nodeName.toUpperCase()===e.toUpperCase()},each:function(a,e,g){var k,l=0,r=a.length,s=r===c||f.isFunction(a);if(g)if(s)for(k in a){if(e.apply(a[k],g)===false)break}else for(;l<r;){if(e.apply(a[l++],g)===false)break}else if(s)for(k in a){if(e.call(a[k],
k,a[k])===false)break}else for(g=a[0];l<r&&e.call(g,l,g)!==false;g=a[++l]);return a},trim:function(a){return(a||"").replace(X,"")},makeArray:function(a,e){e=e||[];if(a!=null)a.length==null||typeof a==="string"||f.isFunction(a)||typeof a!=="function"&&a.setInterval?za.call(e,a):f.merge(e,a);return e},inArray:function(a,e){if(e.indexOf)return e.indexOf(a);for(var g=0,k=e.length;g<k;g++)if(e[g]===a)return g;return-1},merge:function(a,e){var g=a.length,k=0;if(typeof e.length==="number")for(var l=e.length;k<
l;k++)a[g++]=e[k];else for(;e[k]!==c;)a[g++]=e[k++];a.length=g;return a},grep:function(a,e,g){for(var k=[],l=0,r=a.length;l<r;l++)!g!==!e(a[l],l)&&k.push(a[l]);return k},map:function(a,e,g){for(var k=[],l,r=0,s=a.length;r<s;r++){l=e(a[r],r,g);if(l!=null)k[k.length]=l}return k.concat.apply([],k)},guid:1,proxy:function(a,e,g){if(arguments.length===2)if(typeof e==="string"){g=a;a=g[e];e=c}else if(e&&!f.isFunction(e)){g=e;e=c}if(!e&&a)e=function(){return a.apply(g||this,arguments)};if(a)e.guid=a.guid=
a.guid||e.guid||f.guid++;return e},uaMatch:function(a){a=a.toLowerCase();a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},browser:{}});aa=f.uaMatch(aa);if(aa.browser){f.browser[aa.browser]=true;f.browser.version=aa.version}if(f.browser.webkit)f.browser.safari=true;if(Na)f.inArray=function(a,e){return Na.call(e,a)};ia=f(F);if(F.addEventListener)ba=
function(){F.removeEventListener("DOMContentLoaded",ba,false);f.ready()};else if(F.attachEvent)ba=function(){if(F.readyState==="complete"){F.detachEvent("onreadystatechange",ba);f.ready()}};(function(){f.support={};var a=F.documentElement,e=F.createElement("script"),g=F.createElement("div"),k="script"+q();g.style.display="none";g.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var l=g.getElementsByTagName("*"),r=g.getElementsByTagName("a")[0];
if(!(!l||!l.length||!r)){f.support={leadingWhitespace:g.firstChild.nodeType===3,tbody:!g.getElementsByTagName("tbody").length,htmlSerialize:!!g.getElementsByTagName("link").length,style:/red/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.55$/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:g.getElementsByTagName("input")[0].value==="on",optSelected:F.createElement("select").appendChild(F.createElement("option")).selected,parentNode:g.removeChild(g.appendChild(F.createElement("div"))).parentNode===
null,deleteExpando:true,checkClone:false,scriptEval:false,noCloneEvent:true,boxModel:null};e.type="text/javascript";try{e.appendChild(F.createTextNode("window."+k+"=1;"))}catch(s){}a.insertBefore(e,a.firstChild);if(d[k]){f.support.scriptEval=true;delete d[k]}try{delete e.test}catch(A){f.support.deleteExpando=false}a.removeChild(e);if(g.attachEvent&&g.fireEvent){g.attachEvent("onclick",function u(){f.support.noCloneEvent=false;g.detachEvent("onclick",u)});g.cloneNode(true).fireEvent("onclick")}g=F.createElement("div");
g.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";a=F.createDocumentFragment();a.appendChild(g.firstChild);f.support.checkClone=a.cloneNode(true).cloneNode(true).lastChild.checked;f(function(){var u=F.createElement("div");u.style.width=u.style.paddingLeft="1px";F.body.appendChild(u);f.boxModel=f.support.boxModel=u.offsetWidth===2;F.body.removeChild(u).style.display="none"});a=function(u){var B=F.createElement("div");u="on"+u;var G=u in B;if(!G){B.setAttribute(u,"return;");G=typeof B[u]===
"function"}return G};f.support.submitBubbles=a("submit");f.support.changeBubbles=a("change");a=e=g=l=r=null}})();f.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};var ka="jQuery"+q(),eb=0,Oa={};f.extend({cache:{},expando:ka,noData:{embed:true,object:true,applet:true},data:function(a,e,g){if(!(a.nodeName&&f.noData[a.nodeName.toLowerCase()])){a=
a==d?Oa:a;var k=a[ka],l=f.cache;if(!k&&typeof e==="string"&&g===c)return null;k||(k=++eb);if(typeof e==="object"){a[ka]=k;l[k]=f.extend(true,{},e)}else if(!l[k]){a[ka]=k;l[k]={}}a=l[k];if(g!==c)a[e]=g;return typeof e==="string"?a[e]:a}},removeData:function(a,e){if(!(a.nodeName&&f.noData[a.nodeName.toLowerCase()])){a=a==d?Oa:a;var g=a[ka],k=f.cache,l=k[g];if(e){if(l){delete l[e];f.isEmptyObject(l)&&f.removeData(a)}}else{if(f.support.deleteExpando)delete a[f.expando];else a.removeAttribute&&a.removeAttribute(f.expando);
delete k[g]}}}});f.fn.extend({data:function(a,e){if(typeof a==="undefined"&&this.length)return f.data(this[0]);else if(typeof a==="object")return this.each(function(){f.data(this,a)});var g=a.split(".");g[1]=g[1]?"."+g[1]:"";if(e===c){var k=this.triggerHandler("getData"+g[1]+"!",[g[0]]);if(k===c&&this.length)k=f.data(this[0],a);return k===c&&g[1]?this.data(g[0]):k}else return this.trigger("setData"+g[1]+"!",[g[0],e]).each(function(){f.data(this,a,e)})},removeData:function(a){return this.each(function(){f.removeData(this,
a)})}});f.extend({queue:function(a,e,g){if(a){e=(e||"fx")+"queue";var k=f.data(a,e);if(!g)return k||[];if(!k||f.isArray(g))k=f.data(a,e,f.makeArray(g));else k.push(g);return k}},dequeue:function(a,e){e=e||"fx";var g=f.queue(a,e),k=g.shift();if(k==="inprogress")k=g.shift();if(k){e==="fx"&&g.unshift("inprogress");k.call(a,function(){f.dequeue(a,e)})}}});f.fn.extend({queue:function(a,e){if(typeof a!=="string"){e=a;a="fx"}if(e===c)return f.queue(this[0],a);return this.each(function(){var g=f.queue(this,
a,e);a==="fx"&&g[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,e){a=f.fx?f.fx.speeds[a]||a:a;e=e||"fx";return this.queue(e,function(){var g=this;setTimeout(function(){f.dequeue(g,e)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])}});var Pa=/[\n\t]/g,Aa=/\s+/,fb=/\r/g,gb=/href|src|style/,hb=/(button|input)/i,ib=/(button|input|object|select|textarea)/i,jb=/^(a|area)$/i,Qa=/radio|checkbox/;f.fn.extend({attr:function(a,
e){return o(this,a,e,true,f.attr)},removeAttr:function(a){return this.each(function(){f.attr(this,a,"");this.nodeType===1&&this.removeAttribute(a)})},addClass:function(a){if(f.isFunction(a))return this.each(function(B){var G=f(this);G.addClass(a.call(this,B,G.attr("class")))});if(a&&typeof a==="string")for(var e=(a||"").split(Aa),g=0,k=this.length;g<k;g++){var l=this[g];if(l.nodeType===1)if(l.className){for(var r=" "+l.className+" ",s=l.className,A=0,u=e.length;A<u;A++)if(r.indexOf(" "+e[A]+" ")<
0)s+=" "+e[A];l.className=f.trim(s)}else l.className=a}return this},removeClass:function(a){if(f.isFunction(a))return this.each(function(u){var B=f(this);B.removeClass(a.call(this,u,B.attr("class")))});if(a&&typeof a==="string"||a===c)for(var e=(a||"").split(Aa),g=0,k=this.length;g<k;g++){var l=this[g];if(l.nodeType===1&&l.className)if(a){for(var r=(" "+l.className+" ").replace(Pa," "),s=0,A=e.length;s<A;s++)r=r.replace(" "+e[s]+" "," ");l.className=f.trim(r)}else l.className=""}return this},toggleClass:function(a,
e){var g=typeof a,k=typeof e==="boolean";if(f.isFunction(a))return this.each(function(l){var r=f(this);r.toggleClass(a.call(this,l,r.attr("class"),e),e)});return this.each(function(){if(g==="string")for(var l,r=0,s=f(this),A=e,u=a.split(Aa);l=u[r++];){A=k?A:!s.hasClass(l);s[A?"addClass":"removeClass"](l)}else if(g==="undefined"||g==="boolean"){this.className&&f.data(this,"__className__",this.className);this.className=this.className||a===false?"":f.data(this,"__className__")||""}})},hasClass:function(a){a=
" "+a+" ";for(var e=0,g=this.length;e<g;e++)if((" "+this[e].className+" ").replace(Pa," ").indexOf(a)>-1)return true;return false},val:function(a){if(a===c){var e=this[0];if(e){if(f.nodeName(e,"option"))return(e.attributes.value||{}).specified?e.value:e.text;if(f.nodeName(e,"select")){var g=e.selectedIndex,k=[],l=e.options;e=e.type==="select-one";if(g<0)return null;var r=e?g:0;for(g=e?g+1:l.length;r<g;r++){var s=l[r];if(s.selected){a=f(s).val();if(e)return a;k.push(a)}}return k}if(Qa.test(e.type)&&
!f.support.checkOn)return e.getAttribute("value")===null?"on":e.value;return(e.value||"").replace(fb,"")}return c}var A=f.isFunction(a);return this.each(function(u){var B=f(this),G=a;if(this.nodeType===1){if(A)G=a.call(this,u,B.val());if(typeof G==="number")G+="";if(f.isArray(G)&&Qa.test(this.type))this.checked=f.inArray(B.val(),G)>=0;else if(f.nodeName(this,"select")){var L=f.makeArray(G);f("option",this).each(function(){this.selected=f.inArray(f(this).val(),L)>=0});if(!L.length)this.selectedIndex=
-1}else this.value=G}})}});f.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(a,e,g,k){if(!a||a.nodeType===3||a.nodeType===8)return c;if(k&&e in f.attrFn)return f(a)[e](g);k=a.nodeType!==1||!f.isXMLDoc(a);var l=g!==c;e=k&&f.props[e]||e;if(a.nodeType===1){var r=gb.test(e);if(e in a&&k&&!r){if(l){e==="type"&&hb.test(a.nodeName)&&a.parentNode&&f.error("type property can't be changed");a[e]=g}if(f.nodeName(a,"form")&&a.getAttributeNode(e))return a.getAttributeNode(e).nodeValue;
if(e==="tabIndex")return(e=a.getAttributeNode("tabIndex"))&&e.specified?e.value:ib.test(a.nodeName)||jb.test(a.nodeName)&&a.href?0:c;return a[e]}if(!f.support.style&&k&&e==="style"){if(l)a.style.cssText=""+g;return a.style.cssText}l&&a.setAttribute(e,""+g);a=!f.support.hrefNormalized&&k&&r?a.getAttribute(e,2):a.getAttribute(e);return a===null?c:a}return f.style(a,e,g)}});var pa=/\.(.*)$/,kb=function(a){return a.replace(/[^\w\s\.\|`]/g,function(e){return"\\"+e})};f.event={add:function(a,e,g,k){if(!(a.nodeType===
3||a.nodeType===8)){if(a.setInterval&&a!==d&&!a.frameElement)a=d;var l,r;if(g.handler){l=g;g=l.handler}if(!g.guid)g.guid=f.guid++;if(r=f.data(a)){var s=r.events=r.events||{},A=r.handle;if(!A)r.handle=A=function(){return typeof f!=="undefined"&&!f.event.triggered?f.event.handle.apply(A.elem,arguments):c};A.elem=a;e=e.split(" ");for(var u,B=0,G;u=e[B++];){r=l?f.extend({},l):{handler:g,data:k};if(u.indexOf(".")>-1){G=u.split(".");u=G.shift();r.namespace=G.slice(0).sort().join(".")}else{G=[];r.namespace=
""}r.type=u;r.guid=g.guid;var L=s[u],T=f.event.special[u]||{};if(!L){L=s[u]=[];if(!T.setup||T.setup.call(a,k,G,A)===false)if(a.addEventListener)a.addEventListener(u,A,false);else a.attachEvent&&a.attachEvent("on"+u,A)}if(T.add){T.add.call(a,r);if(!r.handler.guid)r.handler.guid=g.guid}L.push(r);f.event.global[u]=true}a=null}}},global:{},remove:function(a,e,g,k){if(!(a.nodeType===3||a.nodeType===8)){var l,r=0,s,A,u,B,G,L,T=f.data(a),Z=T&&T.events;if(T&&Z){if(e&&e.type){g=e.handler;e=e.type}if(!e||typeof e===
"string"&&e.charAt(0)==="."){e=e||"";for(l in Z)f.event.remove(a,l+e)}else{for(e=e.split(" ");l=e[r++];){B=l;s=l.indexOf(".")<0;A=[];if(!s){A=l.split(".");l=A.shift();u=RegExp("(^|\\.)"+f.map(A.slice(0).sort(),kb).join("\\.(?:.*\\.)?")+"(\\.|$)")}if(G=Z[l])if(g){B=f.event.special[l]||{};for(V=k||0;V<G.length;V++){L=G[V];if(g.guid===L.guid){if(s||u.test(L.namespace)){k==null&&G.splice(V--,1);B.remove&&B.remove.call(a,L)}if(k!=null)break}}if(G.length===0||k!=null&&G.length===1){if(!B.teardown||B.teardown.call(a,
A)===false)Ra(a,l,T.handle);delete Z[l]}}else for(var V=0;V<G.length;V++){L=G[V];if(s||u.test(L.namespace)){f.event.remove(a,B,L.handler,V);G.splice(V--,1)}}}if(f.isEmptyObject(Z)){if(e=T.handle)e.elem=null;delete T.events;delete T.handle;f.isEmptyObject(T)&&f.removeData(a)}}}}},trigger:function(a,e,g,k){var l=a.type||a;if(!k){a=typeof a==="object"?a[ka]?a:f.extend(f.Event(l),a):f.Event(l);if(l.indexOf("!")>=0){a.type=l=l.slice(0,-1);a.exclusive=true}if(!g){a.stopPropagation();f.event.global[l]&&
f.each(f.cache,function(){this.events&&this.events[l]&&f.event.trigger(a,e,this.handle.elem)})}if(!g||g.nodeType===3||g.nodeType===8)return c;a.result=c;a.target=g;e=f.makeArray(e);e.unshift(a)}a.currentTarget=g;(k=f.data(g,"handle"))&&k.apply(g,e);k=g.parentNode||g.ownerDocument;try{if(!(g&&g.nodeName&&f.noData[g.nodeName.toLowerCase()]))if(g["on"+l]&&g["on"+l].apply(g,e)===false)a.result=false}catch(r){}if(!a.isPropagationStopped()&&k)f.event.trigger(a,e,k,true);else if(!a.isDefaultPrevented()){k=
a.target;var s,A=f.nodeName(k,"a")&&l==="click",u=f.event.special[l]||{};if((!u._default||u._default.call(g,a)===false)&&!A&&!(k&&k.nodeName&&f.noData[k.nodeName.toLowerCase()])){try{if(k[l]){if(s=k["on"+l])k["on"+l]=null;f.event.triggered=true;k[l]()}}catch(B){}if(s)k["on"+l]=s;f.event.triggered=false}}},handle:function(a){var e,g,k,l;a=arguments[0]=f.event.fix(a||d.event);a.currentTarget=this;e=a.type.indexOf(".")<0&&!a.exclusive;if(!e){g=a.type.split(".");a.type=g.shift();k=RegExp("(^|\\.)"+g.slice(0).sort().join("\\.(?:.*\\.)?")+
"(\\.|$)")}l=f.data(this,"events");g=l[a.type];if(l&&g){g=g.slice(0);l=0;for(var r=g.length;l<r;l++){var s=g[l];if(e||k.test(s.namespace)){a.handler=s.handler;a.data=s.data;a.handleObj=s;s=s.handler.apply(this,arguments);if(s!==c){a.result=s;if(s===false){a.preventDefault();a.stopPropagation()}}if(a.isImmediatePropagationStopped())break}}}return a.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[ka])return a;var e=a;a=f.Event(e);for(var g=this.props.length,k;g;){k=this.props[--g];a[k]=e[k]}if(!a.target)a.target=a.srcElement||F;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){e=F.documentElement;g=F.body;a.pageX=a.clientX+(e&&e.scrollLeft||g&&g.scrollLeft||0)-(e&&e.clientLeft||g&&g.clientLeft||0);a.pageY=a.clientY+(e&&e.scrollTop||
g&&g.scrollTop||0)-(e&&e.clientTop||g&&g.clientTop||0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==c)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;return a},guid:1E8,proxy:f.proxy,special:{ready:{setup:f.bindReady,teardown:f.noop},live:{add:function(a){f.event.add(this,a.origType,f.extend({},a,{handler:K}))},remove:function(a){var e=true,g=a.origType.replace(pa,"");f.each(f.data(this,
"events").live||[],function(){if(g===this.origType.replace(pa,""))return e=false});e&&f.event.remove(this,a.origType,K)}},beforeunload:{setup:function(a,e,g){if(this.setInterval)this.onbeforeunload=g;return false},teardown:function(a,e){if(this.onbeforeunload===e)this.onbeforeunload=null}}}};var Ra=F.removeEventListener?function(a,e,g){a.removeEventListener(e,g,false)}:function(a,e,g){a.detachEvent("on"+e,g)};f.Event=function(a){if(!this.preventDefault)return new f.Event(a);if(a&&a.type){this.originalEvent=
a;this.type=a.type}else this.type=a;this.timeStamp=q();this[ka]=true};f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=H;var a=this.originalEvent;if(a){a.preventDefault&&a.preventDefault();a.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=H;var a=this.originalEvent;if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=H;this.stopPropagation()},isDefaultPrevented:C,isPropagationStopped:C,
isImmediatePropagationStopped:C};var Sa=function(a){var e=a.relatedTarget;try{for(;e&&e!==this;)e=e.parentNode;if(e!==this){a.type=a.data;f.event.handle.apply(this,arguments)}}catch(g){}},Ta=function(a){a.type=a.data;f.event.handle.apply(this,arguments)};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,e){f.event.special[a]={setup:function(g){f.event.add(this,e,g&&g.selector?Ta:Sa,a)},teardown:function(g){f.event.remove(this,e,g&&g.selector?Ta:Sa)}}});if(!f.support.submitBubbles)f.event.special.submit=
{setup:function(){if(this.nodeName.toLowerCase()!=="form"){f.event.add(this,"click.specialSubmit",function(a){var e=a.target,g=e.type;if((g==="submit"||g==="image")&&f(e).closest("form").length)return Q("submit",this,arguments)});f.event.add(this,"keypress.specialSubmit",function(a){var e=a.target,g=e.type;if((g==="text"||g==="password")&&f(e).closest("form").length&&a.keyCode===13)return Q("submit",this,arguments)})}else return false},teardown:function(){f.event.remove(this,".specialSubmit")}};if(!f.support.changeBubbles){var Ba=
/textarea|input|select/i,Ca,Ua=function(a){var e=a.type,g=a.value;if(e==="radio"||e==="checkbox")g=a.checked;else if(e==="select-multiple")g=a.selectedIndex>-1?f.map(a.options,function(k){return k.selected}).join("-"):"";else if(a.nodeName.toLowerCase()==="select")g=a.selectedIndex;return g},Da=function(a,e){var g=a.target,k,l;if(!(!Ba.test(g.nodeName)||g.readOnly)){k=f.data(g,"_change_data");l=Ua(g);if(a.type!=="focusout"||g.type!=="radio")f.data(g,"_change_data",l);if(!(k===c||l===k))if(k!=null||
l){a.type="change";return f.event.trigger(a,e,g)}}};f.event.special.change={filters:{focusout:Da,click:function(a){var e=a.target,g=e.type;if(g==="radio"||g==="checkbox"||e.nodeName.toLowerCase()==="select")return Da.call(this,a)},keydown:function(a){var e=a.target,g=e.type;if(a.keyCode===13&&e.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(g==="checkbox"||g==="radio")||g==="select-multiple")return Da.call(this,a)},beforeactivate:function(a){a=a.target;f.data(a,"_change_data",Ua(a))}},setup:function(){if(this.type===
"file")return false;for(var a in Ca)f.event.add(this,a+".specialChange",Ca[a]);return Ba.test(this.nodeName)},teardown:function(){f.event.remove(this,".specialChange");return Ba.test(this.nodeName)}};Ca=f.event.special.change.filters}F.addEventListener&&f.each({focus:"focusin",blur:"focusout"},function(a,e){function g(k){k=f.event.fix(k);k.type=e;return f.event.handle.call(this,k)}f.event.special[e]={setup:function(){this.addEventListener(a,g,true)},teardown:function(){this.removeEventListener(a,
g,true)}}});f.each(["bind","one"],function(a,e){f.fn[e]=function(g,k,l){if(typeof g==="object"){for(var r in g)this[e](r,k,g[r],l);return this}if(f.isFunction(k)){l=k;k=c}var s=e==="one"?f.proxy(l,function(u){f(this).unbind(u,s);return l.apply(this,arguments)}):l;if(g==="unload"&&e!=="one")this.one(g,k,l);else{r=0;for(var A=this.length;r<A;r++)f.event.add(this[r],g,s,k)}return this}});f.fn.extend({unbind:function(a,e){if(typeof a==="object"&&!a.preventDefault)for(var g in a)this.unbind(g,a[g]);else{g=
0;for(var k=this.length;g<k;g++)f.event.remove(this[g],a,e)}return this},delegate:function(a,e,g,k){return this.live(e,g,k,a)},undelegate:function(a,e,g){return arguments.length===0?this.unbind("live"):this.die(e,null,g,a)},trigger:function(a,e){return this.each(function(){f.event.trigger(a,e,this)})},triggerHandler:function(a,e){if(this[0]){a=f.Event(a);a.preventDefault();a.stopPropagation();f.event.trigger(a,e,this[0]);return a.result}},toggle:function(a){for(var e=arguments,g=1;g<e.length;)f.proxy(a,
e[g++]);return this.click(f.proxy(a,function(k){var l=(f.data(this,"lastToggle"+a.guid)||0)%g;f.data(this,"lastToggle"+a.guid,l+1);k.preventDefault();return e[l].apply(this,arguments)||false}))},hover:function(a,e){return this.mouseenter(a).mouseleave(e||a)}});var Va={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};f.each(["live","die"],function(a,e){f.fn[e]=function(g,k,l,r){var s,A=0,u,B,G=r||this.selector,L=r?this:f(this.context);if(f.isFunction(k)){l=k;k=c}for(g=
(g||"").split(" ");(s=g[A++])!=null;){r=pa.exec(s);u="";if(r){u=r[0];s=s.replace(pa,"")}if(s==="hover")g.push("mouseenter"+u,"mouseleave"+u);else{B=s;if(s==="focus"||s==="blur"){g.push(Va[s]+u);s+=u}else s=(Va[s]||s)+u;e==="live"?L.each(function(){f.event.add(this,O(s,G),{data:k,selector:G,handler:l,origType:s,origHandler:l,preType:B})}):L.unbind(O(s,G),l)}}return this}});f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),
function(a,e){f.fn[e]=function(g){return g?this.bind(e,g):this.trigger(e)};if(f.attrFn)f.attrFn[e]=true});d.attachEvent&&!d.addEventListener&&d.attachEvent("onunload",function(){for(var a in f.cache)if(f.cache[a].handle)try{f.event.remove(f.cache[a].handle.elem)}catch(e){}});(function(){function a(n){for(var p="",t,z=0;n[z];z++){t=n[z];if(t.nodeType===3||t.nodeType===4)p+=t.nodeValue;else if(t.nodeType!==8)p+=a(t.childNodes)}return p}function e(n,p,t,z,E,D){E=0;for(var J=z.length;E<J;E++){var I=z[E];
if(I){I=I[n];for(var R=false;I;){if(I.sizcache===t){R=z[I.sizset];break}if(I.nodeType===1&&!D){I.sizcache=t;I.sizset=E}if(I.nodeName.toLowerCase()===p){R=I;break}I=I[n]}z[E]=R}}}function g(n,p,t,z,E,D){E=0;for(var J=z.length;E<J;E++){var I=z[E];if(I){I=I[n];for(var R=false;I;){if(I.sizcache===t){R=z[I.sizset];break}if(I.nodeType===1){if(!D){I.sizcache=t;I.sizset=E}if(typeof p!=="string"){if(I===p){R=true;break}}else if(u.filter(p,[I]).length>0){R=I;break}}I=I[n]}z[E]=R}}}var k=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
l=0,r=Object.prototype.toString,s=false,A=true;[0,0].sort(function(){A=false;return 0});var u=function(n,p,t,z){t=t||[];var E=p=p||F;if(p.nodeType!==1&&p.nodeType!==9)return[];if(!n||typeof n!=="string")return t;for(var D=[],J,I,R,sa,la=true,na=M(p),ma=n;(k.exec(""),J=k.exec(ma))!==null;){ma=J[3];D.push(J[1]);if(J[2]){sa=J[3];break}}if(D.length>1&&G.exec(n))if(D.length===2&&B.relative[D[0]])I=Ea(D[0]+D[1],p);else for(I=B.relative[D[0]]?[p]:u(D.shift(),p);D.length;){n=D.shift();if(B.relative[n])n+=
D.shift();I=Ea(n,I)}else{if(!z&&D.length>1&&p.nodeType===9&&!na&&B.match.ID.test(D[0])&&!B.match.ID.test(D[D.length-1])){J=u.find(D.shift(),p,na);p=J.expr?u.filter(J.expr,J.set)[0]:J.set[0]}if(p){J=z?{expr:D.pop(),set:T(z)}:u.find(D.pop(),D.length===1&&(D[0]==="~"||D[0]==="+")&&p.parentNode?p.parentNode:p,na);I=J.expr?u.filter(J.expr,J.set):J.set;if(D.length>0)R=T(I);else la=false;for(;D.length;){var fa=D.pop();J=fa;if(B.relative[fa])J=D.pop();else fa="";if(J==null)J=p;B.relative[fa](R,J,na)}}else R=
[]}R||(R=I);R||u.error(fa||n);if(r.call(R)==="[object Array]")if(la)if(p&&p.nodeType===1)for(n=0;R[n]!=null;n++){if(R[n]&&(R[n]===true||R[n].nodeType===1&&ga(p,R[n])))t.push(I[n])}else for(n=0;R[n]!=null;n++)R[n]&&R[n].nodeType===1&&t.push(I[n]);else t.push.apply(t,R);else T(R,t);if(sa){u(sa,E,t,z);u.uniqueSort(t)}return t};u.uniqueSort=function(n){if(V){s=A;n.sort(V);if(s)for(var p=1;p<n.length;p++)n[p]===n[p-1]&&n.splice(p--,1)}return n};u.matches=function(n,p){return u(n,null,null,p)};u.find=function(n,
p,t){var z,E;if(!n)return[];for(var D=0,J=B.order.length;D<J;D++){var I=B.order[D];if(E=B.leftMatch[I].exec(n)){var R=E[1];E.splice(1,1);if(R.substr(R.length-1)!=="\\"){E[1]=(E[1]||"").replace(/\\/g,"");z=B.find[I](E,p,t);if(z!=null){n=n.replace(B.match[I],"");break}}}}z||(z=p.getElementsByTagName("*"));return{set:z,expr:n}};u.filter=function(n,p,t,z){for(var E=n,D=[],J=p,I,R,sa=p&&p[0]&&M(p[0]);n&&p.length;){for(var la in B.filter)if((I=B.leftMatch[la].exec(n))!=null&&I[2]){var na=B.filter[la],ma,
fa;fa=I[1];R=false;I.splice(1,1);if(fa.substr(fa.length-1)!=="\\"){if(J===D)D=[];if(B.preFilter[la])if(I=B.preFilter[la](I,J,t,D,z,sa)){if(I===true)continue}else R=ma=true;if(I)for(var va=0;(fa=J[va])!=null;va++)if(fa){ma=na(fa,I,va,J);var Wa=z^!!ma;if(t&&ma!=null)if(Wa)R=true;else J[va]=false;else if(Wa){D.push(fa);R=true}}if(ma!==c){t||(J=D);n=n.replace(B.match[la],"");if(!R)return[];break}}}if(n===E)if(R==null)u.error(n);else break;E=n}return J};u.error=function(n){throw"Syntax error, unrecognized expression: "+
n;};var B=u.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},
leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(n){return n.getAttribute("href")}},relative:{"+":function(n,p){var t=typeof p==="string",z=t&&!/\W/.test(p);t=t&&!z;if(z)p=p.toLowerCase();z=0;for(var E=n.length,D;z<E;z++)if(D=n[z]){for(;(D=D.previousSibling)&&D.nodeType!==1;);n[z]=t||D&&D.nodeName.toLowerCase()===p?D||false:D===p}t&&u.filter(p,n,true)},">":function(n,p){var t=typeof p==="string";if(t&&!/\W/.test(p)){p=p.toLowerCase();for(var z=0,E=n.length;z<E;z++){var D=
n[z];if(D){t=D.parentNode;n[z]=t.nodeName.toLowerCase()===p?t:false}}}else{z=0;for(E=n.length;z<E;z++)if(D=n[z])n[z]=t?D.parentNode:D.parentNode===p;t&&u.filter(p,n,true)}},"":function(n,p,t){var z=l++,E=g;if(typeof p==="string"&&!/\W/.test(p)){var D=p=p.toLowerCase();E=e}E("parentNode",p,z,n,D,t)},"~":function(n,p,t){var z=l++,E=g;if(typeof p==="string"&&!/\W/.test(p)){var D=p=p.toLowerCase();E=e}E("previousSibling",p,z,n,D,t)}},find:{ID:function(n,p,t){if(typeof p.getElementById!=="undefined"&&
!t)return(n=p.getElementById(n[1]))?[n]:[]},NAME:function(n,p){if(typeof p.getElementsByName!=="undefined"){var t=[];p=p.getElementsByName(n[1]);for(var z=0,E=p.length;z<E;z++)p[z].getAttribute("name")===n[1]&&t.push(p[z]);return t.length===0?null:t}},TAG:function(n,p){return p.getElementsByTagName(n[1])}},preFilter:{CLASS:function(n,p,t,z,E,D){n=" "+n[1].replace(/\\/g,"")+" ";if(D)return n;D=0;for(var J;(J=p[D])!=null;D++)if(J)if(E^(J.className&&(" "+J.className+" ").replace(/[\t\n]/g," ").indexOf(n)>=
0))t||z.push(J);else if(t)p[D]=false;return false},ID:function(n){return n[1].replace(/\\/g,"")},TAG:function(n){return n[1].toLowerCase()},CHILD:function(n){if(n[1]==="nth"){var p=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(n[2]==="even"&&"2n"||n[2]==="odd"&&"2n+1"||!/\D/.test(n[2])&&"0n+"+n[2]||n[2]);n[2]=p[1]+(p[2]||1)-0;n[3]=p[3]-0}n[0]=l++;return n},ATTR:function(n,p,t,z,E,D){p=n[1].replace(/\\/g,"");if(!D&&B.attrMap[p])n[1]=B.attrMap[p];if(n[2]==="~=")n[4]=" "+n[4]+" ";return n},PSEUDO:function(n,p,t,z,
E){if(n[1]==="not")if((k.exec(n[3])||"").length>1||/^\w/.test(n[3]))n[3]=u(n[3],null,null,p);else{n=u.filter(n[3],p,t,true^E);t||z.push.apply(z,n);return false}else if(B.match.POS.test(n[0])||B.match.CHILD.test(n[0]))return true;return n},POS:function(n){n.unshift(true);return n}},filters:{enabled:function(n){return n.disabled===false&&n.type!=="hidden"},disabled:function(n){return n.disabled===true},checked:function(n){return n.checked===true},selected:function(n){return n.selected===true},parent:function(n){return!!n.firstChild},
empty:function(n){return!n.firstChild},has:function(n,p,t){return!!u(t[3],n).length},header:function(n){return/h\d/i.test(n.nodeName)},text:function(n){return"text"===n.type},radio:function(n){return"radio"===n.type},checkbox:function(n){return"checkbox"===n.type},file:function(n){return"file"===n.type},password:function(n){return"password"===n.type},submit:function(n){return"submit"===n.type},image:function(n){return"image"===n.type},reset:function(n){return"reset"===n.type},button:function(n){return"button"===
n.type||n.nodeName.toLowerCase()==="button"},input:function(n){return/input|select|textarea|button/i.test(n.nodeName)}},setFilters:{first:function(n,p){return p===0},last:function(n,p,t,z){return p===z.length-1},even:function(n,p){return p%2===0},odd:function(n,p){return p%2===1},lt:function(n,p,t){return p<t[3]-0},gt:function(n,p,t){return p>t[3]-0},nth:function(n,p,t){return t[3]-0===p},eq:function(n,p,t){return t[3]-0===p}},filter:{PSEUDO:function(n,p,t,z){var E=p[1],D=B.filters[E];if(D)return D(n,
t,p,z);else if(E==="contains")return(n.textContent||n.innerText||a([n])||"").indexOf(p[3])>=0;else if(E==="not"){p=p[3];t=0;for(z=p.length;t<z;t++)if(p[t]===n)return false;return true}else u.error("Syntax error, unrecognized expression: "+E)},CHILD:function(n,p){var t=p[1],z=n;switch(t){case "only":case "first":for(;z=z.previousSibling;)if(z.nodeType===1)return false;if(t==="first")return true;z=n;case "last":for(;z=z.nextSibling;)if(z.nodeType===1)return false;return true;case "nth":t=p[2];var E=
p[3];if(t===1&&E===0)return true;p=p[0];var D=n.parentNode;if(D&&(D.sizcache!==p||!n.nodeIndex)){var J=0;for(z=D.firstChild;z;z=z.nextSibling)if(z.nodeType===1)z.nodeIndex=++J;D.sizcache=p}n=n.nodeIndex-E;return t===0?n===0:n%t===0&&n/t>=0}},ID:function(n,p){return n.nodeType===1&&n.getAttribute("id")===p},TAG:function(n,p){return p==="*"&&n.nodeType===1||n.nodeName.toLowerCase()===p},CLASS:function(n,p){return(" "+(n.className||n.getAttribute("class"))+" ").indexOf(p)>-1},ATTR:function(n,p){var t=
p[1];n=B.attrHandle[t]?B.attrHandle[t](n):n[t]!=null?n[t]:n.getAttribute(t);t=n+"";var z=p[2];p=p[4];return n==null?z==="!=":z==="="?t===p:z==="*="?t.indexOf(p)>=0:z==="~="?(" "+t+" ").indexOf(p)>=0:!p?t&&n!==false:z==="!="?t!==p:z==="^="?t.indexOf(p)===0:z==="$="?t.substr(t.length-p.length)===p:z==="|="?t===p||t.substr(0,p.length+1)===p+"-":false},POS:function(n,p,t,z){var E=B.setFilters[p[2]];if(E)return E(n,t,p,z)}}},G=B.match.POS;for(var L in B.match){B.match[L]=RegExp(B.match[L].source+/(?![^\[]*\])(?![^\(]*\))/.source);
B.leftMatch[L]=RegExp(/(^(?:.|\r|\n)*?)/.source+B.match[L].source.replace(/\\(\d+)/g,function(n,p){return"\\"+(p-0+1)}))}var T=function(n,p){n=Array.prototype.slice.call(n,0);if(p){p.push.apply(p,n);return p}return n};try{Array.prototype.slice.call(F.documentElement.childNodes,0)}catch(Z){T=function(n,p){p=p||[];if(r.call(n)==="[object Array]")Array.prototype.push.apply(p,n);else if(typeof n.length==="number")for(var t=0,z=n.length;t<z;t++)p.push(n[t]);else for(t=0;n[t];t++)p.push(n[t]);return p}}var V;
if(F.documentElement.compareDocumentPosition)V=function(n,p){if(!n.compareDocumentPosition||!p.compareDocumentPosition){if(n==p)s=true;return n.compareDocumentPosition?-1:1}n=n.compareDocumentPosition(p)&4?-1:n===p?0:1;if(n===0)s=true;return n};else if("sourceIndex"in F.documentElement)V=function(n,p){if(!n.sourceIndex||!p.sourceIndex){if(n==p)s=true;return n.sourceIndex?-1:1}n=n.sourceIndex-p.sourceIndex;if(n===0)s=true;return n};else if(F.createRange)V=function(n,p){if(!n.ownerDocument||!p.ownerDocument){if(n==
p)s=true;return n.ownerDocument?-1:1}var t=n.ownerDocument.createRange(),z=p.ownerDocument.createRange();t.setStart(n,0);t.setEnd(n,0);z.setStart(p,0);z.setEnd(p,0);n=t.compareBoundaryPoints(Range.START_TO_END,z);if(n===0)s=true;return n};(function(){var n=F.createElement("div"),p="script"+(new Date).getTime();n.innerHTML="<a name='"+p+"'/>";var t=F.documentElement;t.insertBefore(n,t.firstChild);if(F.getElementById(p)){B.find.ID=function(z,E,D){if(typeof E.getElementById!=="undefined"&&!D)return(E=
E.getElementById(z[1]))?E.id===z[1]||typeof E.getAttributeNode!=="undefined"&&E.getAttributeNode("id").nodeValue===z[1]?[E]:c:[]};B.filter.ID=function(z,E){var D=typeof z.getAttributeNode!=="undefined"&&z.getAttributeNode("id");return z.nodeType===1&&D&&D.nodeValue===E}}t.removeChild(n);t=n=null})();(function(){var n=F.createElement("div");n.appendChild(F.createComment(""));if(n.getElementsByTagName("*").length>0)B.find.TAG=function(p,t){t=t.getElementsByTagName(p[1]);if(p[1]==="*"){p=[];for(var z=
0;t[z];z++)t[z].nodeType===1&&p.push(t[z]);t=p}return t};n.innerHTML="<a href='#'></a>";if(n.firstChild&&typeof n.firstChild.getAttribute!=="undefined"&&n.firstChild.getAttribute("href")!=="#")B.attrHandle.href=function(p){return p.getAttribute("href",2)};n=null})();F.querySelectorAll&&function(){var n=u,p=F.createElement("div");p.innerHTML="<p class='TEST'></p>";if(!(p.querySelectorAll&&p.querySelectorAll(".TEST").length===0)){u=function(z,E,D,J){E=E||F;if(!J&&E.nodeType===9&&!M(E))try{return T(E.querySelectorAll(z),
D)}catch(I){}return n(z,E,D,J)};for(var t in n)u[t]=n[t];p=null}}();(function(){var n=F.createElement("div");n.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!n.getElementsByClassName||n.getElementsByClassName("e").length===0)){n.lastChild.className="e";if(n.getElementsByClassName("e").length!==1){B.order.splice(1,0,"CLASS");B.find.CLASS=function(p,t,z){if(typeof t.getElementsByClassName!=="undefined"&&!z)return t.getElementsByClassName(p[1])};n=null}}})();var ga=F.compareDocumentPosition?
function(n,p){return!!(n.compareDocumentPosition(p)&16)}:function(n,p){return n!==p&&(n.contains?n.contains(p):true)},M=function(n){return(n=(n?n.ownerDocument||n:0).documentElement)?n.nodeName!=="HTML":false},Ea=function(n,p){var t=[],z="",E;for(p=p.nodeType?[p]:p;E=B.match.PSEUDO.exec(n);){z+=E[0];n=n.replace(B.match.PSEUDO,"")}n=B.relative[n]?n+"*":n;E=0;for(var D=p.length;E<D;E++)u(n,p[E],t);return u.filter(z,t)};f.find=u;f.expr=u.selectors;f.expr[":"]=f.expr.filters;f.unique=u.uniqueSort;f.text=
a;f.isXMLDoc=M;f.contains=ga})();var lb=/Until$/,mb=/^(?:parents|prevUntil|prevAll)/,nb=/,/;ra=Array.prototype.slice;var Xa=function(a,e,g){if(f.isFunction(e))return f.grep(a,function(l,r){return!!e.call(l,r,l)===g});else if(e.nodeType)return f.grep(a,function(l){return l===e===g});else if(typeof e==="string"){var k=f.grep(a,function(l){return l.nodeType===1});if(ca.test(e))return f.filter(e,k,!g);else e=f.filter(e,k)}return f.grep(a,function(l){return f.inArray(l,e)>=0===g})};f.fn.extend({find:function(a){for(var e=
this.pushStack("","find",a),g=0,k=0,l=this.length;k<l;k++){g=e.length;f.find(a,this[k],e);if(k>0)for(var r=g;r<e.length;r++)for(var s=0;s<g;s++)if(e[s]===e[r]){e.splice(r--,1);break}}return e},has:function(a){var e=f(a);return this.filter(function(){for(var g=0,k=e.length;g<k;g++)if(f.contains(this,e[g]))return true})},not:function(a){return this.pushStack(Xa(this,a,false),"not",a)},filter:function(a){return this.pushStack(Xa(this,a,true),"filter",a)},is:function(a){return!!a&&f.filter(a,this).length>
0},closest:function(a,e){if(f.isArray(a)){var g=[],k=this[0],l,r={},s;if(k&&a.length){l=0;for(var A=a.length;l<A;l++){s=a[l];r[s]||(r[s]=f.expr.match.POS.test(s)?f(s,e||this.context):s)}for(;k&&k.ownerDocument&&k!==e;){for(s in r){l=r[s];if(l.jquery?l.index(k)>-1:f(k).is(l)){g.push({selector:s,elem:k});delete r[s]}}k=k.parentNode}}return g}var u=f.expr.match.POS.test(a)?f(a,e||this.context):null;return this.map(function(B,G){for(;G&&G.ownerDocument&&G!==e;){if(u?u.index(G)>-1:f(G).is(a))return G;
G=G.parentNode}return null})},index:function(a){if(!a||typeof a==="string")return f.inArray(this[0],a?f(a):this.parent().children());return f.inArray(a.jquery?a[0]:a,this)},add:function(a,e){a=typeof a==="string"?f(a,e||this.context):f.makeArray(a);e=f.merge(this.get(),a);return this.pushStack(!a[0]||!a[0].parentNode||a[0].parentNode.nodeType===11||!e[0]||!e[0].parentNode||e[0].parentNode.nodeType===11?e:f.unique(e))},andSelf:function(){return this.add(this.prevObject)}});f.each({parent:function(a){return(a=
a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,e,g){return f.dir(a,"parentNode",g)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,e,g){return f.dir(a,"nextSibling",g)},prevUntil:function(a,e,g){return f.dir(a,"previousSibling",g)},siblings:function(a){return f.sibling(a.parentNode.firstChild,
a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,e){f.fn[a]=function(g,k){var l=f.map(this,e,g);lb.test(a)||(k=g);if(k&&typeof k==="string")l=f.filter(k,l);l=this.length>1?f.unique(l):l;if((this.length>1||nb.test(k))&&mb.test(a))l=l.reverse();return this.pushStack(l,a,ra.call(arguments).join(","))}});f.extend({filter:function(a,e,g){if(g)a=":not("+a+")";return f.find.matches(a,
e)},dir:function(a,e,g){var k=[];for(a=a[e];a&&a.nodeType!==9&&(g===c||a.nodeType!==1||!f(a).is(g));){a.nodeType===1&&k.push(a);a=a[e]}return k},nth:function(a,e,g){e=e||1;for(var k=0;a;a=a[g])if(a.nodeType===1&&++k===e)break;return a},sibling:function(a,e){for(var g=[];a;a=a.nextSibling)a.nodeType===1&&a!==e&&g.push(a);return g}});var Ya=/ jQuery\d+="(?:\d+|null)"/g,wa=/^\s+/,Za=/(<([\w:]+)[^>]*?)\/>/g,ob=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,$a=/<([\w:]+)/,pb=/<tbody/i,qb=/<|&#?\w+;/,
Ka=/<script|<object|<embed|<option|<style/i,La=/checked\s*(?:[^=]|=\s*.checked.)/i,ab=function(a,e,g){return ob.test(g)?a:e+"></"+g+">"},ha={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};ha.optgroup=ha.option;ha.tbody=
ha.tfoot=ha.colgroup=ha.caption=ha.thead;ha.th=ha.td;if(!f.support.htmlSerialize)ha._default=[1,"div<div>","</div>"];f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(e){var g=f(this);g.text(a.call(this,e,g.text()))});if(typeof a!=="object"&&a!==c)return this.empty().append((this[0]&&this[0].ownerDocument||F).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(g){f(this).wrapAll(a.call(this,g))});if(this[0]){var e=f(a,this[0].ownerDocument).eq(0).clone(true);
this[0].parentNode&&e.insertBefore(this[0]);e.map(function(){for(var g=this;g.firstChild&&g.firstChild.nodeType===1;)g=g.firstChild;return g}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(e){f(this).wrapInner(a.call(this,e))});return this.each(function(){var e=f(this),g=e.contents();g.length?g.wrapAll(a):e.append(a)})},wrap:function(a){return this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,
"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(e){this.parentNode.insertBefore(e,this)});else if(arguments.length){var a=f(arguments[0]);a.push.apply(a,this.toArray());
return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(e){this.parentNode.insertBefore(e,this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f(arguments[0]).toArray());return a}},remove:function(a,e){for(var g=0,k;(k=this[g])!=null;g++)if(!a||f.filter(a,[k]).length){if(!e&&k.nodeType===1){f.cleanData(k.getElementsByTagName("*"));f.cleanData([k])}k.parentNode&&
k.parentNode.removeChild(k)}return this},empty:function(){for(var a=0,e;(e=this[a])!=null;a++)for(e.nodeType===1&&f.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(a){var e=this.map(function(){if(!f.support.noCloneEvent&&!f.isXMLDoc(this)){var g=this.outerHTML,k=this.ownerDocument;if(!g){g=k.createElement("div");g.appendChild(this.cloneNode(true));g=g.innerHTML}return f.clean([g.replace(Ya,"").replace(/=([^="'>\s]+\/)>/g,'="$1">').replace(wa,
"")],k)[0]}else return this.cloneNode(true)});if(a===true){S(this,e);S(this.find("*"),e.find("*"))}return e},html:function(a){if(a===c)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Ya,""):null;else if(typeof a==="string"&&!Ka.test(a)&&(f.support.leadingWhitespace||!wa.test(a))&&!ha[($a.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Za,ab);try{for(var e=0,g=this.length;e<g;e++)if(this[e].nodeType===1){f.cleanData(this[e].getElementsByTagName("*"));this[e].innerHTML=a}}catch(k){this.empty().append(a)}}else f.isFunction(a)?
this.each(function(l){var r=f(this),s=r.html();r.empty().append(function(){return a.call(this,l,s)})}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(e){var g=f(this),k=g.html();g.replaceWith(a.call(this,e,k))});if(typeof a!=="string")a=f(a).detach();return this.each(function(){var e=this.nextSibling,g=this.parentNode;f(this).remove();e?f(e).before(a):f(g).append(a)})}else return this.pushStack(f(f.isFunction(a)?
a():a),"replaceWith",a)},detach:function(a){return this.remove(a,true)},domManip:function(a,e,g){var k,l,r=a[0],s=[],A;if(!f.support.checkClone&&arguments.length===3&&typeof r==="string"&&La.test(r))return this.each(function(){f(this).domManip(a,e,g,true)});if(f.isFunction(r))return this.each(function(B){var G=f(this);a[0]=r.call(this,B,e?G.html():c);G.domManip(a,e,g)});if(this[0]){k=r&&r.parentNode;k=f.support.parentNode&&k&&k.nodeType===11&&k.childNodes.length===this.length?{fragment:k}:W(a,this,
s);A=k.fragment;if(l=A.childNodes.length===1?A=A.firstChild:A.firstChild){e=e&&f.nodeName(l,"tr");l=0;for(var u=this.length;l<u;l++)g.call(e?f.nodeName(this[l],"table")?this[l].getElementsByTagName("tbody")[0]||this[l].appendChild(this[l].ownerDocument.createElement("tbody")):this[l]:this[l],l>0||k.cacheable||this.length>1?A.cloneNode(true):A)}s.length&&f.each(s,m)}return this}});f.fragments={};f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},
function(a,e){f.fn[a]=function(g){var k=[];g=f(g);var l=this.length===1&&this[0].parentNode;if(l&&l.nodeType===11&&l.childNodes.length===1&&g.length===1){g[e](this[0]);return this}else{l=0;for(var r=g.length;l<r;l++){var s=(l>0?this.clone(true):this).get();f.fn[e].apply(f(g[l]),s);k=k.concat(s)}return this.pushStack(k,a,g.selector)}}});f.extend({clean:function(a,e,g,k){e=e||F;if(typeof e.createElement==="undefined")e=e.ownerDocument||e[0]&&e[0].ownerDocument||F;for(var l=[],r=0,s;(s=a[r])!=null;r++){if(typeof s===
"number")s+="";if(s){if(typeof s==="string"&&!qb.test(s))s=e.createTextNode(s);else if(typeof s==="string"){s=s.replace(Za,ab);var A=($a.exec(s)||["",""])[1].toLowerCase(),u=ha[A]||ha._default,B=u[0],G=e.createElement("div");for(G.innerHTML=u[1]+s+u[2];B--;)G=G.lastChild;if(!f.support.tbody){B=pb.test(s);A=A==="table"&&!B?G.firstChild&&G.firstChild.childNodes:u[1]==="<table>"&&!B?G.childNodes:[];for(u=A.length-1;u>=0;--u)f.nodeName(A[u],"tbody")&&!A[u].childNodes.length&&A[u].parentNode.removeChild(A[u])}!f.support.leadingWhitespace&&
wa.test(s)&&G.insertBefore(e.createTextNode(wa.exec(s)[0]),G.firstChild);s=G.childNodes}if(s.nodeType)l.push(s);else l=f.merge(l,s)}}if(g)for(r=0;l[r];r++)if(k&&f.nodeName(l[r],"script")&&(!l[r].type||l[r].type.toLowerCase()==="text/javascript"))k.push(l[r].parentNode?l[r].parentNode.removeChild(l[r]):l[r]);else{l[r].nodeType===1&&l.splice.apply(l,[r+1,0].concat(f.makeArray(l[r].getElementsByTagName("script"))));g.appendChild(l[r])}return l},cleanData:function(a){for(var e,g,k=f.cache,l=f.event.special,
r=f.support.deleteExpando,s=0,A;(A=a[s])!=null;s++)if(g=A[f.expando]){e=k[g];if(e.events)for(var u in e.events)l[u]?f.event.remove(A,u):Ra(A,u,e.handle);if(r)delete A[f.expando];else A.removeAttribute&&A.removeAttribute(f.expando);delete k[g]}}});var rb=/z-?index|font-?weight|opacity|zoom|line-?height/i,bb=/alpha\([^)]*\)/,cb=/opacity=([^)]*)/,Fa=/float/i,Ga=/-([a-z])/ig,sb=/([A-Z])/g,tb=/^-?\d+(?:px)?$/i,ub=/^-?\d/,vb={position:"absolute",visibility:"hidden",display:"block"},wb=["Left","Right"],
xb=["Top","Bottom"],yb=F.defaultView&&F.defaultView.getComputedStyle,db=f.support.cssFloat?"cssFloat":"styleFloat",Ha=function(a,e){return e.toUpperCase()};f.fn.css=function(a,e){return o(this,a,e,true,function(g,k,l){if(l===c)return f.curCSS(g,k);if(typeof l==="number"&&!rb.test(k))l+="px";f.style(g,k,l)})};f.extend({style:function(a,e,g){if(!a||a.nodeType===3||a.nodeType===8)return c;if((e==="width"||e==="height")&&parseFloat(g)<0)g=c;var k=a.style||a,l=g!==c;if(!f.support.opacity&&e==="opacity"){if(l){k.zoom=
1;e=parseInt(g,10)+""==="NaN"?"":"alpha(opacity="+g*100+")";a=k.filter||f.curCSS(a,"filter")||"";k.filter=bb.test(a)?a.replace(bb,e):e}return k.filter&&k.filter.indexOf("opacity=")>=0?parseFloat(cb.exec(k.filter)[1])/100+"":""}if(Fa.test(e))e=db;e=e.replace(Ga,Ha);if(l)k[e]=g;return k[e]},css:function(a,e,g,k){if(e==="width"||e==="height"){var l,r=e==="width"?wb:xb;g=function(){l=e==="width"?a.offsetWidth:a.offsetHeight;k!=="border"&&f.each(r,function(){k||(l-=parseFloat(f.curCSS(a,"padding"+this,
true))||0);if(k==="margin")l+=parseFloat(f.curCSS(a,"margin"+this,true))||0;else l-=parseFloat(f.curCSS(a,"border"+this+"Width",true))||0})};a.offsetWidth!==0?g():f.swap(a,vb,g);return Math.max(0,Math.round(l))}return f.curCSS(a,e,g)},curCSS:function(a,e,g){var k,l=a.style;if(!f.support.opacity&&e==="opacity"&&a.currentStyle){k=cb.test(a.currentStyle.filter||"")?parseFloat(RegExp.$1)/100+"":"";return k===""?"1":k}if(Fa.test(e))e=db;if(!g&&l&&l[e])k=l[e];else if(yb){if(Fa.test(e))e="float";e=e.replace(sb,
"-$1").toLowerCase();l=a.ownerDocument.defaultView;if(!l)return null;if(a=l.getComputedStyle(a,null))k=a.getPropertyValue(e);if(e==="opacity"&&k==="")k="1"}else if(a.currentStyle){g=e.replace(Ga,Ha);k=a.currentStyle[e]||a.currentStyle[g];if(!tb.test(k)&&ub.test(k)){e=l.left;var r=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;l.left=g==="fontSize"?"1em":k||0;k=l.pixelLeft+"px";l.left=e;a.runtimeStyle.left=r}}return k},swap:function(a,e,g){var k={};for(var l in e){k[l]=a.style[l];a.style[l]=
e[l]}g.call(a);for(l in e)a.style[l]=k[l]}});if(f.expr&&f.expr.filters){f.expr.filters.hidden=function(a){var e=a.offsetWidth,g=a.offsetHeight,k=a.nodeName.toLowerCase()==="tr";return e===0&&g===0&&!k?true:e>0&&g>0&&!k?false:f.curCSS(a,"display")==="none"};f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)}}var zb=q(),Ab=/<script(.|\s)*?\/script>/gi,Bb=/select|textarea/i,Cb=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,oa=/=\?(&|$)/,
Ia=/\?/,Db=/(\?|&)_=.*?(&|$)/,Eb=/^(\w+:)?\/\/([^\/?#]+)/,Fb=/%20/g,Gb=f.fn.load;f.fn.extend({load:function(a,e,g){if(typeof a!=="string")return Gb.call(this,a);else if(!this.length)return this;var k=a.indexOf(" ");if(k>=0){var l=a.slice(k,a.length);a=a.slice(0,k)}k="GET";if(e)if(f.isFunction(e)){g=e;e=null}else if(typeof e==="object"){e=f.param(e,f.ajaxSettings.traditional);k="POST"}var r=this;f.ajax({url:a,type:k,dataType:"html",data:e,complete:function(s,A){if(A==="success"||A==="notmodified")r.html(l?
f("<div />").append(s.responseText.replace(Ab,"")).find(l):s.responseText);g&&r.each(g,[s.responseText,A,s])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Bb.test(this.nodeName)||Cb.test(this.type))}).map(function(a,e){a=f(this).val();return a==null?null:f.isArray(a)?f.map(a,function(g){return{name:e.name,
value:g}}):{name:e.name,value:a}}).get()}});f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,e){f.fn[e]=function(g){return this.bind(e,g)}});f.extend({get:function(a,e,g,k){if(f.isFunction(e)){k=k||g;g=e;e=null}return f.ajax({type:"GET",url:a,data:e,success:g,dataType:k})},getScript:function(a,e){return f.get(a,null,e,"script")},getJSON:function(a,e,g){return f.get(a,e,g,"json")},post:function(a,e,g,k){if(f.isFunction(e)){k=k||g;g=e;e={}}return f.ajax({type:"POST",
url:a,data:e,success:g,dataType:k})},ajaxSetup:function(a){f.extend(f.ajaxSettings,a)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:d.XMLHttpRequest&&(d.location.protocol!=="file:"||!d.ActiveXObject)?function(){return new d.XMLHttpRequest}:function(){try{return new d.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",
json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},etag:{},ajax:function(a){function e(){l.success&&l.success.call(u,A,s,M);l.global&&k("ajaxSuccess",[M,l])}function g(){l.complete&&l.complete.call(u,M,s);l.global&&k("ajaxComplete",[M,l]);l.global&&!--f.active&&f.event.trigger("ajaxStop")}function k(E,D){(l.context?f(l.context):f.event).trigger(E,D)}var l=f.extend(true,{},f.ajaxSettings,a),r,s,A,u=a&&a.context||l,B=l.type.toUpperCase();if(l.data&&l.processData&&
typeof l.data!=="string")l.data=f.param(l.data,l.traditional);if(l.dataType==="jsonp"){if(B==="GET")oa.test(l.url)||(l.url+=(Ia.test(l.url)?"&":"?")+(l.jsonp||"callback")+"=?");else if(!l.data||!oa.test(l.data))l.data=(l.data?l.data+"&":"")+(l.jsonp||"callback")+"=?";l.dataType="json"}if(l.dataType==="json"&&(l.data&&oa.test(l.data)||oa.test(l.url))){r=l.jsonpCallback||"jsonp"+zb++;if(l.data)l.data=(l.data+"").replace(oa,"="+r+"$1");l.url=l.url.replace(oa,"="+r+"$1");l.dataType="script";d[r]=d[r]||
function(E){A=E;e();g();d[r]=c;try{delete d[r]}catch(D){}T&&T.removeChild(Z)}}if(l.dataType==="script"&&l.cache===null)l.cache=false;if(l.cache===false&&B==="GET"){var G=q(),L=l.url.replace(Db,"$1_="+G+"$2");l.url=L+(L===l.url?(Ia.test(l.url)?"&":"?")+"_="+G:"")}if(l.data&&B==="GET")l.url+=(Ia.test(l.url)?"&":"?")+l.data;l.global&&!f.active++&&f.event.trigger("ajaxStart");G=(G=Eb.exec(l.url))&&(G[1]&&G[1]!==location.protocol||G[2]!==location.host);if(l.dataType==="script"&&B==="GET"&&G){var T=F.getElementsByTagName("head")[0]||
F.documentElement,Z=F.createElement("script");Z.src=l.url;if(l.scriptCharset)Z.charset=l.scriptCharset;if(!r){var V=false;Z.onload=Z.onreadystatechange=function(){if(!V&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){V=true;e();g();Z.onload=Z.onreadystatechange=null;T&&Z.parentNode&&T.removeChild(Z)}}}T.insertBefore(Z,T.firstChild);return c}var ga=false,M=l.xhr();if(M){l.username?M.open(B,l.url,l.async,l.username,l.password):M.open(B,l.url,l.async);try{if(l.data||a&&
a.contentType)M.setRequestHeader("Content-Type",l.contentType);if(l.ifModified){f.lastModified[l.url]&&M.setRequestHeader("If-Modified-Since",f.lastModified[l.url]);f.etag[l.url]&&M.setRequestHeader("If-None-Match",f.etag[l.url])}G||M.setRequestHeader("X-Requested-With","XMLHttpRequest");M.setRequestHeader("Accept",l.dataType&&l.accepts[l.dataType]?l.accepts[l.dataType]+", */*":l.accepts._default)}catch(Ea){}if(l.beforeSend&&l.beforeSend.call(u,M,l)===false){l.global&&!--f.active&&f.event.trigger("ajaxStop");
M.abort();return false}l.global&&k("ajaxSend",[M,l]);var n=M.onreadystatechange=function(E){if(!M||M.readyState===0||E==="abort"){ga||g();ga=true;if(M)M.onreadystatechange=f.noop}else if(!ga&&M&&(M.readyState===4||E==="timeout")){ga=true;M.onreadystatechange=f.noop;s=E==="timeout"?"timeout":!f.httpSuccess(M)?"error":l.ifModified&&f.httpNotModified(M,l.url)?"notmodified":"success";var D;if(s==="success")try{A=f.httpData(M,l.dataType,l)}catch(J){s="parsererror";D=J}if(s==="success"||s==="notmodified")r||
e();else f.handleError(l,M,s,D);g();E==="timeout"&&M.abort();if(l.async)M=null}};try{var p=M.abort;M.abort=function(){M&&p.call(M);n("abort")}}catch(t){}l.async&&l.timeout>0&&setTimeout(function(){M&&!ga&&n("timeout")},l.timeout);try{M.send(B==="POST"||B==="PUT"||B==="DELETE"?l.data:null)}catch(z){f.handleError(l,M,null,z);g()}l.async||n();return M}},handleError:function(a,e,g,k){if(a.error)a.error.call(a.context||a,e,g,k);if(a.global)(a.context?f(a.context):f.event).trigger("ajaxError",[e,a,k])},
active:0,httpSuccess:function(a){try{return!a.status&&location.protocol==="file:"||a.status>=200&&a.status<300||a.status===304||a.status===1223||a.status===0}catch(e){}return false},httpNotModified:function(a,e){var g=a.getResponseHeader("Last-Modified"),k=a.getResponseHeader("Etag");if(g)f.lastModified[e]=g;if(k)f.etag[e]=k;return a.status===304||a.status===0},httpData:function(a,e,g){var k=a.getResponseHeader("content-type")||"",l=e==="xml"||!e&&k.indexOf("xml")>=0;a=l?a.responseXML:a.responseText;
l&&a.documentElement.nodeName==="parsererror"&&f.error("parsererror");if(g&&g.dataFilter)a=g.dataFilter(a,e);if(typeof a==="string")if(e==="json"||!e&&k.indexOf("json")>=0)a=f.parseJSON(a);else if(e==="script"||!e&&k.indexOf("javascript")>=0)f.globalEval(a);return a},param:function(a,e){function g(s,A){if(f.isArray(A))f.each(A,function(u,B){e||/\[\]$/.test(s)?k(s,B):g(s+"["+(typeof B==="object"||f.isArray(B)?u:"")+"]",B)});else!e&&A!=null&&typeof A==="object"?f.each(A,function(u,B){g(s+"["+u+"]",
B)}):k(s,A)}function k(s,A){A=f.isFunction(A)?A():A;l[l.length]=encodeURIComponent(s)+"="+encodeURIComponent(A)}var l=[];if(e===c)e=f.ajaxSettings.traditional;if(f.isArray(a)||a.jquery)f.each(a,function(){k(this.name,this.value)});else for(var r in a)g(r,a[r]);return l.join("&").replace(Fb,"+")}});var Ja={},Hb=/toggle|show|hide/,Ib=/^([+-]=)?([\d+-.]+)(.*)$/,xa,Ma=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],
["opacity"]];f.fn.extend({show:function(a,e){if(a||a===0)return this.animate(U("show",3),a,e);else{a=0;for(e=this.length;a<e;a++){var g=f.data(this[a],"olddisplay");this[a].style.display=g||"";if(f.css(this[a],"display")==="none"){g=this[a].nodeName;var k;if(Ja[g])k=Ja[g];else{var l=f("<"+g+" />").appendTo("body");k=l.css("display");if(k==="none")k="block";l.remove();Ja[g]=k}f.data(this[a],"olddisplay",k)}}a=0;for(e=this.length;a<e;a++)this[a].style.display=f.data(this[a],"olddisplay")||"";return this}},
hide:function(a,e){if(a||a===0)return this.animate(U("hide",3),a,e);else{a=0;for(e=this.length;a<e;a++){var g=f.data(this[a],"olddisplay");!g&&g!=="none"&&f.data(this[a],"olddisplay",f.css(this[a],"display"))}a=0;for(e=this.length;a<e;a++)this[a].style.display="none";return this}},_toggle:f.fn.toggle,toggle:function(a,e){var g=typeof a==="boolean";if(f.isFunction(a)&&f.isFunction(e))this._toggle.apply(this,arguments);else a==null||g?this.each(function(){var k=g?a:f(this).is(":hidden");f(this)[k?"show":
"hide"]()}):this.animate(U("toggle",3),a,e);return this},fadeTo:function(a,e,g){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:e},a,g)},animate:function(a,e,g,k){var l=f.speed(e,g,k);if(f.isEmptyObject(a))return this.each(l.complete);return this[l.queue===false?"each":"queue"](function(){var r=f.extend({},l),s,A=this.nodeType===1&&f(this).is(":hidden"),u=this;for(s in a){var B=s.replace(Ga,Ha);if(s!==B){a[B]=a[s];delete a[s];s=B}if(a[s]==="hide"&&A||a[s]==="show"&&!A)return r.complete.call(this);
if((s==="height"||s==="width")&&this.style){r.display=f.css(this,"display");r.overflow=this.style.overflow}if(f.isArray(a[s])){(r.specialEasing=r.specialEasing||{})[s]=a[s][1];a[s]=a[s][0]}}if(r.overflow!=null)this.style.overflow="hidden";r.curAnim=f.extend({},a);f.each(a,function(G,L){var T=new f.fx(u,r,G);if(Hb.test(L))T[L==="toggle"?A?"show":"hide":L](a);else{var Z=Ib.exec(L),V=T.cur(true)||0;if(Z){L=parseFloat(Z[2]);var ga=Z[3]||"px";if(ga!=="px"){u.style[G]=(L||1)+ga;V=(L||1)/T.cur(true)*V;u.style[G]=
V+ga}if(Z[1])L=(Z[1]==="-="?-1:1)*L+V;T.custom(V,L,ga)}else T.custom(V,L,"")}});return true})},stop:function(a,e){var g=f.timers;a&&this.queue([]);this.each(function(){for(var k=g.length-1;k>=0;k--)if(g[k].elem===this){e&&g[k](true);g.splice(k,1)}});e||this.dequeue();return this}});f.each({slideDown:U("show",1),slideUp:U("hide",1),slideToggle:U("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(a,e){f.fn[a]=function(g,k){return this.animate(e,g,k)}});f.extend({speed:function(a,
e,g){var k=a&&typeof a==="object"?a:{complete:g||!g&&e||f.isFunction(a)&&a,duration:a,easing:g&&e||e&&!f.isFunction(e)&&e};k.duration=f.fx.off?0:typeof k.duration==="number"?k.duration:f.fx.speeds[k.duration]||f.fx.speeds._default;k.old=k.complete;k.complete=function(){k.queue!==false&&f(this).dequeue();f.isFunction(k.old)&&k.old.call(this)};return k},easing:{linear:function(a,e,g,k){return g+k*a},swing:function(a,e,g,k){return(-Math.cos(a*Math.PI)/2+0.5)*k+g}},timers:[],fx:function(a,e,g){this.options=
e;this.elem=a;this.prop=g;if(!e.orig)e.orig={}}});f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(f.fx.step[this.prop]||f.fx.step._default)(this);if((this.prop==="height"||this.prop==="width")&&this.elem.style)this.elem.style.display="block"},cur:function(a){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];return(a=parseFloat(f.css(this.elem,this.prop,a)))&&a>-10000?a:parseFloat(f.curCSS(this.elem,
this.prop))||0},custom:function(a,e,g){function k(r){return l.step(r)}this.startTime=q();this.start=a;this.end=e;this.unit=g||this.unit||"px";this.now=this.start;this.pos=this.state=0;var l=this;k.elem=this.elem;if(k()&&f.timers.push(k)&&!xa)xa=setInterval(f.fx.tick,13)},show:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());f(this.elem).show()},hide:function(){this.options.orig[this.prop]=
f.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(a){var e=q(),g=true;if(a||e>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var k in this.options.curAnim)if(this.options.curAnim[k]!==true)g=false;if(g){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;a=f.data(this.elem,"olddisplay");this.elem.style.display=a?a:this.options.display;if(f.css(this.elem,
"display")==="none")this.elem.style.display="block"}this.options.hide&&f(this.elem).hide();if(this.options.hide||this.options.show)for(var l in this.options.curAnim)f.style(this.elem,l,this.options.orig[l]);this.options.complete.call(this.elem)}return false}else{l=e-this.startTime;this.state=l/this.options.duration;a=this.options.easing||(f.easing.swing?"swing":"linear");this.pos=f.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||a](this.state,l,0,1,this.options.duration);
this.now=this.start+(this.end-this.start)*this.pos;this.update()}return true}};f.extend(f.fx,{tick:function(){for(var a=f.timers,e=0;e<a.length;e++)a[e]()||a.splice(e--,1);a.length||f.fx.stop()},stop:function(){clearInterval(xa);xa=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){if(a.elem.style&&a.elem.style[a.prop]!=null)a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit;else a.elem[a.prop]=
a.now}}});if(f.expr&&f.expr.filters)f.expr.filters.animated=function(a){return f.grep(f.timers,function(e){return a===e.elem}).length};f.fn.offset="getBoundingClientRect"in F.documentElement?function(a){var e=this[0];if(a)return this.each(function(l){f.offset.setOffset(this,a,l)});if(!e||!e.ownerDocument)return null;if(e===e.ownerDocument.body)return f.offset.bodyOffset(e);var g=e.getBoundingClientRect(),k=e.ownerDocument;e=k.body;k=k.documentElement;return{top:g.top+(self.pageYOffset||f.support.boxModel&&
k.scrollTop||e.scrollTop)-(k.clientTop||e.clientTop||0),left:g.left+(self.pageXOffset||f.support.boxModel&&k.scrollLeft||e.scrollLeft)-(k.clientLeft||e.clientLeft||0)}}:function(a){var e=this[0];if(a)return this.each(function(G){f.offset.setOffset(this,a,G)});if(!e||!e.ownerDocument)return null;if(e===e.ownerDocument.body)return f.offset.bodyOffset(e);f.offset.initialize();var g=e.offsetParent,k=e,l=e.ownerDocument,r,s=l.documentElement,A=l.body;k=(l=l.defaultView)?l.getComputedStyle(e,null):e.currentStyle;
for(var u=e.offsetTop,B=e.offsetLeft;(e=e.parentNode)&&e!==A&&e!==s;){if(f.offset.supportsFixedPosition&&k.position==="fixed")break;r=l?l.getComputedStyle(e,null):e.currentStyle;u-=e.scrollTop;B-=e.scrollLeft;if(e===g){u+=e.offsetTop;B+=e.offsetLeft;if(f.offset.doesNotAddBorder&&!(f.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(e.nodeName))){u+=parseFloat(r.borderTopWidth)||0;B+=parseFloat(r.borderLeftWidth)||0}k=g;g=e.offsetParent}if(f.offset.subtractsBorderForOverflowNotVisible&&r.overflow!==
"visible"){u+=parseFloat(r.borderTopWidth)||0;B+=parseFloat(r.borderLeftWidth)||0}k=r}if(k.position==="relative"||k.position==="static"){u+=A.offsetTop;B+=A.offsetLeft}if(f.offset.supportsFixedPosition&&k.position==="fixed"){u+=Math.max(s.scrollTop,A.scrollTop);B+=Math.max(s.scrollLeft,A.scrollLeft)}return{top:u,left:B}};f.offset={initialize:function(){var a=F.body,e=F.createElement("div"),g,k,l,r=parseFloat(f.curCSS(a,"marginTop",true))||0;f.extend(e.style,{position:"absolute",top:0,left:0,margin:0,
border:0,width:"1px",height:"1px",visibility:"hidden"});e.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(e,a.firstChild);g=e.firstChild;k=g.firstChild;l=g.nextSibling.firstChild.firstChild;this.doesNotAddBorder=k.offsetTop!==5;this.doesAddBorderForTableAndCells=
l.offsetTop===5;k.style.position="fixed";k.style.top="20px";this.supportsFixedPosition=k.offsetTop===20||k.offsetTop===15;k.style.position=k.style.top="";g.style.overflow="hidden";g.style.position="relative";this.subtractsBorderForOverflowNotVisible=k.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==r;a.removeChild(e);f.offset.initialize=f.noop},bodyOffset:function(a){var e=a.offsetTop,g=a.offsetLeft;f.offset.initialize();if(f.offset.doesNotIncludeMarginInBodyOffset){e+=parseFloat(f.curCSS(a,
"marginTop",true))||0;g+=parseFloat(f.curCSS(a,"marginLeft",true))||0}return{top:e,left:g}},setOffset:function(a,e,g){if(/static/.test(f.curCSS(a,"position")))a.style.position="relative";var k=f(a),l=k.offset(),r=parseInt(f.curCSS(a,"top",true),10)||0,s=parseInt(f.curCSS(a,"left",true),10)||0;if(f.isFunction(e))e=e.call(a,g,l);g={top:e.top-l.top+r,left:e.left-l.left+s};"using"in e?e.using.call(a,g):k.css(g)}};f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],e=this.offsetParent(),
g=this.offset(),k=/^body|html$/i.test(e[0].nodeName)?{top:0,left:0}:e.offset();g.top-=parseFloat(f.curCSS(a,"marginTop",true))||0;g.left-=parseFloat(f.curCSS(a,"marginLeft",true))||0;k.top+=parseFloat(f.curCSS(e[0],"borderTopWidth",true))||0;k.left+=parseFloat(f.curCSS(e[0],"borderLeftWidth",true))||0;return{top:g.top-k.top,left:g.left-k.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||F.body;a&&!/^body|html$/i.test(a.nodeName)&&f.css(a,"position")==="static";)a=
a.offsetParent;return a})}});f.each(["Left","Top"],function(a,e){var g="scroll"+e;f.fn[g]=function(k){var l=this[0],r;if(!l)return null;return k!==c?this.each(function(){if(r=P(this))r.scrollTo(!a?k:f(r).scrollLeft(),a?k:f(r).scrollTop());else this[g]=k}):(r=P(l))?"pageXOffset"in r?r[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&r.document.documentElement[g]||r.document.body[g]:l[g]}});f.each(["Height","Width"],function(a,e){var g=e.toLowerCase();f.fn["inner"+e]=function(){return this[0]?f.css(this[0],
g,false,"padding"):null};f.fn["outer"+e]=function(k){return this[0]?f.css(this[0],g,false,k?"margin":"border"):null};f.fn[g]=function(k){var l=this[0];if(!l)return k==null?null:this;if(f.isFunction(k))return this.each(function(r){var s=f(this);s[g](k.call(this,r,s[g]()))});return"scrollTo"in l&&l.document?l.document.compatMode==="CSS1Compat"&&l.document.documentElement["client"+e]||l.document.body["client"+e]:l.nodeType===9?Math.max(l.documentElement["client"+e],l.body["scroll"+e],l.documentElement["scroll"+
e],l.body["offset"+e],l.documentElement["offset"+e]):k===c?f.css(l,g):this.css(g,typeof k==="string"?k:k+"px")}});d.jQuery=d.$=f})(window);/*
 http://www.JSON.org/json2.js
 2010-03-20

 Public Domain.

 NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.

 See http://www.JSON.org/js.html
*/
if(!this.JSON)this.JSON={};
(function(){function d(K){return K<10?"0"+K:K}function c(K){o.lastIndex=0;return o.test(K)?'"'+K.replace(o,function(O){var S=H[O];return typeof S==="string"?S:"\\u"+("0000"+O.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+K+'"'}function h(K,O){var S,W,U,P,f=q,Y,N=O[K];if(N&&typeof N==="object"&&typeof N.toJSON==="function")N=N.toJSON(K);if(typeof Q==="function")N=Q.call(O,K,N);switch(typeof N){case "string":return c(N);case "number":return isFinite(N)?String(N):"null";case "boolean":case "null":return String(N);
case "object":if(!N)return"null";q+=C;Y=[];if(Object.prototype.toString.apply(N)==="[object Array]"){P=N.length;for(S=0;S<P;S+=1)Y[S]=h(S,N)||"null";U=Y.length===0?"[]":q?"[\n"+q+Y.join(",\n"+q)+"\n"+f+"]":"["+Y.join(",")+"]";q=f;return U}if(Q&&typeof Q==="object"){P=Q.length;for(S=0;S<P;S+=1){W=Q[S];if(typeof W==="string")if(U=h(W,N))Y.push(c(W)+(q?": ":":")+U)}}else for(W in N)if(Object.hasOwnProperty.call(N,W))if(U=h(W,N))Y.push(c(W)+(q?": ":":")+U);U=Y.length===0?"{}":q?"{\n"+q+Y.join(",\n"+q)+
"\n"+f+"}":"{"+Y.join(",")+"}";q=f;return U}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var m=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,q,C,H={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},Q;if(typeof JSON.stringify!=="function")JSON.stringify=function(K,O,S){var W;C=q="";if(typeof S==="number")for(W=0;W<S;W+=1)C+=" ";else if(typeof S==="string")C=S;if((Q=O)&&typeof O!=="function"&&(typeof O!=="object"||typeof O.length!=="number"))throw Error("JSON.stringify");return h("",
{"":K})};if(typeof JSON.parse!=="function")JSON.parse=function(K,O){function S(U,P){var f,Y,N=U[P];if(N&&typeof N==="object")for(f in N)if(Object.hasOwnProperty.call(N,f)){Y=S(N,f);if(Y!==undefined)N[f]=Y;else delete N[f]}return O.call(U,P,N)}var W;K=String(K);m.lastIndex=0;if(m.test(K))K=K.replace(m,function(U){return"\\u"+("0000"+U.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(K.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){W=eval("("+K+")");return typeof O==="function"?S({"":W},""):W}throw new SyntaxError("JSON.parse");}})();/*
 Copyright (c) 2009 Brandon Aaron (http://brandonaaron.net)
 Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.

 Version: 3.0.2

 Requires: 1.2.2+
*/
(function(d){function c(m){var o=[].slice.call(arguments,1),q=0;m=d.event.fix(m||window.event);m.type="mousewheel";if(m.wheelDelta)q=m.wheelDelta/120;if(m.detail)q=-m.detail/3;o.unshift(m,q);return d.event.handle.apply(this,o)}var h=["DOMMouseScroll","mousewheel"];d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var m=h.length;m;)this.addEventListener(h[--m],c,false);else this.onmousewheel=c},teardown:function(){if(this.removeEventListener)for(var m=h.length;m;)this.removeEventListener(h[--m],
c,false);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(m){return m?this.bind("mousewheel",m):this.trigger("mousewheel")},unmousewheel:function(m){return this.unbind("mousewheel",m)}})})(jQuery);/*
 Rawscripts.com copywrite 2010



*/
var OSName="Unknown OS";if(navigator.appVersion.indexOf("Win")!=-1)OSName="Windows";if(navigator.appVersion.indexOf("Mac")!=-1)OSName="MacOS";if(navigator.appVersion.indexOf("X11")!=-1)OSName="UNIX";if(navigator.appVersion.indexOf("Linux")!=-1)OSName="Linux";if($.browser.webkit)var browser="webkit";if($.browser.mozilla)browser="mozilla";if($.browser.opera)browser="opera";
var ud=0,viewNotes=true,timer,typeToScript=true,findForcePaint=false,pasting=false,justPasted=false,undoQue=[],redoQue=[],pageBreaks=[],mouseY=0,shiftDown=false,mouseDownBool=false,scrollBarBool=false,commandDownBool=false,characters=[],scenes=[],canvas,ctx,linesNLB=[],vOffset=0,pos={col:0,row:0},anch={col:0,row:0},findArr=[],findReplaceArr=[],background="#fff",font="10pt Courier",fontWidth=8,foreground="#000",lineheight=13,milli=0,formatMenu=false,formats=["Slugline","Action","Character","Dialog",
"Parenthetical","Transition"],resource_id="random123456789",WrapVariableArray=[[62,101,0,1,2],[62,101,0,0,2],[40,261,0,1,1],[36,181,0,0,2],[30,221,0,0,1],[61,591,1,1,2]],editorWidth=850,headerHeight=91,lines=[];notes=[];var spellWrong=[],spellIgnore=[],checkSpell=false;
$(document).ready(function(){document.getElementById("canvas").height=$("#container").height()-60-26;document.getElementById("canvas").width=$("#container").width()-320;editorWidth=$("#container").width()-323;document.getElementById("sidebar").style.height=$("#container").height()-65+"px";$("#container").mousewheel(function(d,c){if(d.target.id=="canvas"){d.preventDefault();scroll(-c*25)}});$("#recipient").keyup(function(d){d.which==188&&tokenize("recipient")});$("#collaborator").keyup(function(d){d.which==
188&&tokenize("collaborator")});$("#renameField").keydown(function(d){if(d.which==13){d.preventDefault();renameScript()}});$("#recipient").keydown(function(d){d.which==13&&d.preventDefault()});$("#collaborator").keydown(function(d){if(d.which==13){d.preventDefault();shareScript()}});$("#subject").keydown(function(d){d.which==13&&d.preventDefault()});$("#find_input").focus(function(){typeToScript=false;findForcePaint=true;commandDownBool=false});$("#find_input").blur(function(){typeToScript=true;commandDownBool=
findForcePaint=false});$("#find_input").keyup(function(d){findInputKeyUp(d,"f")});$("#fr_find_input").focus(function(){typeToScript=false;findForcePaint=true;commandDownBool=false});$("#fr_find_input").blur(function(){typeToScript=true;commandDownBool=findForcePaint=false});$("#fr_find_input").keyup(function(d){findInputKeyUp(d,"r")});$("#fr_replace_input").focus(function(){typeToScript=false;findForcePaint=true;commandDownBool=false});$("#fr_replace_input").blur(function(){typeToScript=true;commandDownBool=
findForcePaint=false});$(".menuItem").click(function(){openMenu(this.id)});$(".menuItem").mouseover(function(){topMenuOver(this.id)});$(".menuItem").mouseout(function(){topMenuOut(this.id)});setup()});
$(window).resize(function(){document.getElementById("canvas").height=$("#container").height()-60-26;document.getElementById("canvas").width=$("#container").width()-320;editorWidth=$("#container").width()-323;document.getElementById("sidebar").style.height=$("#container").height()-65+"px";scroll(0);paint(false,false,false)});
$("*").keydown(function(d){if(!findForcePaint){if(commandDownBool&&d.which!=16)keyboardShortcut(d);else{milli=(new Date).getMilliseconds();if(d.which==13)enter();else if(d.which==38)upArrow();else if(d.which==40)downArrow();else if(d.which==39)rightArrow();else if(d.which==37)leftArrow();else if(d.which==8)backspace(d);else if(d.which==46)deleteButton();else if(d.which==9){d.preventDefault();tab()}else if(d.which==16)shiftDown=true;else if(OSName=="MacOS"&&(d.which==91||d.which==93)&&browser=="webkit"||
OSName=="MacOS"&&d.which==224&&browser=="mozilla"||OSName=="MacOS"&&d.which==17&&browser=="opera"||OSName!="MacOS"&&d.which==17)commandDownBool=true;ud<0&&typeToScript&&d.which!=13&&d.which!=46&&d.which!=8&&scroll(ud-400);ud>document.getElementById("canvas").height-80&&typeToScript&&d.which!=13&&d.which!=46&&d.which!=8&&scroll(ud-400)}if(typeToScript){if(anch.row==pos.row&&pos.col==anch.col)document.getElementById("ccp").value="";document.getElementById("ccp").focus();document.getElementById("ccp").select()}}});
$("*").keyup(function(d){if(findForcePaint!=true){if(d.which==16)shiftDown=false;else if(OSName=="MacOS"&&(d.which==91||d.which==93)&&browser=="webkit"||OSName=="MacOS"&&d.which==224&&browser=="mozilla"||OSName=="MacOS"&&d.which==17&&browser=="opera"||OSName!="MacOS"&&d.which==17)commandDownBool=false;if(typeToScript){document.getElementById("ccp").focus();document.getElementById("ccp").select()}}});$("*").keypress(function(d){findForcePaint!=true&&handlekeypress(d)});
$("*").mousedown(function(d){if(typeToScript){mouseDown(d);document.getElementById("ccp").focus();document.getElementById("ccp").select()}});$("*").mouseup(function(d){if(typeToScript){mouseUp(d);document.getElementById("ccp").focus();document.getElementById("ccp").select()}});$("*").mousemove(function(d){mouseMove(d)});window.oncontextmenu=contextmenu;
function createSuggestBox(d){if(document.getElementById("suggestBox")!=null){$(".suggestItem").unbind();document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"))}if(d=="c")var c=characters,h=WrapVariableArray[2][1]+Math.round((editorWidth-fontWidth*87-24)/2)+"px";else{c=[];for(i in scenes)c.push([scenes[i][0].split(") ").splice(1).join(") ")]);h=WrapVariableArray[0][1]+Math.round((editorWidth-fontWidth*87-24)/2)+"px"}var m=lines[pos.row][0].length,o=lines[pos.row][0].toUpperCase();
for(x in c){var q=c[x][0].substr(0,m).toUpperCase();if(o==q&&o!=c[x][0]){if(document.getElementById("suggestBox")==null){var C=document.body.appendChild(document.createElement("div"));C.id="suggestBox";C.style.position="fixed";C.style.top=ud+headerHeight+1+lineheight+"px";C.style.left=h}q=false;if(d=="s"){var H=C.childNodes;for(i in H)if(c[x][0]==H[i].value)q=true;H=null}if(!q){q=C.appendChild(document.createElement("div"));q.className="suggestItem";q.appendChild(document.createTextNode(c[x][0]));
q.value=c[x][0];document.getElementById("suggestBox").firstChild.id="focus";q=null}q=null}}if(document.getElementById("suggestBox")!=null)C=q=null;d=c=o=m=h=x=null;$(".suggestItem").mouseover(function(){document.getElementById("focus").removeAttribute("id");this.id="focus"})}function saveTimer(){document.getElementById("saveButton").disabled=false;document.getElementById("saveButton").value="Save";clearTimeout(timer);checkSpell=true;timer=setTimeout("save(1)",7E3)}
function findInputKeyUp(d,c){if(d.which==13&&d.which!=1E3){d.preventDefault();findDown()}else{var h=c=="f"?document.getElementById("find_input").value:document.getElementById("fr_find_input").value,m=RegExp(h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"gi");findArr=[];findReplaceArr=[];if(h.length==0)document.getElementById("find_number_found").innerHTML="0 found";else{for(i in lines)for(;m.test(lines[i][0])==true;)c=="f"?findArr.push([i*1,m.lastIndex-h.length]):findReplaceArr.push([i*1,m.lastIndex-
h.length]);if(c=="f")document.getElementById("find_number_found").innerHTML=findArr.length+" found"}}}
function findDown(){var d=findArr.length!=0?findArr:findReplaceArr;if(d.length!=0){var c=findArr.length!=0?document.getElementById("find_input").value.length:document.getElementById("fr_find_input").value.length;for(i in d){if(d[i][0]==pos.row&&d[i][1]>pos.col){anch.row=pos.row=d[i][0];anch.col=d[i][1]*1;pos.col=d[i][1]*1+c*1;jumpTo("find"+pos.row);return}if(d[i][0]*1>pos.row*1){anch.row=pos.row=d[i][0]*1;anch.col=d[i][1]*1;pos.col=d[i][1]*1+c*1;jumpTo("find"+pos.row);return}}pos.row=anch.row=pos.col=
anch.col=0;findDown()}}
function findUp(){var d=findArr.length!=0?findArr:findReplaceArr;if(d.length!=0){var c=findArr.length!=0?document.getElementById("find_input").value.length:document.getElementById("fr_find_input").value.length,h=d.length-1;for(h=d.length-1;h>=0;h--){if(d[h][0]==pos.row&&d[h][1]<pos.col-c-1){anch.row=pos.row=d[h][0];anch.col=d[h][1]*1;pos.col=d[h][1]*1+c*1;jumpTo("find"+pos.row);return}if(d[h][0]*1<pos.row*1){anch.row=pos.row=d[h][0]*1;anch.col=d[h][1]*1;pos.col=d[h][1]*1+c*1;jumpTo("find"+pos.row);
return}}pos.row=anch.row=d[d.length-1][0];anch.col=d[d.length-1][1];pos.col=anch.col+c;jumpTo("find"+pos.row)}}
function ajaxSpell(d){checkSpell=false;var c=lines[d][0];if(lines[d][1]==0||lines[d][1]==2||lines[d][1]==5)c=c.toUpperCase();d=c.split(" ");for(i=0;i<d.length;i++){c=false;for(h in spellWrong)if(d[i].toUpperCase()==spellWrong[h][0].toUpperCase())c=true;for(h in spellIgnore)if(d[i].toUpperCase()==spellWrong[h][0].toUpperCase())c=true;if(c){d.splice(i,1);i--}}i=null;var h=JSON.stringify(d);$.post("/spellcheck",{data:h,resource_id:resource_id},function(m){if(m!="correct"){m=JSON.parse(m);for(i in m)spellWrong.push(m[i]);
i=null}})}function keyboardShortcut(d){if(d.which!=67&&d.which!=86&&d.which!=88){d.preventDefault();document.getElementById("suggestBox")!=null&&document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"));if(shiftDown&&d.which==90)redo();else if(d.which==90)undo();else if(d.which==83)save(0);else if(d.which==70)findPrompt();else if(d.which==82)window.location.href=window.location.href}}
function cut(){if(pos.row!=anch.row||pos.col!=anch.col)backspace();saveTimer()}function copy(){}
function paste(){if(!justPasted){saveTimer();redoQue=[];if(pos.row!=anch.row||pos.col!=anch.col)backspace();var d=false,c=document.getElementById("ccp").value,h=RegExp("\\n","g");if(c.split(h).length>1){c=c.split(h);h=[];for(x in c)c[x]!=""&&c[x]!=null&&h.push([c[x],1]);c=JSON.stringify(h);x=null}undoQue.push(["paste",pos.row,pos.col,c]);if(c[0]=="["&&c[1]=="[")d=true;if(d){forceCalse=true;d=JSON.parse(c);if(lines[pos.row][0]=="")lines[pos.row][1]=d[0][1];if(lines[pos.row][1]==d[0][1]){undoQue[undoQue.length-
1].push(1);c=[lines[pos.row][0].slice(pos.col),lines[pos.row][1]];lines[pos.row][0]=lines[pos.row][0].slice(0,pos.col)+d[0][0];h=1;var m=pos.row+1}else{undoQue[undoQue.length-1].push(0);c=[lines[pos.row][0].slice(pos.col),lines[pos.row][1]];lines[pos.row][0]=lines[pos.row][0].slice(0,pos.col);pos.row++;lines.splice(pos.row,0,d[0]);h=1;m=pos.row+1}for(;h<d.length;){lines.splice(m,0,d[h]);m++;h++}lines.splice(m,0,c);if(lines[m][0]==""||lines[m][0]==" "){lines.splice(m,1);undoQue[undoQue.length-1].push(0)}else undoQue[undoQue.length-
1].push(1);pos.row=anch.row=m;pos.col=anch.col=0;if(pos.row>=lines.length){pos.row=anch.row=lines.length-1;pos.col=anch.col=lines[pos.row][0].length}}else{lines[pos.row][0]=lines[pos.row][0].slice(0,pos.col)+c+lines[pos.row][0].slice(pos.col);pos.col+=document.getElementById("ccp").value.length;anch.col=pos.col}pasting=false;justPasted=true;setTimeout("setJustPasted()",50)}}function setJustPasted(){justPasted=false}
function selection(){if(pos.row>anch.row)var d={row:anch.row,col:anch.col},c={row:pos.row,col:pos.col};else if(pos.row==anch.row&&pos.col>anch.col){d={row:anch.row,col:anch.col};c={row:pos.row,col:pos.col}}else{d={row:pos.row,col:pos.col};c={row:anch.row,col:anch.col}}if(d.row==c.row)d=lines[d.row][0].slice(d.col,c.col);else{arr=[];arr.push([lines[d.row][0].slice(d.col),lines[d.row][1]]);for(d.row=d.row*1+1;d.row<c.row;){arr.push([lines[d.row][0],lines[d.row][1]]);d.row+=1}arr.push([lines[c.row][0].slice(0,
c.col),lines[c.row][1]]);d=JSON.stringify(arr)}c=document.getElementById("ccp");c.value=d;if(!findForcePaint){c.focus();c.select()}}
function setup(){resource_id=window.location.href.split("=")[1];$.post("/scriptcontent",{resource_id:resource_id},function(d){if(d=="not found"){lines=[["Sorry, the script wasn't found.",1]];paint(true,false,false)}else{var c=JSON.parse(d);d=c[0];document.getElementById("title").innerHTML=d;document.title=d;var h=c[1];for(d=0;d<h.length;d++)lines.push([h[d][0],h[d][1]]);if(lines.length==2){pos.row=1;anch.row=1;pos.col=lines[1][0].length;anch.col=pos.col}if(c[2].length!=0){h=c[2][0];var m=c[2][1];
for(w in h)spellWrong.push(h[w]);for(d in m)spellIgnore.push(m[d])}for(d in c[3])notes.push(c[3][d]);c=c[4];h=document.getElementById("hasAccess");for(d in c){m=h.appendChild(document.createElement("tr"));m.id=c[d];m.appendChild(document.createElement("td")).appendChild(document.createTextNode(c[d]));m=m.appendChild(document.createElement("td")).appendChild(document.createElement("a"));m.appendChild(document.createTextNode("Remove Access"));m.href="javascript:removeAccess('"+c[d]+"')"}document.getElementById("canvas").getContext("2d");
tabs(0);characterInit();sceneIndex();noteIndex();document.getElementById("ccp").focus();document.getElementById("ccp").select();document.getElementById("saveButton").value="Saved";document.getElementById("saveButton").disabled=true;paint(true,false,false);setInterval("paint(false,false,false)",25);w=null}})}
function tabs(d){var c=["sceneTab","noteTab"];for(i in c){var h=document.getElementById(c[i]);if(i==d){h.style.backgroundColor="#3F5EA6";h.style.color="white";document.getElementById(c[i].replace("Tab","s")).style.display="block"}else{h.style.backgroundColor="#6C8CD5";h.style.color="black";document.getElementById(c[i].replace("Tab","s")).style.display="none"}}i=null}
function changeFormat(d){document.getElementById("suggestBox")!=null&&document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"));saveTimer();undoQue.push(["format",pos.row,pos.col,lines[pos.row][1],d]);redoQue=[];lines[pos.row][1]=d;anch.col=pos.col;anch.row=pos.row;if(lines[pos.row][1]==4){if(lines[pos.row][0].charAt(0)!="("){lines[pos.row][0]="("+lines[pos.row][0];pos.col++;anch.col++}if(lines[pos.row][0].charAt(lines[pos.row][0].length-1)!=")")lines[pos.row][0]+=
")"}if(lines[pos.row][1]==3){if(lines[pos.row][0].charAt(0)=="("){lines[pos.row][0]=lines[pos.row][0].substr(1);pos.col--;anch.col--}if(lines[pos.row][0].charAt(lines[pos.row][0].length-1)==")")lines[pos.row][0]=lines[pos.row][0].slice(0,-1)}sceneIndex()}
function contextmenu(d){if(d.clientX>headerHeight&&d.clientX<editorWidth-100&&d.clientY-headerHeight>40&&d.target.id=="canvas"){d.preventDefault();var c=document.body.appendChild(document.createElement("div"));c.style.position="fixed";c.style.top=d.clientY-3+"px";c.style.left=d.clientX+5+"px";c.id="context_menu";for(i in formats){d=c.appendChild(document.createElement("div"));d.innerHTML=formats[i];d.id="cm"+i;d.className="contextUnit";d=null}c=i=null;$(".contextUnit").mouseover(function(){this.style.backgroundColor=
"LightSkyBlue"});$(".contextUnit").mouseout(function(){this.style.backgroundColor="white"})}}function mouseUp(d){scrollBarBool=mouseDownBool=false;document.getElementById("canvas");var c=document.getElementById("canvas").height;if(d.clientY-headerHeight>c-39&&d.clientY-headerHeight<c&&d.clientX>editorWidth-22&&d.clientX<editorWidth-2)d.clientY-headerHeight>c-20?scroll(30):scroll(-30)}
function mouseDown(d){checkSpell&&ajaxSpell(pos.row);for(var c=false,h=document.getElementsByTagName("div"),m=0;m<h.length;m++)if(h[m].className=="topMenu"&&h[m].style.display=="block"){c=true;var o=h[m]}if(c){for(d=d.target;d.nodeName!="DIV";)d=d.parentNode;id=d.id;id.slice(0,-1)=="format"&&changeFormat(id.slice(-1));if(id=="save")save(0);else if(id=="new")resource_id=="Demo"?alert("Sorry, you'll have to login to start saving."):newScriptPrompt();else if(id=="open")resource_id=="Demo"?alert("Sorry, you'll have to login to open new scripts."):
openPrompt();else if(id=="rename")renamePrompt();else if(id=="exportas")exportPrompt();else if(id=="duplicate")if(resource_id=="Demo"){alert("Sorry, you'll have to login to start doing that.");return}else duplicate();else if(id=="close")closeScript();else if(id=="undo")undo();else if(id=="redo")redo();else if(id=="insertNote"){viewNotes=true;newThread()}else if(id=="editTitlePage")window.open("/titlepage?resource_id="+resource_id);else if(id=="tag")if(resource_id=="Demo"){alert("Sorry, you'll have to login to start doing that.");
return}else tagPrompt();else if(id=="spellCheck")launchSpellCheck();else if(id=="find")findPrompt();else if(id=="findReplace")findReplacePrompt();else if(id=="revision")if(resource_id=="Demo"){alert("Sorry, you'll have to login to start doing that.");return}else window.open("/revisionhistory?resource_id="+resource_id);else if(id=="notes"){viewNotes=viewNotes?false:true;document.getElementById("notesViewHide").innerHTML=viewNotes==true?"\u2713":""}else if(id=="collaborators")if(resource_id=="Demo"){alert("Sorry, you'll have to login to start doing that.");
return}else sharePrompt();else if(id=="email")if(resource_id=="Demo"){alert("Sorry, you'll have to login to email scripts.");return}else emailPrompt();o.style.display="none";id=null}else if(document.getElementById("suggestBox")!=null){if(d.target.className=="suggestItem"){o=lines[pos.row][0].length;lines[pos.row][0]=d.target.value;undoQue.push(["paste",pos.row,pos.col,lines[pos.row][0].substr(o)]);pos.col=anch.col=lines[pos.row][0].length}$(".suggestItem").unbind();document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"))}else if(document.getElementById("context_menu")!=
null){d.target.className=="contextUnit"&&changeFormat(d.target.id.replace("cm",""));$(".contextUnit").unbind();document.getElementById("context_menu").parentNode.removeChild(document.getElementById("context_menu"))}else{c=document.getElementById("canvas").height;h=(pageBreaks.length+1)*72*lineheight;o=c/h*(c-39);if(o<20)o=20;if(o>=c-39)o=c-39;c=vOffset/(h-c)*(c-39-o)+headerHeight;if(d.clientX>headerHeight&&d.clientX<editorWidth-100&&d.clientY-headerHeight>40&&d.target.id=="canvas"){mouseDownBool=
true;mousePosition(d,"anch")}else if(d.clientX<editorWidth&&d.clientX>editorWidth-20&&d.clientY>c&&d.clientY<c+o)scrollBarBool=true}}
function mousePosition(d,c){milli=(new Date).getMilliseconds();var h=0,m=d.clientY+vOffset-26,o=15*lineheight+3,q=0;for(i in lines){q=o;if(pageBreaks.length!=0&&pageBreaks[h]!=undefined&&pageBreaks[h][0]==i){if(pageBreaks[h][2]==0)o=72*lineheight*(h+1)+10*lineheight+headerHeight+3-26;else{o=72*lineheight*(h+1)+10*lineheight+headerHeight+3;o+=(linesNLB[i].length-pageBreaks[h][2])*lineheight-26;if(lines[i][1]==3)o+=lineheight;o-=lineheight*linesNLB[i].length}h++}o+=lineheight*linesNLB[i].length;if(o>
m){o=pageBreaks.length!=0&&pageBreaks[h-1]!=undefined&&pageBreaks[h-1][0]==i&&pageBreaks[h-1][2]!=0?(m-q)/lineheight<pageBreaks[h-1][2]?Math.round((m-q)/lineheight+0.5):m<72*lineheight*h+10*lineheight+headerHeight?pageBreaks[h-1][2]:Math.round((lineheight*linesNLB[i].length-o+m)/lineheight+0.5):Math.round((lineheight*linesNLB[i].length-o+m)/lineheight+0.5);for(m=h=0;h+1<o;){m+=linesNLB[i][h]+1;h++}o=lines[i][1]!=5?Math.round((d.clientX-Math.round((editorWidth-fontWidth*87-24)/2)-WrapVariableArray[lines[i][1]][1])/
fontWidth):Math.round((d.clientX-Math.round((editorWidth-fontWidth*87-24)/2)-WrapVariableArray[lines[i][1]][1]+lines[i][0].length*fontWidth)/fontWidth);if(o<0)o=0;if(o>linesNLB[i][h])o=linesNLB[i][h];m+=o;if(m<0)m=0;if(m>lines[i][0].length)m=lines[i][0].length;if(c=="anch"){pos.row=anch.row=i*1;pos.col=anch.col=m*1}else{pos.row=i;pos.col=m}return}}}
function mouseMove(d){scrollBarBool&&scrollBarDrag(d);mouseY=d.clientY;mouseDownBool&&mousePosition(d,"pos");var c=document.getElementById("canvas").height,h=(pageBreaks.length+1)*72*lineheight,m=c/h*(c-39);if(m<20)m=20;if(m>=c-39)m=c-39;c=vOffset/(h-c)*(c-39-m)+headerHeight;document.getElementById("canvas").style.cursor=d.clientX<editorWidth&&d.clientX>editorWidth-20&&d.clientY>c&&d.clientY<c+m?"default":"text"}
function scrollBarDrag(d){d=mouseY-d.clientY;var c=document.getElementById("canvas").height-50,h=(pageBreaks.length+1)*72*lineheight;vOffset-=h/c*d;if(vOffset<0)vOffset=0;h=(pageBreaks.length+1)*72*lineheight-document.getElementById("canvas").height+20;if(vOffset>h)vOffset=h+20}
function scroll(d){vOffset+=d;if(vOffset<0)vOffset=0;d=(pageBreaks.length+1)*72*lineheight-document.getElementById("canvas").height+20;if(vOffset>d)vOffset=d+20;milli=(new Date).getMilliseconds();if(document.getElementById("suggestBox")!=null){paint(false,false,false);createSuggestBox(lines[pos.row][1]==0?"s":"c")}}
function jumpTo(d){if(d[0]=="r"){d=parseInt(d.replace("row",""));pos.row=d;anch.row=pos.row;pos.col=lines[pos.row][0].length;anch.col=pos.col}else d=d[0]=="f"?parseInt(d.replace("find","")):pos.row;for(var c=0,h=0;h<d;h++){for(var m=0;m<pageBreaks.length;m++)if(pageBreaks[m][0]==h){c=lineheight*72*(m*1+1);if(pageBreaks[m][2]!=0)c-=lineheight*(linesNLB[h].length-pageBreaks[m][2])}c+=linesNLB[h].length*lineheight}vOffset=c;d=(pageBreaks.length+1)*72*lineheight-document.getElementById("canvas").height;
if(vOffset>d)vOffset=d}
function upArrow(){if(typeToScript&&document.getElementById("suggestBox")==null){if(!(pos.row==0&&pos.col==0)){var d=lines[pos.row][1];if(d==0)var c=WrapVariableArray[0];else if(d==1)c=WrapVariableArray[1];else if(d==2)c=WrapVariableArray[2];else if(d==3)c=WrapVariableArray[3];else if(d==4)c=WrapVariableArray[4];else if(d==5)c=WrapVariableArray[5];if(lines[pos.row][0].length>c[0]){var h=lines[pos.row][0].split(" "),m=0;for(d=[];m<h.length;){if(h[m].length>=c[0]){d.push(h[m].length);m++}if(h.slice(m).join().length<=
c[0]){d.push(h.slice(m).join().length);m=h.length}else{for(var o=0;h.slice(m,m+o).join().length<c[0];)o++;d.push(h.slice(m,m+o-1).join().length);m+=o-1}}o=0;for(h=d[0];h<pos.col;){o++;h+=d[o]+1}if(pos.row==0&&o==0){pos.col=anch.col=0;return}if(o==0){checkSpell&&ajaxSpell(pos.row);d=lines[pos.row-1][1];if(d==0)var q=WrapVariableArray[0];else if(d==1)q=WrapVariableArray[1];else if(d==2)q=WrapVariableArray[2];else if(d==3)q=WrapVariableArray[3];else if(d==4)q=WrapVariableArray[4];else if(d==5)q=WrapVariableArray[5];
if(lines[pos.row-1][0].length<q[0])pos.row--;else{h=lines[pos.row-1][0].split(" ");m=0;for(d=[];m<h.length;)if(h[m].length>=c[0]){d.push(h[m].length);m++}else if(h.slice(m).join().length<=c[0]){d.push(h.slice(m).join().length);m=h.length}else{for(o=0;h.slice(m,m+o).join().length<c[0];)o++;d.push(h.slice(m,m+o-1).join().length);m+=o-1}pos.row--;pos.col+=lines[pos.row][0].length-d[d.length-1]}if(pos.col>lines[pos.row][0].length)pos.col=lines[pos.row][0].length}else{pos.col-=d[o-1]+1;if(pos.col>h-d[o]-
1)pos.col=h-d[o]-1}}else if(pos.row==0)pos.col=0;else{checkSpell&&ajaxSpell(pos.row);d=lines[pos.row-1][1];if(d==0)q=WrapVariableArray[0];else if(d==1)q=WrapVariableArray[1];else if(d==2)q=WrapVariableArray[2];else if(d==3)q=WrapVariableArray[3];else if(d==4)q=WrapVariableArray[4];else if(d==5)q=WrapVariableArray[5];if(lines[pos.row-1][0].length<q[0])pos.row--;else{h=lines[pos.row-1][0].split(" ");m=0;for(d=[];m<h.length;)if(h[m].length>=c[0]){d.push(h[m].length);m++}else if(h.slice(m).join().length<=
c[0]){d.push(h.slice(m).join().length);m=h.length}else{for(o=0;h.slice(m,m+o).join().length<c[0];)o++;d.push(h.slice(m,m+o-1).join().length);m+=o-1}pos.row--;pos.col+=lines[pos.row][0].length-d[d.length-1]}if(pos.col>lines[pos.row][0].length)pos.col=lines[pos.row][0].length}if(!shiftDown){anch.col=pos.col;anch.row=pos.row}ud<0&&paint(false,false,false)}}else if(document.getElementById("suggestBox")!=null){c=document.getElementById("focus");c.removeAttribute("id");c=c.previousSibling;if(c==null)c=
document.getElementById("suggestBox").lastChild;if(c.nodeType=="#text")c=c.previousSibling;if(c==null)c=document.getElementById("suggestBox").lastChild;c.id="focus"}}
function downArrow(){if(typeToScript&&document.getElementById("suggestBox")==null){if(!(pos.row==lines.length-1&&pos.col==lines[pos.row][0].length)){var d=lines[pos.row][1];if(d==0)var c=WrapVariableArray[0];else if(d==1)c=WrapVariableArray[1];else if(d==2)c=WrapVariableArray[2];else if(d==3)c=WrapVariableArray[3];else if(d==4)c=WrapVariableArray[4];else if(d==5)c=WrapVariableArray[5];if(lines[pos.row][0].length>c[0]){var h=lines[pos.row][0].split(" "),m=0;for(d=[];m<h.length;)if(h[m].length>=c[0]){d.push(h[m].length);
m++}else if(h.slice(m).join().length<=c[0]){d.push(h.slice(m).join().length);m=h.length}else{for(var o=0;h.slice(m,m+o).join().length<c[0];)o++;d.push(h.slice(m,m+o-1).join().length);m+=o-1}o=0;for(c=d[0];c<pos.col;){o++;c+=d[o]+1}if(o+1==d.length){checkSpell&&ajaxSpell(pos.row);for(c=0;c<d.length-1;c++)pos.col-=d[c];pos.col--;pos.row++;if(pos.row>lines.length-1){pos.row--;pos.col=lines[pos.row][0].length}if(pos.col>lines[pos.row][0].length)pos.col=lines[pos.row][0].length}else{pos.col+=d[o]+1;if(pos.col>
c+d[o+1]+1)pos.col=c+d[o+1]+1}}else if(pos.row==lines.length-1)pos.col=lines[pos.row][0].length;else{pos.row++;if(pos.row>lines.length-1)pos.row=lines.length-1;if(pos.col>lines[pos.row][0].length)pos.col=lines[pos.row][0].length}if(!shiftDown){anch.col=pos.col;anch.row=pos.row}ud>document.getElementById("canvas").height-50&&paint(false,false,false)}}else if(document.getElementById("suggestBox")!=null){d=document.getElementById("focus");d.removeAttribute("id");d=d.nextSibling;if(d==null)d=document.getElementById("suggestBox").firstChild;
if(d.nodeType=="#text")d=d.nextSibling;if(d==null)d=document.getElementById("suggestBox").firstChild;d.id="focus"}}function leftArrow(){if(typeToScript){var d=false;if(!(pos.row==0&&pos.col==0)){if(pos.col==0){checkSpell&&ajaxSpell(pos.row);pos.row--;pos.col=lines[pos.row][0].length;d=true}else pos.col-=1;if(!shiftDown){anch.col=pos.col;anch.row=pos.row}var c=document.getElementById("suggestBox");d&&c!=null&&c.parentNode.removeChild(c)}}}
function rightArrow(){if(typeToScript){var d=false;if(!(pos.col==lines[pos.row][0].length&&pos.row==lines.length-1)){if(pos.col==lines[pos.row][0].length){checkSpell&&ajaxSpell(pos.row);pos.row++;pos.col=0;d=true}else pos.col+=1;if(!shiftDown){anch.col=pos.col;anch.row=pos.row}var c=document.getElementById("suggestBox");d&&c!=null&&c.parentNode.removeChild(c)}}}
function backspace(d){if(typeToScript){saveTimer();redoQue=[];d&&d.preventDefault();var c=d=false;if(lines[pos.row][1]==0)c=true;if(pos.row==anch.row&&pos.col==anch.col){if(pos.col==0&&pos.row==0)return;else if(lines[pos.row][1]==4&&pos.col==1){for(x in notes){if(pos.row<notes[x][0])notes[x][0]-=1;else if(pos.row==notes[x][0]){notes[x][1]+=lines[pos.row-1][0].length;notes[x][0]-=1}if(notes[x][1]<0)notes[x][1]=0}c=lines[pos.row][0];if(c.charAt(0)=="(")c=c.substr(1);if(c.charAt(c.length-1)==")")c=c.slice(0,
-1);var h=lines[pos.row-1][0].length;lines.splice(pos.row,1);pos.row--;pos.col=h;lines[pos.row][0]+=c;undoQue.push(["back",pos.row,pos.col,"line",4]);c=true;document.getElementById("suggestBox")!=null&&document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"))}else if(pos.col==0){for(x in notes){if(pos.row<notes[x][0])notes[x][0]-=1;else if(pos.row==notes[x][0]){notes[x][1]+=lines[pos.row-1][0].length;notes[x][0]-=1}if(notes[x][1]<0)notes[x][1]=0}var m=lines[pos.row][1];
c=lines[pos.row][0];lines.splice(pos.row,1);h=lines[pos.row-1][0].length;lines[pos.row-1][0]+=c;pos.col=h;pos.row--;undoQue.push(["back",pos.row,pos.col,"line",m]);c=d=true;document.getElementById("suggestBox")!=null&&document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"))}else{undoQue.push(["back",pos.row,pos.col,lines[pos.row][0][pos.col-1]]);lines[pos.row][0]=lines[pos.row][0].slice(0,pos.col-1)+lines[pos.row][0].slice(pos.col);pos.col--;for(x in notes)if(pos.row==
notes[x][0])if(pos.col<notes[x][1])notes[x][1]-=1}anch.col=pos.col;anch.row=pos.row}else{document.getElementById("suggestBox")!=null&&document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"));d=true;var o=false;if(anch.row>pos.row)o=true;if(anch.row==pos.row&&anch.col>pos.col)o=true;if(o){o=anch.row;anch.row=pos.row;pos.row=o;o=anch.col;anch.col=pos.col;pos.col=o}for(o=0;pos.col!=anch.col||pos.row!=anch.row;){o++;if(lines[pos.row][1]==0)c=true;if(pos.col==
0){for(x in notes){if(pos.row<notes[x][0])notes[x][0]-=1;else if(pos.row==notes[x][0]){notes[x][1]+=lines[pos.row-1][0].length;notes[x][0]-=1}if(notes[x][1]<0)notes[x][1]=0}m=lines[pos.row][1];c=lines[pos.row][0];lines.splice(pos.row,1);h=lines[pos.row-1][0].length;lines[pos.row-1][0]+=c;pos.col=h;pos.row--;undoQue.push(["back",pos.row,pos.col,"line",m]);c=true}else{undoQue.push(["back",pos.row,pos.col,lines[pos.row][0][pos.col-1]]);lines[pos.row][0]=lines[pos.row][0].slice(0,pos.col-1)+lines[pos.row][0].slice(pos.col);
pos.col--;for(x in notes)if(pos.row==notes[x][0])if(pos.col<notes[x][1])notes[x][1]-=1}}undoQue.push(["br",o])}if(d==true){sceneIndex();paint(d,false,false)}c&&updateOneScene(pos.row);document.getElementById("find_div").style.display=="block"&&findInputKeyUp({which:1E3},"f");document.getElementById("find_replace_div").style.display=="block"&&findInputKeyUp({which:1E3},"r")}}
function deleteButton(){if(typeToScript){saveTimer();redoQue=[];document.getElementById("suggestBox")!=null&&document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"));var d=false,c=false;if(pos.row==anch.row&&pos.col==anch.col){if(lines[pos.row][1]==0)d=true;if(pos.col==lines[pos.row][0].length&&pos.row==lines.length-1)return;if(lines[pos.row][1]==4&&lines[pos.row][0]=="()"){undoQue.push(["delete",pos.row,pos.col,"line",4]);lines.splice(pos.row,1);pos.col=
0;anch.col=0}else if(pos.col==lines[pos.row][0].length){for(x in notes){if(pos.row+1==notes[x][0]){notes[x][1]+=lines[pos.row][0].length;notes[x][0]-=1}else if(pos.row<notes[x][0])notes[x][0]-=1;if(notes[x][1]<0)notes[x][1]=0}undoQue.push(["delete",pos.row,pos.col,"line",lines[pos.row+1][1]]);if(lines[pos.row+1][1]==0)d=true;var h=lines[pos.row+1][0];lines.splice(pos.row+1,1);lines[pos.row][0]+=h;c=true}else{undoQue.push(["delete",pos.row,pos.col,lines[pos.row][0][pos.col]]);lines[pos.row][0]=lines[pos.row][0].slice(0,
pos.col)+lines[pos.row][0].slice(pos.col+1);for(x in notes)if(pos.row==notes[x][0])if(pos.col<notes[x][1])notes[x][1]-=1}}else{c=true;h=false;if(anch.row>pos.row)h=true;if(anch.row==pos.row&&anch.col>pos.col)h=true;if(h){h=anch.row;anch.row=pos.row;pos.row=h;h=anch.col;anch.col=pos.col;pos.col=h}for(var m=0;pos.col!=anch.col||pos.row!=anch.row;){m++;if(lines[pos.row][1]==0)d=true;if(pos.col==0){for(x in notes){if(pos.row+1==notes[x][0]){notes[x][1]+=lines[pos.row][0].length;notes[x][0]-=1}else if(pos.row<
notes[x][0])notes[x][0]-=1;if(notes[x][1]<0)notes[x][1]=0}undoQue.push(["delete",pos.row-1,lines[pos.row-1][0].length,"line",lines[pos.row][1]]);h=lines[pos.row][0];lines.splice(pos.row,1);d=lines[pos.row-1][0].length;lines[pos.row-1][0]+=h;pos.col=d;pos.row--;d=true}else{undoQue.push(["delete",pos.row,pos.col,lines[pos.row][0][pos.col-1]]);lines[pos.row][0]=lines[pos.row][0].slice(0,pos.col-1)+lines[pos.row][0].slice(pos.col);pos.col--;for(x in notes)if(pos.row==notes[x][0])if(pos.col<notes[x][1])notes[x][1]-=
1}}undoQue.push(["dr",m])}if(c==true){sceneIndex();paint(c,false,false)}d&&updateOneScene(pos.row);document.getElementById("find_div").style.display=="block"&&findInputKeyUp({which:1E3},"f");document.getElementById("find_replace_div").style.display=="block"&&findInputKeyUp({which:1E3},"r")}}
function enter(){if(typeToScript&&document.getElementById("suggestBox")==null){saveTimer();checkSpell&&ajaxSpell(pos.row);lines[pos.row][0]=lines[pos.row][0].replace(/\s+$/,"");for(x in notes){if(pos.row<notes[x][0])notes[x][0]+=1;if(pos.row==notes[x][0]&&pos.col<notes[x][1]){notes[x][1]-=pos.col;notes[x][0]+=1}}undoQue.push(["enter",pos.row,pos.col]);redoQue=[];lines[pos.row][1]==2&&characterIndex(lines[pos.row][0]);var d=lines[pos.row][0].slice(0,pos.col),c=lines[pos.row][0].slice(pos.col);lines[pos.row][0]=
d;if(lines[pos.row][1]==0)var h=1;else if(lines[pos.row][1]==1)h=2;else if(lines[pos.row][1]==2)h=3;else if(lines[pos.row][1]==4)h=3;else if(lines[pos.row][1]==3)h=2;else if(lines[pos.row][1]==5)h=0;lines.splice(pos.row+1,0,[c,h]);pos.row++;pos.col=0;anch.row=pos.row;anch.col=pos.col;document.getElementById("find_div").style.display=="block"&&findInputKeyUp({which:1E3},"f");document.getElementById("find_replace_div").style.display=="block"&&findInputKeyUp({which:1E3},"r");paint(true,"enter",false);
paint(false,"enter",false)}else if(document.getElementById("suggestBox")!=null){saveTimer();d=lines[pos.row][0].length;lines[pos.row][0]=document.getElementById("focus").value;undoQue.push(["paste",pos.row,pos.col,lines[pos.row][0].substr(d)]);document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"));pos.col=anch.col=lines[pos.row][0].length}sceneIndex();document.getElementById("find_div").style.display=="block"&&findInputKeyUp({which:1E3},"f");document.getElementById("find_replace_div").style.display==
"block"&&findInputKeyUp({which:1E3},"r")}
function tab(){if(typeToScript){document.getElementById("suggestBox")!=null&&document.getElementById("suggestBox").parentNode.removeChild(document.getElementById("suggestBox"));saveTimer();undoQue.push(["format",pos.row,pos.col,lines[pos.row][1],"tab"]);redoQue=[];var d=false;if(lines[pos.row][1]==0)d=true;var c=lines[pos.row][1];if(c==1){lines[pos.row][1]=0;d=true}else if(c==0)lines[pos.row][1]=2;else if(c==2)lines[pos.row][1]=1;else if(c==3)lines[pos.row][1]=4;else if(c==4)lines[pos.row][1]=3;else if(c==
5){lines[pos.row][1]=0;d=true}d&&sceneIndex();if(lines[pos.row][1]==4){if(lines[pos.row][0].charAt(0)!="("){lines[pos.row][0]="("+lines[pos.row][0];pos.col++;anch.col++}if(lines[pos.row][0].charAt(lines[pos.row][0].length-1)!=")")lines[pos.row][0]+=")"}if(lines[pos.row][1]==3){if(lines[pos.row][0].charAt(0)=="("){lines[pos.row][0]=lines[pos.row][0].substr(1);pos.col--;anch.col--}if(lines[pos.row][0].charAt(lines[pos.row][0].length-1)==")")lines[pos.row][0]=lines[pos.row][0].slice(0,-1)}}}
function handlekeypress(d){if(!findForcePaint)if(typeToScript&&!commandDownBool){d.preventDefault();redoQue=[];milli=(new Date).getMilliseconds();if(d.which!=13&&d.which!=37&&d.which!=0&&d.which!=8){if(pos.row!=anch.row||pos.col!=anch.col)deleteButton();undoQue.push([String.fromCharCode(d.charCode),pos.row,pos.col]);lines[pos.row][0]=lines[pos.row][0].slice(0,pos.col)+String.fromCharCode(d.charCode)+lines[pos.row][0].slice(pos.col);pos.col++;lines[pos.row][1]==0&&updateOneScene(pos.row);lines[pos.row][1]==
2&&createSuggestBox("c");lines[pos.row][1]==0&&createSuggestBox("s");for(x in notes)if(pos.row==notes[x][0])if(pos.col-1<=notes[x][1])notes[x][1]+=1;saveTimer();anch.col=pos.col;anch.row=pos.row}document.getElementById("find_div").style.display=="block"&&findInputKeyUp({which:1E3},"f");document.getElementById("find_replace_div").style.display=="block"&&findInputKeyUp({which:1E3},"r");document.getElementById("ccp").focus();document.getElementById("ccp").select()}}
function undo(){saveTimer();if(undoQue.length!=0){var d=false,c=undoQue.pop(),h=[];for(x in c)h.push(c[x]);redoQue.push(h);if(c[0]=="enter"){d=lines[c[1]+1][0];lines.splice(c[1]+1,1);if(lines[c[1]][1]==4&&lines[c[1]][0].charAt(lines[c[1]][0].length-1)==")")lines[c[1]][0]=lines[c[1]][0].slice(0,-1);lines[c[1]][0]+=d;d=true}else if(c[0]=="back")if(c[3]=="line"){for(x in notes)if(c[1]==notes[x][0]){if(c[2]<=notes[x][1]){notes[x][0]+=1;notes[x][1]-=c[2]}}else if(c[1]<notes[x][0])notes[x][0]+=1;d=lines[c[1]][0].slice(0,
c[2]);h=lines[c[1]][0].slice(c[2]);if(c[4]==3&&h.charAt(h.length-1)==")")h=h.slice(0,-1);lines[c[1]][0]=d;d=[h,c[4]];lines.splice(c[1]+1,0,d);c[1]+=1;c[2]=0;d=true}else{lines[c[1]][0]=lines[c[1]][0].slice(0,c[2]-1)+c[3]+lines[c[1]][0].slice(c[2]-1);lines[c[1]][1]==0&&updateOneScene(c[1]);for(x in notes)if(c[1]==notes[x][0])if(c[2]<=notes[x][1])notes[x][1]+=1}else if(c[0]=="delete")if(c[3]=="line"){d=lines[c[1]][0].slice(0,c[2]);h=lines[c[1]][0].slice(c[2]);if(c[4]==3&&h.charAt(h.length-1)==")")h=
h.slice(0,-1);lines[c[1]][0]=d;d=[h,c[4]];lines.splice(c[1]+1,0,d);d=true}else{lines[c[1]][0]=lines[c[1]][0].slice(0,c[2])+c[3]+lines[c[1]][0].slice(c[2]);lines[c[1]][1]==0&&updateOneScene(c[1])}else if(c[0]=="format"){lines[c[1]][1]=c[3];if(lines[c[1]][0].charAt(0)=="(")lines[c[1]][0]=lines[c[1]][0].substr(1);if(lines[c[1]][0].charAt(lines[c[1]][0].length-1)==")")lines[c[1]][0]=lines[c[1]][0].slice(0,-1);d=true}else if(c[0]=="br"||c[0]=="dr")for(var m=c[1],o=0;o<m;o++){c=undoQue.pop();h=[];for(x in c)h.push(c[x]);
redoQue.splice(redoQue.length-1,0,h);if(c[3]=="line"){d=lines[c[1]][0].slice(0,c[2]);h=lines[c[1]][0].slice(c[2]);if(c[4]==3&&h.charAt(h.length-1)==")")h=h.slice(0,-1);lines[c[1]][0]=d;d=[h,c[4]];lines.splice(c[1]+1,0,d);c[1]+=1;c[2]=0;d=true}else{lines[c[1]][0]=lines[c[1]][0].slice(0,c[2]-1)+c[3]+lines[c[1]][0].slice(c[2]-1);lines[c[1]][1]==0&&updateOneScene(c[1])}}else if(c[0]=="paste")if(c[3][0]!="["&&c[3][1]!="["){lines[c[1]][0]=lines[c[1]][0].slice(0,c[2])+lines[c[1]][0].slice(c[2]+c[3].length);
lines[c[1]][1]==0&&updateOneScene(c[1])}else{d=true;m=JSON.parse(c[3]);if(c[4]==0)lines.splice(c[1]+1,m.length);else{lines[c[1]][0]=lines[c[1]][0].slice(0,c[2]);lines.splice(c[1]+1,m.length-1)}if(c[5]==1){lines[c[1]][0]+=lines[c[1]+1][0];lines.splice(c[1]+1,1)}}else{lines[c[1]][0]=lines[c[1]][0].slice(0,c[2])+lines[c[1]][0].slice(c[2]+1);if(lines[c[1]][1]==4&&lines[c[1]][0][c[2]-1]==")"){lines[c[1]][0]=lines[c[1]][0].slice(0,c[2])+lines[c[1]][0].slice(c[2]+1);c[2]-=1}lines[c[1]][1]==0&&updateOneScene(c[1]);
for(x in notes)if(c[1]==notes[x][0])if(c[2]<notes[x][1])notes[x][1]-=1}pos.row=c[1];pos.col=c[2];anch.row=pos.row;anch.col=pos.col;if(d==true){sceneIndex();paint(true,false,false)}}}
function redo(){saveTimer();if(redoQue.length!=0){var d=false,c=redoQue.pop(),h=[];for(x in c)h.push(c[x]);undoQue.push(h);d=false;if(c[0]=="enter"){h=lines[c[1]][0].slice(0,c[2]);d=lines[c[1]][0].slice(c[2]);lines[c[1]][0]=h;if(lines[c[1]][1]==0)var m=1;else if(lines[c[1]][1]==1)m=2;else if(lines[c[1]][1]==2)m=3;else if(lines[c[1]][1]==4)m=3;else if(lines[c[1]][1]==3)m=2;else if(lines[c[1]][1]==5)m=0;lines.splice(c[1]+1,0,[d,m]);c[1]+=1;c[2]=0;d=true}else if(c[0]=="back")if(c[3]!="line"){lines[c[1]][0]=
lines[c[1]][0].slice(0,c[2]-1)+lines[c[1]][0].slice(c[2]);c[2]-=1;lines[c[1]][1]==0&&updateOneScene(c[1])}else{h=lines[c[1]+1][0];lines.splice(c[1]+1,1);lines[c[1]][0]+=h;d=true}else if(c[0]=="delete")if(c[3]!="line"){lines[c[1]][0]=lines[c[1]][0].slice(0,c[2])+lines[c[1]][0].slice(c[2]+1);lines[c[1]][1]==0&&updateOneScene(c[1])}else{h=lines[c[1]+1][0];lines.splice(c[1]+1,1);lines[c[1]][0]+=h}else if(c[0]=="format"){if(c[4]!="tab")lines[c[1]][1]=c[4];else{h=c[3];if(h==0)lines[c[1]][1]=2;else if(h==
1)lines[c[1]][1]=0;else if(h==2)lines[c[1]][1]=1;else if(h==3)lines[c[1]][1]=4;else if(h==4)lines[c[1]][1]=3;else if(h==5)lines[c[1]][1]=0}d=true}else if(c[0]=="br"){var o=c[1];for(m=0;m<o;m++){c=redoQue.pop();h=[];for(x in c)h.push(c[x]);undoQue.splice(undoQue.length-1,0,h);if(c[3]=="line"){h=lines[c[1]+1][0];lines.splice(c[1]+1,1);lines[c[1]][0]+=h;d=true}else{lines[c[1]][0]=lines[c[1]][0].slice(0,c[2]-1)+lines[c[1]][0].slice(c[2]);lines[c[1]][1]==0&&updateOneScene(c[1])}}c[2]-=1}else if(c[0]==
"dr"){o=c[1];for(m=0;m<o;m++){c=redoQue.pop();h=[];for(x in c)h.push(c[x]);undoQue.splice(undoQue.length-1,0,h);if(c[3]=="line"){h=lines[c[1]+1][0];lines.splice(c[1]+1,1);lines[c[1]][0]+=h;d=true}else{lines[c[1]][0]=lines[c[1]][0].slice(0,c[2]-1)+lines[c[1]][0].slice(c[2]);lines[c[1]][1]==0&&updateOneScene(c[1])}}c[2]-=1}else if(c[0]=="paste")if(c[3][0]!="["&&c[3][1]!="["){lines[c[1]][0]=lines[c[1]][0].slice(0,c[2])+c[3]+lines[c[1]][0].slice(c[2]);lines[c[1]][1]==0&&updateOneScene(c[1])}else{d=true;
o=JSON.parse(c[3]);if(lines[c[1]][0]=="")lines[c[1]][1]=o[0][1];if(lines[c[1]][1]==o[0][1]){h=[lines[c[1]][0].slice(c[2]),lines[c[1]][1]];lines[c[1]][0]=lines[c[1]][0].slice(0,c[2])+o[0][0];m=1;c=c[1]+1}else{h=[lines[c[1]][0].slice(c[2]),lines[c[1]][1]];lines[c[1]][0]=lines[c[1]][0].slice(0,c[2]);c[1]++;lines.splice(c[1],0,o[0]);m=1;c=c[1]+1}for(;m<o.length;){lines.splice(c,0,o[m]);c++;m++}lines.splice(c,0,h);if(lines[c][0]==""||lines[c][0]==" ")lines.splice(c,1)}else{lines[c[1]][0]=lines[c[1]][0].slice(0,
c[2])+c[0]+lines[c[1]][0].slice(c[2]);c[2]+=1;lines[c[1]][1]==0&&updateOneScene(c[1])}if(d==true){sceneIndex();paint(true,false,false)}}}
function pagination(){pageBreaks=[];for(var d=i=0;i<lines.length;){for(lineCount=d;lineCount+linesNLB[i].length<56;){lineCount+=linesNLB[i].length;i++;if(i==lines.length)return}var c=0;d=0;if(lines[i][1]==3&&lineCount<54&&lineCount+linesNLB[i].length>57){c=55-lineCount;d=1-c;lineCount=56}else if(lines[i][1]==3&&lineCount<54&&linesNLB[i].length>4){c=linesNLB[i].length-3;d=1-c;lineCount=55}else if(lines[i][1]==1&&lineCount<55&&lineCount+linesNLB[i].length>57){c=55-lineCount;d=1-c;lineCount=56}else if(lines[i][1]==
1&&lineCount<55&&linesNLB[i].length>4){c=linesNLB[i].length-3;d=1-c;lineCount=55}else for(;lines[i-1][1]==0||lines[i-1][1]==2||lines[i-1][1]==4;){i--;lineCount-=linesNLB[i].length}pageBreaks.push([i,lineCount,c])}}function characterInit(){for(var d=0;d<lines.length;d++)lines[d][1]==2&&characterIndex(lines[d][0])}function characterIndex(d){d=d.toUpperCase().replace(/\s+$/,"");for(var c=false,h=0;h<characters.length;h++)if(characters[h][0]==d){characters[h][1]+=1;c=true}c||characters.push([d,1])}
function sceneIndex(){$(".sceneItem").unbind();scenes=[];for(var d=0,c=0;c<lines.length;c++)if(lines[c][1]==0){d++;var h="";if(c!=lines.length-1){h=lines[c+1][0];if((lines[c+1][1]==2||lines[c+1][1]==5)&&c!=lines.length-2)h+=" "+lines[c+2][0]}scenes.push([String(d)+") "+lines[c][0].toUpperCase(),c,h]);h=null}d=document.getElementById("sceneBox").childNodes;for(c=0;c<d.length;c++){d[c]!=undefined&&d[c].parentNode.removeChild(d[c]);c--}for(c=0;c<scenes.length;c++){d=document.getElementById("sceneBox").appendChild(document.createElement("p"));
d.appendChild(document.createTextNode(scenes[c][0]));d.className="sceneItem";d.id="row"+scenes[c][1];d.title=scenes[c][2];d=null}d=c=d=null;$(".sceneItem").click(function(){$(this).css("background-color","#999ccc");jumpTo(this.id)});$(".sceneItem").mouseover(function(){$(this).css("background-color","#ccccff")});$(".sceneItem").mouseout(function(){$(this).css("background-color","white")})}
function updateOneScene(d){try{var c=document.getElementById("row"+d),h=c.innerHTML.split(")")[0];c.removeChild(c.firstChild);c.appendChild(document.createTextNode(h+") "+lines[d][0].toUpperCase()))}catch(m){}}function sortNotes(d,c){if(d[0]<c[0])return-1;if(d[0]>c[0])return 1;if(d[1]<c[1])return-1;if(d[1]>c[1])return 1;return 0}function sortNotesCol(d,c){if(d[1]<c[1])return-1;if(d[1]>c[1])return 1;return 0}
function noteIndex(){notes.sort(sortNotes);var d=document.getElementById("noteBox");$(".respond, .msg").unbind();for(var c=0;c<d.childNodes.length;c++){d.removeChild(d.firstChild);c--}for(x in notes){var h=d.appendChild(document.createElement("div"));h.className="thread";var m=h.appendChild(document.createElement("table"));m.width="100%";m=m.appendChild(document.createElement("tr"));m.appendChild(document.createElement("td"));m=m.appendChild(document.createElement("td"));m.align="right";m=m.appendChild(document.createElement("a"));
m.style.backgroundColor="orange";m.appendChild(document.createTextNode("Delete"));m.href="javascript:deleteThread('"+notes[x][3]+"')";m.style.textDecoration="none";m.style.color="black";for(y in notes[x][2]){m=h.appendChild(document.createElement("div"));var o=m.appendChild(document.createElement("div"));o.innerHTML=notes[x][2][y][0];o=m.appendChild(document.createElement("div"));o.appendChild(document.createTextNode(notes[x][2][y][1].split("@")[0]));o.align="right";o.className="msgInfo";m.className=
"msg";m.id=notes[x][3]+"msg";m=o=o=null}h=h.appendChild(document.createElement("div"));h.className="respond";h.appendChild(document.createTextNode("Respond"));h.id=notes[x][3];h=m=m=m=h=null}typeToScript=true;$(".respond").click(function(){newMessage(this.id)});$(".msg").click(function(){for(c in notes)if(String(notes[c][3])==String(this.id.replace("msg",""))){pos.row=anch.row=notes[c][0];pos.col=anch.col=notes[c][1]}paint(false,false,false);ud>document.getElementById("canvas").height&&scroll(ud-
document.getElementById("canvas").height+200);ud<0&&scroll(ud-200)});x=c=null}
function newThread(){tabs(1);viewNotes=true;document.getElementById("notesViewHide").innerHTML="\u2713";paint(false,false,false);noteIndex();typeToScript=false;var d=document.getElementById("noteBox").appendChild(document.createElement("div"));d.className="thread";id=Math.round(Math.random()*1E9);for(var c=true;c==true;){c=false;for(h in notes)if(String(notes[h][3])==String(id)){id=Math.round(Math.random()*1E9);c=true}}d=d.appendChild(document.createElement("div"));d.className="respondControls";var h=
d.appendChild(document.createElement("div"));h.contentEditable=true;h.id="nmi";c=d.appendChild(document.createElement("input"));c.type="button";c.value="Save";c.id="noteSave";d=d.appendChild(document.createElement("input"));d.type="button";d.value="Cancel";d.id="noteCancel";$("#noteSave").click(function(){submitNewThread(id)});$("#noteCancel").click(function(){noteIndex()});h.focus()}
function submitNewThread(d){var c=document.getElementById("nmi").innerHTML,h=document.getElementById("user_email").innerHTML,m=new Date;if(c!=""){notes.push([pos.row,pos.col,[[c,h,m]],d]);resource_id!="Demo"&&$.post("/notesnewthread",{resource_id:resource_id,row:pos.row,col:pos.col,content:c,thread_id:d,fromPage:"editor"},function(o){o!="sent"&&alert("Sorry, there was a problem sending that message. Please try again later.")})}noteIndex()}
function newMessage(d){noteIndex();typeToScript=false;var c=document.getElementById(d),h=c.parentNode.insertBefore(document.createElement("div"),c);h.className="respondControls";var m=h.appendChild(document.createElement("div"));m.contentEditable=true;m.id="nmi";var o=h.appendChild(document.createElement("input"));o.type="button";o.value="Save";o.id="noteSave";h=h.appendChild(document.createElement("input"));h.type="button";h.value="Cancel";h.id="noteCancel";c.parentNode.removeChild(c);$("#noteSave").click(function(){submitMessage(d)});
$("#noteCancel").click(function(){noteIndex()});m.focus()}
function submitMessage(d){for(x in notes)if(notes[x][3]==d)var c=x;var h=new Date,m=document.getElementById("nmi").innerHTML,o=document.getElementById("user_email").innerHTML;if(m!=""){h=[m,o,h];notes[c][2].push(h);resource_id!="Demo"&&$.post("/notessubmitmessage",{resource_id:resource_id,content:m,thread_id:d,fromPage:"editor"},function(q){q!="sent"&&alert("Sorry, there was a problem sending that message. Please try again later.")});h=null}noteIndex();x=h=m=o=c=null}
function deleteThread(d){if(confirm("Are you sure you want to Delete this thread? This cannot be undone.")==true){resource_id!="Demo"&&$.post("/notesdeletethread",{resource_id:resource_id,thread_id:d});for(i in notes)if(notes[i][3]==d)var c=i;i=null;notes.splice(c,1);noteIndex()}}
function openMenu(d){document.getElementById(d).style.backgroundColor="#6484df";document.getElementById(d).style.color="white";document.getElementById(d+"Menu").style.display="block";d=document.getElementsByTagName("td");for(var c=0;c<d.length;c++)if(d[c].className=="formatTD")if(d[c].id=="check"+lines[pos.row][1]){d[c].innerHTML="";d[c].appendChild(document.createTextNode("\u2713"))}else d[c].innerHTML=""}
function topMenuOver(d){for(var c=false,h=document.getElementsByTagName("div"),m=0;m<h.length;m++){if(h[m].className=="menuItem"){h[m].style.backgroundColor="#A2BAE9";h[m].style.color="black"}if(h[m].className=="topMenu")if(h[m].style.display=="block"){h[m].style.display="none";c=true}}if(c)document.getElementById(d+"Menu").style.display="block";document.getElementById(d).style.backgroundColor="#6484df";document.getElementById(d).style.color="white";h=document.getElementsByTagName("td");for(m=0;m<
h.length;m++)if(h[m].className=="formatTD")if(h[m].id=="check"+lines[pos.row][1]){h[m].innerHTML="";h[m].appendChild(document.createTextNode("\u2713"))}else h[m].innerHTML=""}function topMenuOut(d){if(document.getElementById(d+"Menu").style.display=="none"){document.getElementById(d).style.backgroundColor="#A2BAE9";document.getElementById(d).style.color="black"}}
function closeScript(){var d=JSON.stringify(lines);$.post("/save",{data:d,resource_id:resource_id,autosave:0},function(){self.close()})}function newScriptPrompt(){if(resource_id=="Demo")alert("Sorry, you'll have to login to open new scripts.");else{typeToScript=false;document.getElementById("newscriptpopup").style.visibility="visible"}}
function hideNewScriptPrompt(){typeToScript=true;document.getElementById("newScript").value="";document.getElementById("newscriptpopup").style.visibility="hidden";document.getElementById("createScriptButton").disabled=false;document.getElementById("createScriptButton").value="Create";document.getElementById("createScriptIcon").style.visibility="hidden"}
function createScript(){var d=document.getElementById("newScript").value;if(d!=""){document.getElementById("createScriptButton").disabled=true;document.getElementById("createScriptButton").value="Creating Script...";document.getElementById("createScriptIcon").style.visibility="visible";$.post("/newscript",{filename:d,fromPage:"editor"},function(c){window.open("editor?resource_id="+c);hideNewScriptPrompt()})}}
function duplicate(){$.post("/duplicate",{resource_id:resource_id,fromPage:"editor"},function(d){d!="fail"&&window.open(d)})}
function save(d){clearTimeout(timer);if(resource_id=="Demo")d==0&&alert("Sorry, but you'll have to login to start saving scripts!");else{var c=JSON.stringify(lines);document.getElementById("saveButton").value="Saving...";$.post("/save",{data:c,resource_id:resource_id,autosave:d},function(){document.getElementById("saveButton").value="Saved";document.getElementById("saveButton").disabled=true});d=[];for(i in notes)d.push([notes[i][0],notes[i][1],notes[i][3]]);d.length!=0&&$.post("/notesposition",{resource_id:resource_id,
positions:JSON.stringify(d)},function(){});c=d=i=null}}function openPrompt(){window.open("/scriptlist")}function renamePrompt(){typeToScript=false;document.getElementById("renameTitle").innerHTML="Rename: "+document.getElementById("title").innerHTML;document.getElementById("renameField").value=document.getElementById("title").innerHTML;document.getElementById("renamepopup").style.visibility="visible"}
function hideRenamePrompt(){document.getElementById("renameField").value="";document.getElementById("renamepopup").style.visibility="hidden";typeToScript=true}function renameScript(){if(resource_id=="Demo")alert("Sorry, you'll have to login to do that.");else{var d=document.getElementById("renameField").value;if(d!=""){document.getElementById("title").innerHTML=d;document.title=d;$.post("/rename",{resource_id:resource_id,rename:d,fromPage:"scriptlist"});hideRenamePrompt()}}}
function exportPrompt(){resource_id!="Demo"&&document.getElementById("saveButton").value=="Save"&&save(0);typeToScript=false;document.getElementById("exportpopup").style.visibility="visible"}function hideExportPrompt(){typeToScript=true;document.getElementById("exportpopup").style.visibility="hidden"}
function exportScripts(){if(resource_id=="Demo")alert("Sorry, you'll have to login to export scripts.");else for(var d,c="&title_page="+document.getElementById("et").selectedIndex,h=document.getElementsByTagName("input"),m=0;m<h.length;m++)if(h[m].checked==true)if(h[m].className=="exportList"){d=h[m].name;b="/export?resource_id="+resource_id+"&export_format="+d+"&fromPage=editor"+c;window.open(b)}}
function emailPrompt(){if(resource_id=="Demo")alert("Sorry, you'll have to login to email scripts.");else{document.getElementById("saveButton").value=="Save"&&save(0);typeToScript=false;document.getElementById("emailpopup").style.visibility="visible"}}
function hideEmailPrompt(){document.getElementById("emailpopup").style.visibility="hidden";document.getElementById("recipient").value="";document.getElementById("recipients").innerHTML="";document.getElementById("message").innerHTML="";typeToScript=true}
function emailComplete(d){document.getElementById("emailS").disabled=false;document.getElementById("emailS").value="Send";if(d=="sent"){alert("Email Sent");hideEmailPrompt()}else alert("There was a problem sending your email. Please try again later.")}
function emailScript(){tokenize("recipient");for(var d=[],c=document.getElementsByTagName("span"),h=0;h<c.length;h++)c[h].className=="mailto"&&d.push(c[h].innerHTML);d=d.join(",");c=document.getElementById("subject").value;if(c=="")c="Script";h=document.getElementById("message").innerHTML;$.post("/emailscript",{resource_id:resource_id,recipients:d,subject:c,body_message:h,fromPage:"editor",title_page:document.getElementById("emailTitle").selectedIndex},function(m){emailComplete(m)});document.getElementById("emailS").disabled=
true;document.getElementById("emailS").value="Sending...";c=d=d=c=h=null}function sharePrompt(){typeToScript=false;document.getElementById("sharepopup").style.visibility="visible"}function hideSharePrompt(){typeToScript=true;document.getElementById("sharepopup").style.visibility="hidden";document.getElementById("collaborator").value=""}
function removeAccess(d){var c=confirm("Are you sure you want to remove access for this user?");if(c==true){c=document.getElementById(d);c.style.backgroundColor="#ccc";$.post("/removeaccess",{resource_id:resource_id,removePerson:d},function(h){document.getElementById(h).parentNode.removeChild(document.getElementById(h))})}c=null}
function shareScript(){tokenize("collaborator");for(var d=[],c=document.getElementsByTagName("span"),h=0;h<c.length;h++)c[h].className=="mailto"&&d.push(c[h].innerHTML);d=d.join(",");$.post("/share",{resource_id:resource_id,collaborators:d,fromPage:"scriptlist"},function(m){m=m.split(",");var o=document.getElementById("hasAccess");for(h in m)if(m[h]!=""&&m[h]!=="not sent"){var q=o.appendChild(document.createElement("tr"));q.id=m[h];q.appendChild(document.createElement("td")).appendChild(document.createTextNode(m[h]));
q=q.appendChild(document.createElement("td")).appendChild(document.createElement("a"));q.appendChild(document.createTextNode("Remove Access"));q.href="javascript:removeAccess('"+m[h]+"')"}document.getElementById("shareS").disabled=false;document.getElementById("shareS").value="Send Invitations"});document.getElementById("shareS").disabled=true;document.getElementById("shareS").value="Sending Invites...";document.getElementById("collaborators").innerHTML=""}
function tagPrompt(){save(0);var d=prompt("Leave a tag for this version:");d!=null&&d!=""&&$.post("/revisiontag",{resource_id:resource_id,version:"latest",tag:d},function(c){c!="tagged"&&alert("There was a problem tagging this script. Please try again later.")})}
function findPrompt(){hideFindReplacePrompt();document.getElementById("find_div").style.display=="block"&&findInputKeyUp({which:1E3},"f");typeToScript=false;findForcePaint=true;document.getElementById("find_div").style.display="block";document.getElementById("find_input").select();document.getElementById("find_input").focus()}function hideFindPrompt(){typeToScript=true;findForcePaint=false;findArr=[];document.getElementById("find_div").style.display="none";commandDownBool=false}
function findReplacePrompt(){hideFindPrompt();document.getElementById("find_replace_div").style.display=="block"&&findInputKeyUp({which:1E3},"r");typeToScript=false;findForcePaint=true;document.getElementById("find_replace_div").style.display="block";document.getElementById("fr_find_input").select();document.getElementById("fr_find_input").focus()}
function hideFindReplacePrompt(){typeToScript=true;findForcePaint=false;findReplaceArr=[];document.getElementById("find_replace_div").style.display="none";commandDownBool=false}
function replaceText(){var d=document.getElementById("fr_replace_input").value;if(d.length!=0)if(!(pos.row==anch.row&&pos.col==anch.col))if(pos.row==anch.row)if(findReplaceArr.length!=0){document.getElementById("ccp").value=d;paste();anch.col=pos.col-d.length;document.getElementById("find_replace_div").style.display=="block"&&findInputKeyUp({which:1E3},"r")}}function replaceAndFind(){replaceText();findDown()}
function launchSpellCheck(){typeToScript=false;ajaxSpell(pos.row);var d=pos.row==0?true:false;document.getElementById("spellcheckpopup").style.visibility="visible";spellCheckCycle(d,0,0)}
function spellCheckCycle(d,c,h){if(c=="finished"){alert("Spell Check Complete");hideSpellCheck()}else{d=lines[c][0].split(" ");for(var m=false;m==false;){var o=d[h].replace("?","").replace(".","").replace(",","").replace("(","").replace(")","");for(i in spellWrong)if(spellWrong[i][0].toUpperCase()==o.toUpperCase()){m=[c,h,i];for(v in spellIgnore)if(spellIgnore[v].toUpperCase()==o.toUpperCase())m=false}if(!m){h++;if(h==d.length){h=0;c++;if(c==lines.length)m="finished";else d=lines[c][0].split(" ")}}}if(m==
"finished"){document.getElementById("sSuggest").innerHTML="";document.getElementById("sSentance").innerHTML="";alert("Spell Check Complete");hideSpellCheck()}else{var q=lines[c][0],C=RegExp(o,"i");q=q.replace(C,"<span id='sFocus' title='"+o+"' style='color:red'>"+o+"</span>");if(lines[c][1]==0||lines[c][1]==2||lines[c][1]==5){document.getElementById("sSentance").innerHTML=q.toUpperCase();document.getElementById("sSentance").innerHTML=document.getElementById("sSentance").innerHTML.replace("SFOCUS",
"sFocus")}else document.getElementById("sSentance").innerHTML=q;document.getElementById("sSentance").title=c;o=spellWrong[m[2]][1];q=document.getElementById("sSuggest");q.innerHTML="";for(i in o){C=q.appendChild(document.createElement("div"));C.className="spellcheckitem";lines[c][1]==0||lines[c][1]==2||lines[c][1]==5?C.appendChild(document.createTextNode(o[i].toUpperCase())):C.appendChild(document.createTextNode(o[i]));C.title=o[i]}h++;if(h==d.length){h=0;c++;if(c==lines.length)m="finished";else d=
lines[c][0].split(" ")}c=m=="finished"?m:[c,h].join(",");document.getElementById("sHidden").value=c;$(".spellcheckitem").click(function(){var H=document.getElementById("spellcheckfocus");H!=undefined&&H.removeAttribute("id");this.id="spellcheckfocus";document.getElementById("sFocus").innerHTML=this.title})}}}function hideSpellCheck(){document.getElementById("spellcheckpopup").style.visibility="hidden";typeToScript=true;saveTimer()}
function s_ignore(){var d=document.getElementById("sHidden").value;spellCheckCycle(false,d.split(",")[0],d.split(",")[1])}function s_ignore_all(){spellIgnore.push(document.getElementById("sFocus").title);var d=document.getElementById("sHidden").value;spellCheckCycle(false,d.split(",")[0],d.split(",")[1])}
function s_change(){var d=document.getElementById("sSentance"),c=d.title;lines[c][0]="";for(i in d.childNodes)if(d.childNodes[i].nodeName=="#text")lines[c][0]+=d.childNodes[i].nodeValue;else{var h=d.childNodes[i].childNodes;for(j in h)if(h[j].nodeName=="#text")lines[c][0]+=h[j].nodeValue}d=document.getElementById("sHidden").value;spellCheckCycle(false,d.split(",")[0],d.split(",")[1]);paint(true,false,false)}
function scrollArrows(d){var c=document.getElementById("canvas").height;d.fillStyle="#333";d.fillRect(editorWidth-21,c-39,21,20);d.fillStyle="#ddd";d.fillRect(editorWidth-19,c-37,16,16);d.beginPath();d.moveTo(editorWidth-16,c-24);d.lineTo(editorWidth-10.5,c-35);d.lineTo(editorWidth-5,c-24);d.closePath();d.fillStyle="#333";d.fill();d.fillStyle="#333";d.fillRect(editorWidth-21,c-19,20,20);d.fillStyle="#ddd";d.fillRect(editorWidth-19,c-18,16,16);d.beginPath();d.moveTo(editorWidth-16,c-15);d.lineTo(editorWidth-
10.5,c-4);d.lineTo(editorWidth-5,c-15);d.closePath();d.fillStyle="#333";d.fill()}
function scrollBar(d){var c=d.createLinearGradient(editorWidth-15,0,editorWidth,0);c.addColorStop(0,"#5587c4");c.addColorStop(0.8,"#95a7d4");d.strokeStyle="#333";d.fillStyle=c;var h=document.getElementById("canvas").height,m=(pageBreaks.length+1)*72*lineheight+40;c=h/m*(h-39);if(c<20)c=20;if(c>=h-39)c=h-39;h=vOffset/(m-h)*(h-39-c);d.fillRect(editorWidth-18.5,h+8,16,c-17);d.strokeRect(editorWidth-18.5,h+8,16,c-17);d.beginPath();d.arc(editorWidth-10.5,h+9,8,0,Math.PI,true);d.fill();d.stroke();d.beginPath();
d.arc(editorWidth-10.5,h+c-11,8,0,Math.PI,false);d.fill();d.stroke();for(m=h;m<h+c;){var o=d.createRadialGradient(editorWidth,m+10,4,editorWidth+200,m,10);o.addColorStop(0,"rgba(100,140,210,0.4)");o.addColorStop(0.4,"rgba(180,160,240,0.4)");o.addColorStop(1,"rgba(1,159,98,0)");d.fillStyle=o;d.fillRect(editorWidth-18.5,h+8,16,c-17);m+=20}d.beginPath();d.moveTo(editorWidth-7,h+9);d.lineTo(editorWidth-7,h+c-10);d.lineCap="round";d.strokeStyle="rgba(200,220,255,0.3)";d.lineWidth=4;d.stroke();d.beginPath();
d.moveTo(editorWidth-9,h+10);d.lineTo(editorWidth-9,h+c-10);d.strokeStyle="rgba(200,220,255,0.1)";d.lineWidth=2;d.stroke()}
function drawFindArr(d,c){d.fillStyle="yellow";var h=findArr.length==0?document.getElementById("fr_find_input").value.length:document.getElementById("find_input").value.length,m=0,o=0,q=0,C=findArr.length==0?findReplaceArr:findArr,H=lineheight*9+3;for(i in linesNLB){if(H-vOffset>1200)break;m=0;for(j in linesNLB[i]){if(pageBreaks[q]!=undefined&&pageBreaks[q][0]==i&&pageBreaks[q][2]==j){q++;H=72*lineheight*q+9*lineheight+4;if(lines[i]!=undefined&&lines[i][1]==3)H+=lineheight}for(H+=lineheight;C[o]!=
undefined&&C[o][0]==i&&C[o][1]>=m&&C[o][1]<m+linesNLB[i][j]+1;){if(H-vOffset>-100){var Q=c+WrapVariableArray[lines[i][1]][1]+(C[o][1]-m)*fontWidth;if(C[o][1]+h>m+linesNLB[i][j]+1){d.fillRect(Q,H-vOffset,(m+linesNLB[i][j]-C[o][1])*fontWidth,lineheight-2);d.fillRect(c+WrapVariableArray[lines[i][1]][1],H+lineheight-vOffset,(h-(m+linesNLB[i][j]-C[o][1]+1))*fontWidth,lineheight-2)}else d.fillRect(Q,H-vOffset,h*fontWidth,lineheight-2)}o++}m+=linesNLB[i][j]+1}}}
function drawRange(d,c){if(pos.row>anch.row)var h={row:anch.row,col:anch.col},m={row:pos.row,col:pos.col};else if(pos.row==anch.row&&pos.col>anch.col){h={row:anch.row,col:anch.col};m={row:pos.row,col:pos.col}}else{h={row:pos.row,col:pos.col};m={row:anch.row,col:anch.col}}for(var o=lineheight*9+3,q=0,C=0;C<h.row;C++)if(pageBreaks.length!=0&&pageBreaks[q][2]==0&&pageBreaks[q][0]-1==C){o=72*lineheight*(q+1)+9*lineheight+4;q++;q==pageBreaks.length&&q--}else if(pageBreaks.length!=0&&pageBreaks[q][2]!=
0&&pageBreaks[q][0]==C){o=72*lineheight*(q+1)+9*lineheight+4;o+=(linesNLB[C].length-pageBreaks[q][2])*lineheight;if(lines[C][1]==3)o+=lineheight;q++;q==pageBreaks.length&&q--}else o+=lineheight*linesNLB[C].length;C=0;for(var H=linesNLB[h.row][C]+1;h.col>H;){o+=lineheight;if(pageBreaks.length!=0&&pageBreaks[q][0]==h.row&&pageBreaks[q][2]==C+1){o=72*lineheight*(q+1)+9*lineheight+4;if(lines[h.row][1]==3)o+=lineheight}C++;H+=linesNLB[h.row][C]+1}H-=linesNLB[h.row][C]+1;var Q=WrapVariableArray[lines[h.row][1]][1];
Q+=(h.col-H)*fontWidth;o+=lineheight;for(note in notes)if(notes[note][0]==h.row)if(H<notes[note][1]&&H+linesNLB[h.row][C]+1>notes[note][1])if(notes[note][1]<h.col)Q+=fontWidth;var K=lineheight*9+3;for(var O=q=0;O<m.row;O++)if(pageBreaks.length!=0&&pageBreaks[q][2]==0&&pageBreaks[q][0]-1==O){K=72*lineheight*(q+1)+9*lineheight+4;q++;q==pageBreaks.length&&q--}else if(pageBreaks.length!=0&&pageBreaks[q][2]!=0&&pageBreaks[q][0]==O){K=72*lineheight*(q+1)+9*lineheight+4;K+=(linesNLB[O].length-pageBreaks[q][2])*
lineheight;if(lines[O][1]==3)K+=lineheight;q++;q==pageBreaks.length&&q--}else K+=lineheight*linesNLB[O].length;O=0;for(var S=linesNLB[m.row][O]+1;m.col>S;){K+=lineheight;if(pageBreaks.length!=0&&pageBreaks[q][0]==m.row&&pageBreaks[q][2]==O+1){K=72*lineheight*(q+1)+9*lineheight+4;if(lines[m.row][1]==3)K+=lineheight}O++;S+=linesNLB[m.row][O]+1}S-=linesNLB[m.row][O]+1;q=WrapVariableArray[lines[m.row][1]][1];q+=(m.col-S)*fontWidth;K+=lineheight;for(note in notes)if(notes[note][0]==m.row)if(S<notes[note][1]&&
S+linesNLB[m.row][O]+1>notes[note][1])if(notes[note][1]<m.col)q+=fontWidth;d.fillStyle="lightBlue";if(K==o){m=Q;if(lines[h.row][1]==5)m-=lines[h.row][0].length*fontWidth;d.fillRect(m+c,o-vOffset,q-Q,12)}else{Q=Q;if(lines[h.row][1]==5)Q-=lines[h.row][0].length*fontWidth;for(d.fillRect(Q+c,o-vOffset,(H+linesNLB[h.row][C]-h.col)*fontWidth,12);o+lineheight<K;){for(H=0;H<pageBreaks.length;H++)if(pageBreaks.length!=0&&pageBreaks[H][0]-1==h.row&&pageBreaks[H][2]==0&&C==linesNLB[h.row].length-1)o=72*lineheight*
(H+1)+9*lineheight+4;else if(pageBreaks.length!=0&&pageBreaks[H][0]==h.row&&C==pageBreaks[H][2]-1){o=72*lineheight*(H+1)+9*lineheight+4;if(lines[h.row][1]==3)o+=lineheight}C++;o+=lineheight;if(linesNLB[h.row].length<=C){h.row++;C=0}if(o!=K){H=WrapVariableArray[lines[h.row][1]][1];if(lines[h.row][1]==5)H-=lines[h.row][0].length*fontWidth;d.fillRect(H+c,o-vOffset,linesNLB[h.row][C]*fontWidth,12)}}h=WrapVariableArray[lines[m.row][1]][1];if(lines[m.row][1]==5)h-=lines[m.row][0].length*fontWidth;d.fillRect(h+
c,K-vOffset,(m.col-S)*fontWidth,12)}}
function drawNote(d,c,h,m,o,q){if(lines[o][1]==5){m.fillStyle="gold";m.beginPath();m.moveTo(d-fontWidth*(lines[o][0].length-h+1)+q,c-vOffset-lineheight+3);m.lineTo(d-fontWidth*(lines[o][0].length-h+1)+q,c-vOffset-lineheight+3+lineheight);m.lineTo(d-fontWidth*(lines[o][0].length-h+1)+fontWidth+q,c-vOffset-lineheight+3+lineheight);m.lineTo(d-fontWidth*(lines[o][0].length-h+1)+fontWidth+q,c-vOffset-lineheight+3+4);m.lineTo(d-fontWidth*(lines[o][0].length-h+1)+fontWidth-4+q,c-vOffset-lineheight+3);m.closePath();
m.fill();m.strokeStyle="#333";m.lineWidth=1;m.beginPath();for(var C=1;C<6;C++){m.moveTo(d-fontWidth*(lines[o][0].length-h+1)+1+q,c-vOffset-lineheight+3+2*C+0.5);m.lineTo(d-fontWidth*(lines[o][0].length-h+1)+fontWidth-1+q,c-vOffset-lineheight+3+2*C+0.5);m.stroke()}m.strokeStyle="#999";m.beginPath();m.moveTo(d-fontWidth*(lines[o][0].length-h+1)+fontWidth-4+q,c-vOffset-lineheight+3);m.lineTo(d-fontWidth*(lines[o][0].length-h+1)+fontWidth-4+q,c-vOffset-lineheight+3+4);m.lineTo(d-fontWidth*(lines[o][0].length-
h+1)+fontWidth+q,c-vOffset-lineheight+3+4)}else{m.fillStyle="gold";m.beginPath();m.moveTo(d+fontWidth*h+q,c-vOffset-lineheight+3);m.lineTo(d+fontWidth*h+q,c-vOffset-lineheight+3+lineheight);m.lineTo(d+fontWidth*h+fontWidth+q,c-vOffset-lineheight+3+lineheight);m.lineTo(d+fontWidth*h+fontWidth+q,c-vOffset-lineheight+3+4);m.lineTo(d+fontWidth*h+fontWidth-4+q,c-vOffset-lineheight+3);m.closePath();m.fill();m.strokeStyle="#333";m.lineWidth=1;m.beginPath();for(o=1;o<6;o++){m.moveTo(d+fontWidth*h+1+q,c-vOffset-
lineheight+3+2*o+0.5);m.lineTo(d+fontWidth*h+fontWidth-1+q,c-vOffset-lineheight+3+2*o+0.5);m.stroke()}m.strokeStyle="#999";m.beginPath();m.moveTo(d+fontWidth*h+fontWidth-4+q,c-vOffset-lineheight+3);m.lineTo(d+fontWidth*h+fontWidth-4+q,c-vOffset-lineheight+3+4);m.lineTo(d+fontWidth*h+fontWidth+q,c-vOffset-lineheight+3+4)}m.stroke();m.fillStyle=foreground}function sortNumbers(d,c){return d-c}
function paint(d,c){if(typeToScript||findForcePaint){(new Date).getTime();var h=document.getElementById("canvas").getContext("2d");h.clearRect(0,0,2E3,2500);h.fillStyle="#ccc";h.fillRect(0,0,editorWidth,document.getElementById("canvas").height);h.fillStyle=foreground;var m=Math.round((editorWidth-fontWidth*87-24)/2),o=lineheight;h.font=font;h.lineWidth=1;for(var q=0;q<=pageBreaks.length;q++){if(o-vOffset>1200)break;if(o-vOffset>-lineheight*72){h.fillStyle=background;h.fillRect(m,o-vOffset,fontWidth*
87,lineheight*70);h.strokeStyle="#000";h.strokeRect(m,o-vOffset,Math.round(fontWidth*87),lineheight*70);h.strokeStyle="#999";h.strokeRect(m-2,o-vOffset-2,Math.round(fontWidth*87)+4,lineheight*70+4);h.fillStyle=foreground;q>0&&h.fillText(String(q+1)+".",550+m,o-vOffset+85)}o+=lineheight*72}if(!d){o=lineheight*9+2;var C=WrapVariableArray[0];h.fillStyle="#ddd";var H=0;for(q=0;q<lines.length;q++){if(pageBreaks.length!=0&&pageBreaks[H][0]==q){o=72*lineheight*(H+1)+9*lineheight+2;if(pageBreaks[H][2]!=0){o-=
pageBreaks[H][2]*lineheight;if(lines[q][1]==3)o+=lineheight}H++;H==pageBreaks.length&&H--}if(q<linesNLB.length)for(var Q=0;Q<linesNLB[q].length;Q++){o+=lineheight;if(lines[q][1]==0){linesNLB[q][Q]!=0&&h.fillRect(C[1]-3+m,o-vOffset,61*fontWidth+6,14);lines[q][0]==""&&Q==0&&h.fillRect(C[1]-3+m,o-vOffset,61*fontWidth+6,14)}}if(o-vOffset>1200)break}C=null}if(findArr.length!=0||findReplaceArr.length!=0)drawFindArr(h,m);if(pos.row!=anch.row||anch.col!=pos.col){drawRange(h,m);pasting||selection()}h.fillStyle=
foreground;h.font=font;o=lineheight*11;var K=[],O="";H=0;Q=false;var S=0;for(q=0;q<lines.length;q++){lines[q][1]==0&&S++;if(lines[q][1]==4){if(lines[q][0].charAt(0)!="(")lines[q][0]="("+lines[q][0];if(lines[q][0].charAt(lines[q][0].length-1)!=")")lines[q][0]+=")"}var W=false;if(!d)if(pageBreaks.length!=0&&pageBreaks[H]!=undefined&&pageBreaks[H][0]==q)if(pageBreaks[H][2]==0){o=72*lineheight*(H+1)+11*lineheight;H++;if(H>=pageBreaks.length){Q||(Q=H+1);H=pageBreaks.length-2}}else W=true;if(!d&&!W&&o-
vOffset<-200){o+=lineheight*linesNLB[q].length;if(q==pos.row){var U=o;F=[]}}else if(!d&&!W&&o-vOffset>1200)break;else{var P=[];if(viewNotes)for(note in notes)notes[note][0]==q&&P.push(notes[note][1]);P=P.sort(sortNumbers);var f=lines[q][1];if(q==pos.row){U=o-lineheight;if(f==1)var Y=WrapVariableArray[1][1];else if(f==0)Y=WrapVariableArray[0][1];else if(f==3)Y=WrapVariableArray[3][1];else if(f==2)Y=WrapVariableArray[2][1];else if(f==4)Y=WrapVariableArray[4][1];else if(f==5)Y=WrapVariableArray[5][1];
var N=true,F=[]}if(q==anch.row)var ia=true,qa=[];var ca=lines[q][0];if(f==0)C=WrapVariableArray[0];else if(f==1)C=WrapVariableArray[1];else if(f==2)C=WrapVariableArray[2];else if(f==3)C=WrapVariableArray[3];else if(f==4)C=WrapVariableArray[4];else if(f==5)C=WrapVariableArray[5];f=ca.split(" ");ca=0;linesNLB[q]=[];for(var ea=0;ca<f.length;){var X=0;if(f[ca].length>=C[0]){X=f[ca];if(C[3]==1)X=X.toUpperCase();var da=X,aa=[];if(viewNotes)for(note in P)if(P[note]>=lines[q][0].length-X.length){da=da.substr(0,
P[note]-ea+aa.length)+" "+da.substr(P[note]-ea+aa.length);drawNote(C[1],o,P[note]-ea+aa.length,h,q,m);aa.push(P[note])}h.fillText(da,C[1]+m,o-vOffset);linesNLB[q].push(X.length);o+=lineheight;if(C[4]==2){linesNLB[q].push(0);o+=lineheight}ca++;N&&F.push(X.length);ia&&qa.push(X.length)}else if(f.slice(ca).join().length<C[0]){X=f.slice(ca).join(" ");if(lines[q][1]==2&&O!=""&&lines[q][0].toUpperCase()==O.toUpperCase())X+=" (Cont'd)";if(lines[q][1]==0)O="";if(C[3]==1)X=X.toUpperCase();if(C[2]==1)h.textAlign=
"right";da=X;aa=[];if(viewNotes)for(note in P)if(P[note]>=lines[q][0].length-X.length){da=da.substr(0,P[note]-ea+aa.length)+" "+da.substr(P[note]-ea+aa.length);drawNote(C[1],o,P[note]-ea+aa.length,h,q,m);aa.push(P[note])}X!=""&&h.fillText(da,C[1]+m,o-vOffset);h.textAlign="left";ca=f.length;linesNLB[q].push(X.length);o+=lineheight;if(C[4]==2){linesNLB[q].push(0);o+=lineheight}N&&F.push(X.length);ia&&qa.push(X.length)}else{for(X=0;f.slice(ca,ca+X).join(" ").length<C[0];){newLineToPrint=f.slice(ca,ca+
X).join(" ");X++}if(C[3]==1)newLineToPrint=newLineToPrint.toUpperCase();da=newLineToPrint;aa=[];if(viewNotes)for(note in P)if(P[note]>=ea&&P[note]<=ea+newLineToPrint.length){da=da.substr(0,P[note]-ea+aa.length)+" "+da.substr(P[note]-ea+aa.length);drawNote(C[1],o,P[note]-ea+aa.length,h,q,m);aa.push(P[note])}ea+=newLineToPrint.length+1;h.fillText(da,C[1]+m,o-vOffset);linesNLB[q].push(newLineToPrint.length);o+=lineheight;ca+=X-1;N&&F.push(newLineToPrint.length);ia&&qa.push(newLineToPrint.length)}if(lines[q][1]==
3&&q+1!=lines.length&&lines[q+1][1]==4&&linesNLB[q][linesNLB[q].length-1]==0){linesNLB[q].pop();o-=lineheight}if(W&&linesNLB[q].length==pageBreaks[H][2]){lines[q][1]==3&&h.fillText("(MORE)",WrapVariableArray[2][1]+m,o-vOffset);o=72*lineheight*(H+1)+11*lineheight;if(lines[q][1]==3){h.fillText(O.toUpperCase()+" (CONT'D)",WrapVariableArray[2][1]+m,o-vOffset);o+=lineheight}H++;W=false;pos.row==q&&K.push(H)}}ia=N=false}if(lines[q][1]==2)O=lines[q][0];if(q==pos.row&&Q==false)Q=H+1;if(q==pos.row)var ta=
S,ja=P;if(H>=pageBreaks.length){if(Q==false)Q=H+1;H=pageBreaks.length-2}}for(;lines.length<linesNLB.length;)linesNLB.pop();C=(new Date).getMilliseconds()-milli;q=false;if(C>0&&C<500)q=true;if(C<0&&C<-500)q=true;if(F){var ba=0;for(C=F[ba];pos.col>C;){ba++;C+=1+F[ba]}C-=F[ba];P=0;for(note in ja){N=ja[note];N<pos.col&&N>C&&N<C+F[ba]&&P++}note=null;if(K.length>0&&ba>=pageBreaks[K[0]-1][2]){Q+=1;U=72*K[0]*lineheight+9*lineheight;if(lines[pos.row][1]==3){U+=lineheight*2;ba-=pageBreaks[K[0]-1][2]}else if(lines[pos.row][1]==
1){ba-=pageBreaks[K[0]-1][2];U+=lineheight}}if(q){m=Y+(pos.col-C+P)*fontWidth+m;if(lines[pos.row][1]==5)m-=lines[pos.row][0].length*fontWidth;ud=2+U+ba*lineheight-vOffset;try{h.fillRect(m,ud,2,17)}catch(ua){}}ba=null}h.lineWidth=4;h.strokeStyle="#ddd";h.beginPath();h.moveTo(2,2);h.lineTo(2,document.getElementById("canvas").height-1);h.lineTo(editorWidth,document.getElementById("canvas").height-1);h.lineTo(editorWidth,2);h.stroke();h.fillStyle="#ccc";h.fillRect(2,document.getElementById("canvas").height-
24,editorWidth-25,24);h.strokeStyle="#aaa";h.lineWidth=1;h.beginPath();h.moveTo(1.5,document.getElementById("canvas").height-25.5);h.lineTo(1.5,document.getElementById("canvas").height-1.5);h.lineTo(editorWidth-23.5,document.getElementById("canvas").height-1.5);h.lineTo(editorWidth-23.5,document.getElementById("canvas").height-25.5);h.closePath();h.strokeStyle="#999";h.stroke();h.beginPath();h.moveTo(0.5,document.getElementById("canvas").height-24.5);h.lineTo(0.5,document.getElementById("canvas").height-
0.5);h.lineTo(editorWidth-22.5,document.getElementById("canvas").height-0.5);h.lineTo(editorWidth-22.5,document.getElementById("canvas").height-24.5);h.closePath();h.strokeStyle="#333";h.stroke();m="Page "+Q+" of "+(pageBreaks.length+1);h.font="10pt sans-serif";h.fillStyle="#000";h.fillText(m,editorWidth-150,document.getElementById("canvas").height-8);h.fillText(["Enter : Action  --  Tab : Character","Enter : Character  --  Tab : Slugline","Enter : Dialog  --  Tab : Action","Enter : Character  --  Tab : Parenthetical",
"Enter : Dialog  --  Tab : Dialog","Enter : Slugline  --  Tab : Slugline"][lines[pos.row][1]],15,document.getElementById("canvas").height-8);h.fillText("Scene "+ta+" of "+scenes.length,editorWidth/2-30,document.getElementById("canvas").height-8);h.font=font;scrollArrows(h);scrollBar(h,o);d&&pagination();mouseDownBool&&pos.row<anch.row&&mouseY<40&&scroll(-20);mouseDownBool&&pos.row>anch.row&&mouseY>document.getElementById("canvas").height-50&&scroll(20);if(c=="enter")ud>document.getElementById("canvas").height&&
scroll(600);else if(c)if(2+U+ba*lineheight-vOffset>document.getElementById("canvas").height-60)scroll(45);else ud<45&&scroll(-45);document.getElementById("format").selectedIndex=lines[pos.row][1]}};function tokenize(d){for(var c=0,h=document.getElementsByTagName("div"),m=0;m<h.length;m++)h[m].className=="token"&&c++;if(c>4)alert("You can only have 5 recipients at a time for now. Only the first five will be sent.");else{c=document.getElementById(d);h=c.value.replace(",","");if(h.replace(/ /g,"")!=""){var o=h.split(" ");h=o.pop();m="";m=o.length==0?h:o.join(" ").replace(/"/g,"");o=document.createElement("div");d=document.getElementById(d+"s").appendChild(o);d.className="token";d.id=h;o=document.createElement("span");
o=d.appendChild(o);m=document.createTextNode(m);o.appendChild(m);o=document.createElement("span");m=d.appendChild(o);o=document.createTextNode(h);m.className="mailto";m.appendChild(o);m=document.createElement("a");d=d.appendChild(m);m=document.createTextNode(" | X");d.appendChild(m);d.setAttribute("href",'javascript:removeToken("'+h+'")');c.value=""}}}function removeToken(d){d=document.getElementById(d);d.parentNode.removeChild(d)};
