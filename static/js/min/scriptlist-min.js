function uploadWindow(a){if(a.data=="uploading"){document.getElementById("uploadFrame").height="0px";document.getElementById("uploadFrame").width="0px";document.getElementById("uploading").style.display="block"}else{document.getElementById("uploadFrame").style.height="210px";document.getElementById("uploadFrame").style.width="250px";document.getElementById("uploading").style.display="none";window.open("editor?resource_id="+a.data);refreshList()}}window.oncontextmenu=contextmenu;window.onclick=click;function click(){$(".context_unit").unbind();if(document.getElementById("context_menu")!=null){document.getElementById("context_menu").parentNode.removeChild(document.getElementById("context_menu"))}}function contextmenu(b){$(".context_unit").unbind();if(document.getElementById("context_menu")!=null){document.getElementById("context_menu").parentNode.removeChild(document.getElementById("context_menu"))}if(b.target.className=="tab"||b.target.className=="tab current"){if(b.target.id!="ownedFolder"&&b.target.id!="sharedFolder"&&b.target.id!="trashFolder"){b.preventDefault();var a=document.body.appendChild(document.createElement("div"));a.style.position="fixed";a.style.top=b.clientY+"px";a.style.left=b.clientX+5+"px";a.value=b.target.id;a.title=$("#"+b.target.id).text().substr(1);a.id="context_menu";var c=a.appendChild(document.createElement("div"));c.appendChild(document.createTextNode("Rename"));c.className="context_unit";c.addEventListener("click",renameFolder,false);c=a.appendChild(document.createElement("div"));c.appendChild(document.createTextNode("Delete"));c.className="context_unit";c.addEventListener("click",deleteFolder,false);$(".context_unit").mouseover(function(){$(this).css("background-color","#6490E6")});$(".context_unit").mouseout(function(){$(this).css("background-color","#fff")})}}}function tabs(a){var d=document.getElementsByTagName("input");for(var b=0;b<d.length;b++){if(d[b].type=="checkbox"){d[b].checked=false}}var d=document.getElementsByTagName("div");for(b in d){if(d[b].className=="folderContents"){d[b].style.display="none"}if(d[b].className=="buttons_block"){d[b].style.display="none"}}document.getElementById(a.replace("Folder","")).style.display="block";if(a!="ownedFolder"&&a!="sharedFolder"&&a!="trashFolder"){a="owned_buttons"}document.getElementById(a.replace("Folder","_buttons")).style.display="block"}function newFolder(){var j=prompt("New Folder Name");j=j.replace(/^\s+/,"").replace(/\s+$/,"");if(j!=null&&j!=""){var c=Math.round(Math.random()*10000000000);$.post("/newfolder",{folder_name:j,folder_id:c});var k=document.getElementById("user_folders").appendChild(document.createElement("div"));k.className="tab";k.id="Folder"+c;k.appendChild(document.createElement("img")).src="images/folder.png";k.appendChild(document.createTextNode(" "+j));var b=document.getElementById("contents").appendChild(document.createElement("div"));b.id=c;b.className="folderContents";b.style.display="none";var a=b.appendChild(document.createElement("div"));a.className="contentsHeader";var l=a.appendChild(document.createElement("table"));l.width="100%";tr=l.appendChild(document.createElement("tr"));var e=tr.appendChild(document.createElement("td"));e.style.width="15px";var g=e.appendChild(document.createElement("input"));g.type="checkbox";g.style.visibility="hidden";tr.appendChild(document.createElement("td")).appendChild(document.createTextNode(j));e=tr.appendChild(document.createElement("td"));e.style.width="120px";e.align="center";e.appendChild(document.createTextNode("Shared With"));e=tr.appendChild(document.createElement("td"));e.style.width="120px";e.align="center";e.appendChild(document.createTextNode("Email"));e=tr.appendChild(document.createElement("td"));e.style.width="160px";e.align="center";var h=document.getElementById("move_to_folder").appendChild(document.createElement("option"));h.appendChild(document.createTextNode(j));h.value=c;e.appendChild(document.createTextNode("Last Modified"));$(".tab").unbind();$(".tab").click(function(d){$(".current").removeClass("current").css("background-color","white");$(this).addClass("current");tabs(d.target.id);$(this).css("background-color","#2352AE")});$(".tab").mouseover(function(){if(!$(this).hasClass("current")){$(this).css("background-color","#ccf")}else{$(this).css("background-color","#2352AE")}});$(".tab").mouseout(function(){if(!$(this).hasClass("current")){$(this).css("background-color","#fff")}})}}function moveToFolder(b){if(b!="move_to"){var g=document.getElementsByTagName("input");var d=false;var a=[];for(i in g){if(g[i].type=="checkbox"&&g[i].checked==true&&g[i].parentNode.className=="checkboxCell"){var f=g[i];while(f.nodeName!="DIV"){f=f.parentNode}f.style.backgroundColor="#ccc";f.style.opacity="0.5";d=true;a.push(g[i].value)}}if(d==true){$.post("/changefolder",{resource_id:a.join(","),folder_id:b},function(){refreshList()})}document.getElementById("move_to_folder").selectedIndex=0}}function refreshList(a){document.getElementById("refresh_icon").style.visibility="visible";$.post("/list",function(aa){var V=JSON.parse(aa);var N=V[0];var M=V[1];var p=V[2];var Z=V[3];var t=$(".current").get(0).id;$(".folderContents").each(function(){if(this.id!="owned"&&this.id!="shared"&&this.id!="trash"){this.parentNode.removeChild(this)}});var ab=document.getElementById("user_folders");ab.innerHTML="";var Q=document.getElementById("move_to_folder");Q.innerHTML="<option value='move_to'>Move To Folder...</option><option value='?none?'>Remove From Folder</option>";for(X in Z){var Y=ab.appendChild(document.createElement("div"));Y.className="tab";Y.id="Folder"+Z[X][1];Y.appendChild(document.createElement("img")).src="images/folder.png";Y.appendChild(document.createTextNode(" "+Z[X][0]));var L=Q.appendChild(document.createElement("option"));L.appendChild(document.createTextNode(Z[X][0]));L.value=Z[X][1];var P=document.getElementById("contents").appendChild(document.createElement("div"));P.id=Z[X][1];P.className="folderContents";P.style.display="none";var E=P.appendChild(document.createElement("div"));E.className="contentsHeader";var s=E.appendChild(document.createElement("table"));s.width="100%";tr=s.appendChild(document.createElement("tr"));var h=tr.appendChild(document.createElement("td"));h.style.width="15px";var J=h.appendChild(document.createElement("input"));J.type="checkbox";J.style.visibility="hidden";var S=tr.appendChild(document.createElement("td"));S.appendChild(document.createTextNode(Z[X][0]));h=tr.appendChild(document.createElement("td"));h.style.width="120px";h.align="center";h.appendChild(document.createTextNode("Shared With"));h=tr.appendChild(document.createElement("td"));h.style.width="120px";h.align="center";h.appendChild(document.createTextNode("Email"));h=tr.appendChild(document.createElement("td"));h.style.width="160px";h.align="center";h.appendChild(document.createTextNode("Last Modified"))}$(".tab").click(function(d){$(".current").removeClass("current").css("background-color","white");$(this).addClass("current");tabs(d.target.id);$(this).css("background-color","#2352AE")});$(".tab").mouseover(function(){if(!$(this).hasClass("current")){$(this).css("background-color","#ccf")}else{$(this).css("background-color","#2352AE")}});$(".tab").mouseout(function(){if(!$(this).hasClass("current")){$(this).css("background-color","#fff")}});document.getElementById("loading").style.display="none";var r=document.getElementById("content").childNodes;for(var X=0;X<r.length;X++){r[X].parentNode.removeChild(r[X]);X--}var o=document.getElementById("content").appendChild(document.createElement("div"));o.id="list";document.getElementById("noentries").style.display=(N.length==0?"block":"none");for(var X=0;X<N.length;X++){var G=N[X][1];var H=N[X][0];var g=N[X][2];var K=N[X][4];var ac=N[X][5];var U=N[X][6];var l=o.appendChild(document.createElement("div"));l.id=H;l.className="entry";var R=l.appendChild(document.createElement("table"));R.width="100%";var A=R.appendChild(document.createElement("tr"));var I=A.appendChild(document.createElement("td"));I.className="checkboxCell";var c=I.appendChild(document.createElement("input"));c.type="checkbox";c.name="listItems";c.value=H;var B=A.appendChild(document.createElement("td"));var e=B.appendChild(document.createElement("a"));e.id="name"+H;if(ac!=0){var m=B.appendChild(document.createElement("span"));m.appendChild(document.createTextNode((ac==1?" New Note":" "+ac+" New Notes")));m.className="redAlertSpan"}var y='javascript:script("'+H+'")';e.href=y;e.appendChild(document.createTextNode(G));var w=A.appendChild(document.createElement("td"));w.align="center";w.className="folderCell";if(U!="?none?"){for(fold in Z){if(Z[fold][1]==U){var u=w.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(Z[fold][0]));u.className="folderSpan"}}}var C=A.appendChild(document.createElement("td"));C.className="sharedCell";C.align="right";if(K.length==0){var W=""}else{if(K.length==1){var W="1 person "}else{var W=String(K.length)+" people "}}C.appendChild(document.createTextNode(W));var ad=C.appendChild(document.createElement("a"));var y="javascript:sharePrompt('"+H+"')";ad.href=y;ad.appendChild(document.createTextNode("Manage"));ad.id="share"+H;ad.title=K.join("&");var k=A.appendChild(document.createElement("td"));k.className="emailCell";k.align="center";var v=k.appendChild(document.createElement("a"));v.className="emailLink";y='javascript:emailPrompt("'+H+'")';v.href=y;v.appendChild(document.createTextNode("Email"));var F=A.appendChild(document.createElement("td"));F.className="updatedCell";F.align="center";F.appendChild(document.createTextNode(g));if(U!="?none?"){var b=l.cloneNode(true);var b=document.getElementById(U).appendChild(b);b.getElementsByTagName("input")[0].name="listItems"+U}}var r=document.getElementById("sharedContent").childNodes;for(var X=0;X<r.length;X++){r[X].parentNode.removeChild(r[X]);X--}document.getElementById("sharedLoading").style.display="none";document.getElementById("sharedNoEntries").style.display=(p.length==0?"block":"none");var o=document.getElementById("sharedContent").appendChild(document.createElement("div"));o.id="sharedList";var T=0;for(X in p){var H=p[X][0];var G=p[X][1];var g=p[X][2];var D=p[X][3];var ac=p[X][4];var O=p[X][6];console.log(O);var l=o.appendChild(document.createElement("div"));l.id=H;l.className="entry";var R=l.appendChild(document.createElement("table"));R.width="100%";var A=R.appendChild(document.createElement("tr"));var I=A.appendChild(document.createElement("td"));I.className="checkboxCell";var c=I.appendChild(document.createElement("input"));c.type="checkbox";c.name="sharedListItems";c.value=H;var B=A.appendChild(document.createElement("td"));var e=B.appendChild(document.createElement("a"));e.id="name"+H;var y='javascript:script("'+H+'")';e.href=y;e.appendChild(document.createTextNode(G));if(O=="True"){var m=B.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(" New Script"));m.className="redAlertSpan";T++}else{if(ac!=0){var m=B.appendChild(document.createElement("span"));m.appendChild(document.createTextNode((ac==1?" New Note  ":" "+ac+" New Notes  ")));m.className="redAlertSpan"}}var q=A.appendChild(document.createElement("td"));q.appendChild(document.createTextNode(D));q.align="right";q.className="ownerCell";var F=A.appendChild(document.createElement("td"));F.className="updatedCell";F.align="center";F.appendChild(document.createTextNode(g))}document.getElementById("sharedFolder").innerHTML="Shared With Me"+(T==0?"":" ("+T+")");document.getElementById("trashLoading").style.display="none";document.getElementById("trashNoEntries").style.display=(M.length==0?"block":"none");var r=document.getElementById("trashContent").childNodes;for(var X=0;X<r.length;X++){r[X].parentNode.removeChild(r[X]);X--}var o=document.getElementById("trashContent").appendChild(document.createElement("div"));o.id="trashList";N=M;for(X in N){var G=N[X][1];var H=N[X][0];var g=N[X][2];var K=N[X][4];var U=N[X][5];var l=o.appendChild(document.createElement("div"));l.id=H;l.className="entry";var R=l.appendChild(document.createElement("table"));R.width="100%";var A=R.appendChild(document.createElement("tr"));var I=A.appendChild(document.createElement("td"));I.className="checkboxCell";var c=I.appendChild(document.createElement("input"));c.type="checkbox";c.name="trashListItems";c.value=H;var B=A.appendChild(document.createElement("td"));var e=B.appendChild(document.createElement("a"));e.id="name"+H;var y="javascript:haveToUndelete()";e.href=y;e.appendChild(document.createTextNode(G));var w=A.appendChild(document.createElement("td"));w.align="center";w.className="folderCell";if(U!="?none?"){for(fold in Z){if(Z[fold][1]==U){var u=w.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(Z[fold][0]));u.className="folderSpan"}}}w.style.display="none";var C=A.appendChild(document.createElement("td"));C.className="sharedCell";C.align="right";if(K.length==0){var W=""}else{if(K.length==1){var W="1 person "}else{var W=String(K.length)+" people "}}C.appendChild(document.createTextNode(W));var ad=C.appendChild(document.createElement("a"));var y="javascript:sharePrompt('"+H+"')";ad.href=y;ad.appendChild(document.createTextNode("Manage"));ad.id="share"+H;ad.title=K.join("&");C.style.display="none";var k=A.appendChild(document.createElement("td"));k.className="emailCell";k.align="center";var v=k.appendChild(document.createElement("a"));v.className="emailLink";y='javascript:emailPrompt("'+H+'")';v.href=y;v.appendChild(document.createTextNode("Email"));k.style.display="none";var F=A.appendChild(document.createElement("td"));F.className="updatedCell";F.align="center";F.appendChild(document.createTextNode(g))}if(document.getElementById(t)==null){t="ownedFolder"}document.getElementById(t).className=document.getElementById(t).className.replace(" current","")+" current";document.getElementById(t).style.backgroundColor="#2352AE";tabs(t);if(a){sharePrompt(a)}document.getElementById("refresh_icon").style.visibility="hidden"})}function renameFolder(){var b=prompt("Rename Folder",this.parentNode.title);if(b!=null){b=b.replace(/^\s+/,"").replace(/\s+$/,"");if(b!=""){var a=this.parentNode.value.replace("Folder","");var c=document.getElementById(this.parentNode.value);c.innerHTML="";c.appendChild(document.createElement("img")).src="images/folder.png";c.appendChild(document.createElement("span")).appendChild(document.createTextNode(" "));c.appendChild(document.createTextNode(b));$.post("/renamefolder",{folder_name:b,folder_id:a},function(){refreshList()})}}}function deleteFolder(){var b=confirm("Are you sure you want to delete this folder?");if(b==true){var a=this.parentNode.value.replace("Folder","");$.post("/deletefolder",{folder_id:a},function(){refreshList()})}}function selectAll(d,e){var c=document.getElementsByTagName("input");var a=d.checked;for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].name==e){c[b].checked=a}}}}function script(a){url="/editor?resource_id="+a;window.open(url);setTimeout("refreshList()",5000)}function haveToUndelete(){alert("You have to Undelete this script to view it.\n\nThe Undelete button is right above your scriptlist.")}function deleteScript(a){var b=document.getElementById(a);b.style.backgroundColor="#ccc";b.style.opacity="0.5";var d=document.getElementsByTagName("div");for(i in d){if(d[i].className=="entry"&&d[i].id==a&&d[i]!=b){d[i].style.backgroundColor="#ccc";d[i].style.opacity="0.5"}}$.post("/delete",{resource_id:a},function(){b.parentNode.removeChild(b);document.getElementById("trashList").appendChild(b);b.style.backgroundColor="#f9f9fc";b.style.opacity="1";var e=b.firstChild;e=(e.nodeName=="#text"?e.nextSibling:e);e.getElementsByTagName("input")[0].name="trashListItems";var f=e.getElementsByTagName("td");f[2].style.display="none";f[3].style.display="none";f[4].style.display="none";f[1].firstChild.href="javascript:haveToUndelete()";document.getElementById("trashNoEntries").style.display="none";var f=document.getElementsByTagName("div");for(i in f){if(f[i].className=="entry"&&f[i].id==a&&f[i]!=b){f[i].parentNode.removeChild(f[i])}}})}function undelete(a){var b=document.getElementById(a);b.style.backgroundColor="#ccc";b.style.opacity="0.5";$.post("/undelete",{resource_id:a},function(){b.parentNode.removeChild(b);document.getElementById("list").appendChild(b);b.style.backgroundColor="#f9f9fc";b.style.opacity="1";var d=b.firstChild;d=(d.nodeName=="#text"?d.nextSibling:d);d=d.firstChild;d=(d.nodeName=="#text"?d.nextSibling:d);var e=d.getElementsByTagName("td");d.getElementsByTagName("input")[0].name="listItems";d.getElementsByTagName("a")[0].href="javascript:script('"+a+"')";for(i in e){if(e[i].style!=undefined){e[i].style.display="table-cell"}}document.getElementById("noentries").style.display="none"})}function hardDelete(a){var b=document.getElementById(a);b.style.backgroundColor="#ccc";b.style.opacity="0.5";$.post("/harddelete",{resource_id:a},function(){b.parentNode.removeChild(b)})}function batchProcess(b){var a=true;if(b=="hardDelete"){a=false;if(confirm("Are you sure you want to delete these scripts? This cannot be undone.")){a=true}}if(a){var e=false;var d=document.getElementsByTagName("input");for(var c=0;c<d.length;c++){if(d[c].type=="checkbox"){if(d[c].checked==true){if(d[c].name.substr(0,9)=="listItems"||d[c].name=="sharedListItems"||d[c].name=="trashListItems"){if(b=="delete"){deleteScript(d[c].value)}if(b=="undelete"){undelete(d[c].value)}if(b=="hardDelete"){hardDelete(d[c].value)}e=true}}}}if(e==true){setTimeout("refreshList()",5000)}}}function emailComplete(a){document.getElementById("emailS").disabled=false;document.getElementById("emailS").value="Send";if(a=="sent"){alert("Email Sent");hideEmailPrompt()}else{alert("There was a problem sending your email. Please try again later.")}}function emailScript(){tokenize("recipient");var b=new Array();var h=document.getElementsByTagName("span");for(var f=0;f<h.length;f++){if(h[f].className=="mailto"){b.push(h[f].innerHTML)}}var a=b.join(",");var e=document.getElementById("subject").value;if(e==""){e="Script"}var g=document.getElementById("message").innerHTML;var d=document.getElementById("emailTitle").selectedIndex;$.post("/emailscript",{resource_id:resource_id,recipients:a,subject:e,body_message:g,fromPage:"scriptlist",title_page:d},function(c){emailComplete(c)});document.getElementById("emailS").disabled=true;document.getElementById("emailS").value="Sending..."}var resource_id="";function emailPrompt(a){resource_id=a;document.getElementById("emailpopup").style.visibility="visible";document.getElementById("edit_title_href").href="/titlepage?resource_id="+resource_id}function hideEmailPrompt(){document.getElementById("emailpopup").style.visibility="hidden";document.getElementById("recipient").value="";document.getElementById("subject").value="";document.getElementById("message").innerHTML="";document.getElementById("recipients").innerHTML=""}function duplicate(){var a=0;var c=document.getElementsByTagName("input");for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].checked==true){if(c[b].name=="listItems"){var d=c[b].value;a++}}}}if(a>1){alert("select one at a time")}else{if(a==1){$.post("/duplicate",{resource_id:d,fromPage:"editor"},function(e){if(e=="fail"){return}else{window.open(e),refreshList()}})}}}function renamePrompt(){var a=0;var c=document.getElementsByTagName("input");for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].checked==true){if(c[b].name=="listItems"){var d=c[b].value;a++}}}}if(a>1){alert("select one at a time")}else{if(a==1){var e="name"+d;document.getElementById("renameTitle").innerHTML="Rename "+document.getElementById(e).innerHTML;document.getElementById("renameField").value=document.getElementById(e).innerHTML;document.getElementById("renamepopup").style.visibility="visible";document.getElementById("resource_id").value=d}}}function hideRenamePrompt(){document.getElementById("renameField").value="";document.getElementById("renamepopup").style.visibility="hidden"}function renameScript(){var b=document.getElementById("resource_id").value;var a=document.getElementById("renameField").value;if(a==""){return}var c="name"+b;document.getElementById(c).innerHTML=a;$.post("/rename",{resource_id:b,rename:a,fromPage:"scriptlist"});hideRenamePrompt()}function uploadPrompt(){document.getElementById("uploadpopup").style.visibility="visible"}function hideUploadPrompt(){document.getElementById("uploadFrame").src="/convert";document.getElementById("uploadpopup").style.visibility="hidden"}function titleChange(){var a=document.getElementById("script").value;var b=a.replace(".celtx","");document.getElementById("hidden").value=b}function uploadScript(){var b=document.getElementById("script").files[0].getAsBinary();var a=document.getElementById("filename");$.post("/convertprocess",{script:b,filename:a})}function newScriptPrompt(){document.getElementById("newscriptpopup").style.visibility="visible"}function hideNewScriptPrompt(){document.getElementById("newScript").value="";document.getElementById("newscriptpopup").style.visibility="hidden";document.getElementById("createScriptButton").disabled=false;document.getElementById("createScriptButton").value="Create";document.getElementById("createScriptIcon").style.visibility="hidden"}function createScript(){var a=document.getElementById("newScript").value;if(a!=""){document.getElementById("createScriptButton").disabled=true;document.getElementById("createScriptButton").value="Creating Script...";document.getElementById("createScriptIcon").style.visibility="visible";$.post("/newscript",{filename:a,fromPage:"scriptlist"},function(b){window.open("/editor?resource_id="+b);hideNewScriptPrompt();refreshList()})}}window.addEventListener("message",recieveMessage,false);function recieveMessage(a){if(a.origin!="http://www.rawscripts.com"){return}if(a.data=="uploading"){document.getElementById("uploading").style.display="block";document.getElementById("uploadFrame").style.display="none"}else{document.getElementById("uploading").style.display="none";document.getElementById("uploadFrame").style.display="block";window.open("/editor?resource_id="+a.data);refreshList()}}function hideExportPrompt(){document.getElementById("exportpopup").style.visibility="hidden";document.getElementById("exportList").innerHTML=""}function exportPrompt(){var b=0;var c=document.getElementsByTagName("input");for(var e=0;e<c.length;e++){if(c[e].type=="checkbox"){if(c[e].checked==true){if(c[e].name=="listItems"||c[e].name=="sharedListItems"){var k=document.createElement("tr");var l=document.getElementById("exportList").appendChild(k);var m=l.appendChild(document.createElement("td"));var d=document.createTextNode(document.getElementById("name"+c[e].value).innerHTML);m.appendChild(d);m=l.appendChild(document.createElement("td"));var j=document.createElement("select");var h=m.appendChild(j);h.name=c[e].value;var f=h.appendChild(document.createElement("option"));f.appendChild(document.createTextNode("Adobe PDF"));f=h.appendChild(document.createElement("option"));f.appendChild(document.createTextNode("txt (for Celtx or FD)"));m=k.appendChild(document.createElement("td"));j=m.appendChild(document.createElement("select"));j.name="export_format";f=j.appendChild(document.createElement("option"));f.appendChild(document.createTextNode("Without Title Page"));f=j.appendChild(document.createElement("option"));f.appendChild(document.createTextNode("With Title Page"));var g=k.appendChild(document.createElement("td")).appendChild(document.createElement("a"));g.appendChild(document.createTextNode("Edit Title page"));g.href="/titlepage?resource_id="+c[e].value;g.target="_blank";b++}}}}if(b>0){document.getElementById("exportpopup").style.visibility="visible"}}function exportScripts(){var f;var c;var a=document.getElementsByTagName("select");for(var b=0;b<a.length;b++){if(a[b].name!="export_format"&&a[b].name!=""){f=a[b].name;if(a[b].selectedIndex==0){c="pdf"}else{c="txt"}var e=a[b].parentNode;e=e.nextSibling;if(e.nodeName=="#text"){e=e.nextSibling}e=e.firstChild;if(e.nodeName=="#text"){e=e.nextSibling}var d="&title_page="+e.selectedIndex;url="/export?resource_id="+f+"&export_format="+c+"&fromPage=scriptlist"+d;window.open(url)}}hideExportPrompt()}function removeAccess(b){var a=confirm("Are you sure you want to take away access from "+b+"?");if(a==true){var c=document.getElementById("shareResource_id").value;$.post("/removeaccess",{resource_id:c,fromPage:"scriptlist",removePerson:b},function(d){removeShareUser(d)});document.getElementById("shared"+b.toLowerCase()).style.opacity="0.5";document.getElementById("shared"+b.toLowerCase()).style.backgroundColor="#ddd"}}function removeShareUser(a){document.getElementById("shared"+a).parentNode.removeChild(document.getElementById("shared"+a));refreshList()}function sharePrompt(h){document.getElementById("shareS").disabled=false;document.getElementById("shareS").value="Send Invitation";var c=(document.getElementById("share"+h).title==""?[]:document.getElementById("share"+h).title.split("&"));var d=document.getElementById("hasAccess");document.getElementById("collaborator").value="";document.getElementById("collaborators").innerHTML="";d.innerHTML="";for(var f=0;f<c.length;f++){if(c[f]!="none"){var j=d.appendChild(document.createElement("tr"));j.id="shared"+c[f].toLowerCase();var e=j.appendChild(document.createElement("td"));e.appendChild(document.createTextNode(c[f]));var g=j.appendChild(document.createElement("td"));g.align="right";var a=g.appendChild(document.createElement("a"));a.appendChild(document.createTextNode("Remove Access"));var b="javascript:removeAccess('"+c[f]+"')";a.href=b}}document.getElementById("shareTitle").innerHTML=document.getElementById("name"+h).innerHTML;document.getElementById("sharepopup").style.visibility="visible";document.getElementById("shareResource_id").value=h}function hideSharePrompt(){document.getElementById("sharepopup").style.visibility="hidden";document.getElementById("collaborator").value="";document.getElementById("collaborators").innerHTML="";document.getElementById("hasAccess").innerHTML=""}function shareScript(){tokenize("collaborator");var a=new Array();var f=document.getElementsByTagName("span");for(var b=0;b<f.length;b++){if(f[b].className=="mailto"){a.push(f[b].innerHTML)}}var e=a.join(",");var d=document.getElementById("shareResource_id").value;$.post("/share",{resource_id:d,collaborators:e,fromPage:"scriptlist"},function(c){refreshList(d)});document.getElementById("shareS").disabled=true;document.getElementById("shareS").value="Sending Invites..."}function tokenize(f){var j=0;var u=document.getElementsByTagName("div");for(var q=0;q<u.length;q++){if(u[q].className=="token"){j++}}if(j>4){alert("You can only have 5 recipients at a time for now. Only the first five will be sent.");return}var a=document.getElementById(f);var v=a.value.replace(",","");var s=v.replace(/ /g,"");if(s==""){return}var b=v.split(" ");var o=b.pop();var w="";if(b.length==0){w=o}else{w=b.join(" ").replace(/"/g,"")}var d=document.createElement("div");var h=document.getElementById(f+"s").appendChild(d);h.className="token";h.id=o;var e=document.createElement("span");var t=h.appendChild(e);var n=document.createTextNode(w);t.appendChild(n);var e=document.createElement("span");var p=h.appendChild(e);var l=document.createTextNode(o);p.className="mailto";p.appendChild(l);var g=document.createElement("a");var k=h.appendChild(g);var r=document.createTextNode(" | X");k.appendChild(r);var m='javascript:removeToken("'+o+'")';k.setAttribute("href",m);a.value=""}function removeToken(a){var b=document.getElementById(a);b.parentNode.removeChild(b)};