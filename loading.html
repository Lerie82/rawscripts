<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Loading...</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
function load() {
	var url = window.location.href;
	var filename = url.split('=')[1];
	$.post("/newscript", {filename : filename}, function(data){handleData(data)});
}
function handleData(data){
    if (data=='error'){
        document.getElementById('couldnotloadpopup').style.visibility = 'visible';
    }
    else{
        window.location=data;
    }
}
function refresh(){
    window.location = window.location.href;
}
</script>

</head>

<body onload="load()">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16492540-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<div id="couldnotloadpopup" style="visibility:hidden; position:absolute; width:100%; height:100%; top:0; left:0;  z-index:100">
	<div id="fade" style="background:#fff; opacity:0.5; height:100%; width:100%; position:fixed"></div>
	<div class="popup_block" style="background:#7694D8; width:450px; position:relative; margin:auto; top:20%; padding:10px; border:double">
		<div class="popup">
			<a href="javascript:refresh()" style="color:#333">Try Reloading</a>
			<br /><br />
            <b>Grr... Error...</b>
            <br />
            <p>Sorry. There was a problem loading your script. <a id="alt_link" href="http://docs.google.com">Login to Google Docs</a> to make sure there you're using a valid Google Account.</p>
            <p>Then, just try <a href="javascript:refresh()">refreshing the page</a>.</p>
			<br />
            <div id="collaborators"></div>
			<br />
		</div>
	</div>
</div>
	<div style="width:600px; margin-left:auto; margin-right:auto">
    	<h2>Loading...</h2>
        <img src="images/loading.gif" />
    	<p>Hey. Right now, we're running through a bunch of precesses to create your new script. Should only take a few seconds.</p>
        <p>It'll be saved in your Google Docs in a folder called "Screenplay," so you can always grab it there.</p>
        
    </div>
</body>
</html>
