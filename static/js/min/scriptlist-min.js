function uploadWindow(a){if(a.data=="uploading"){document.getElementById("uploadFrame").height="0px";document.getElementById("uploadFrame").width="0px";document.getElementById("uploading").style.display="block"}else{document.getElementById("uploadFrame").style.height="210px";document.getElementById("uploadFrame").style.width="250px";document.getElementById("uploading").style.display="none";window.open(a.data);refreshList()}}function tabs(a){var d=document.getElementsByTagName("input");for(var b=0;b<d.length;b++){if(d[b].type=="checkbox"){d[b].checked=false}}if(a=="myScripts"){document.getElementById("owned").style.display="block";document.getElementById("shared").style.display="none"}else{document.getElementById("owned").style.display="none";document.getElementById("shared").style.display="block"}}function refreshList(a){$.post("/list",function(K){document.getElementById("loading").style.display="none";var q=K.split("?shared=")[0];if(q=="?owned=none"){document.getElementById("noentries").style.display="block"}else{var n=document.getElementById("content").childNodes;for(var E=0;E<n.length;E++){n[E].parentNode.removeChild(n[E]);E--}q=q.slice(19);var x=q.split("?scriptname=");var u=document.getElementById("content").appendChild(document.createElement("div"));u.id="list";for(var E=0;E<x.length;E++){var L=x[E].split("?resource_id=")[0];var h=x[E].split("?resource_id=")[1].split("?alternate_link=")[0];var y=x[E].split("?resource_id=")[1].split("?alternate_link=")[1].split("?updated=")[0];var G=x[E].split("?resource_id=")[1].split("?alternate_link=")[1].split("?updated=")[1].split("?shared_with=")[0];var c=x[E].split("?newNotes=")[0].split("?shared_with=");c.splice(0,1);var p=false;if(x[E].split("?newNotes=").length!=1){p=true}var o=u.appendChild(document.createElement("div"));o.id=h;o.className="entry";var F=o.appendChild(document.createElement("table"));F.width="100%";var B=F.appendChild(document.createElement("tr"));var d=B.appendChild(document.createElement("td"));d.className="checkboxCell";var w=d.appendChild(document.createElement("input"));w.type="checkbox";w.name="listItems";w.value=h;var g=B.appendChild(document.createElement("td"));var s=g.appendChild(document.createElement("a"));s.id="name"+h;if(p==true){var H=g.appendChild(document.createElement("span"));H.appendChild(document.createTextNode(" New Notes"));H.className="redAlertSpan"}var D='javascript:script("'+h+'")';s.href=D;s.appendChild(document.createTextNode(L));var m=B.appendChild(document.createElement("td"));m.className="sharedCell";m.align="right";if(c[0]=="none"){var b=""}else{if(c.length==1){var b="1 person "}else{var b=String(c.length)+" people "}}m.appendChild(document.createTextNode(b));var j=m.appendChild(document.createElement("a"));var D="javascript:sharePrompt('"+h+"')";j.href=D;j.appendChild(document.createTextNode("Manage"));j.id="share"+h;j.title=c.join("&");var z=B.appendChild(document.createElement("td"));z.className="emailCell";z.align="center";var r=z.appendChild(document.createElement("a"));r.className="emailLink";D='javascript:emailPrompt("'+h+'")';r.href=D;r.appendChild(document.createTextNode("Email"));var v=B.appendChild(document.createElement("td"));v.className="updatedCell";v.align="center";v.appendChild(document.createTextNode(G));var I=B.appendChild(document.createElement("td"));I.className="gdocsCell";I.align="center";var t=I.appendChild(document.createElement("a"));t.href=y;t.target="_blank";var A=t.appendChild(document.createElement("img"));A.src="images/docs.gif";var l=t.appendChild(document.createElement("img"));l.src="images/popup.png"}}var f=K.split("?shared=")[1];document.getElementById("sharedLoading").style.display="none";if(f=="none"){document.getElementById("sharedNoEntries").style.display="block"}else{var n=document.getElementById("sharedContent").childNodes;for(var E=0;E<n.length;E++){n[E].parentNode.removeChild(n[E]);E--}f=f.slice(12);var J=f.split("?scriptname=");var u=document.getElementById("sharedContent").appendChild(document.createElement("div"));u.id="sharedList";for(var E=0;E<J.length;E++){var L=J[E].split("?resource_id=")[0];var h=J[E].split("?resource_id=")[1].split("?alternate_link=")[0];var y=J[E].split("?resource_id=")[1].split("?alternate_link=")[1].split("?updated=")[0];var G=J[E].split("?resource_id=")[1].split("?alternate_link=")[1].split("?updated=")[1].split("?shared_with=")[0];var c=J[E].split("?resource_id=")[1].split("?alternate_link=")[1].split("?updated=")[1].split("?shared_with=")[1].split("?etagUpdate=")[0];var C=J[E].split("?etagUpdate=")[1];var o=u.appendChild(document.createElement("div"));o.id=h;o.className="entry";var F=o.appendChild(document.createElement("table"));F.width="100%";var B=F.appendChild(document.createElement("tr"));var d=B.appendChild(document.createElement("td"));d.className="checkboxCell";var w=d.appendChild(document.createElement("input"));w.type="checkbox";w.name="sharedListItems";w.value=h;var g=B.appendChild(document.createElement("td"));var s=g.appendChild(document.createElement("a"));s.id="name"+h;var D='javascript:script("'+h+'")';s.href=D;s.appendChild(document.createTextNode(L));if(C=="yes"){var k=g.appendChild(document.createElement("span"));k.appendChild(document.createTextNode(" Updated"));k.className="redAlertSpan"}var m=B.appendChild(document.createElement("td"));m.className="sharedCell";m.align="center";m.appendChild(document.createTextNode(c));var z=B.appendChild(document.createElement("td"));z.className="emailCell";z.align="center";var r=z.appendChild(document.createElement("a"));r.className="emailLink";D='javascript:emailPrompt("'+h+'")';r.href=D;r.appendChild(document.createTextNode("Email"));var v=B.appendChild(document.createElement("td"));v.className="updatedCell";v.align="center";v.appendChild(document.createTextNode(G));var I=B.appendChild(document.createElement("td"));I.className="gdocsCell";I.align="center";var t=I.appendChild(document.createElement("a"));t.href=y;t.target="_blank";var A=t.appendChild(document.createElement("img"));A.src="images/docs.gif";var l=t.appendChild(document.createElement("img"));l.src="images/popup.png"}}if(a){sharePrompt(a)}})}function tokenize(g){var k=0;var v=document.getElementsByTagName("div");for(var r=0;r<v.length;r++){if(v[r].className=="token"){k++}}if(k>4){alert("You can only have 5 recipients at a time for now. Only the first five will be sent.");return}var a=document.getElementById(g);var w=a.value.replace(",","");var t=w.replace(/ /g,"");if(t==""){return}var b=w.split(" ");var p=b.pop();var x="";if(b.length==0){x=p}else{x=b.join(" ").replace(/"/g,"")}var d=document.createElement("div");var j=document.getElementById(g+"s").appendChild(d);j.className="token";j.id=p;var f=document.createElement("span");var u=j.appendChild(f);var o=document.createTextNode(x);u.appendChild(o);var f=document.createElement("span");var q=j.appendChild(f);var m=document.createTextNode(p);q.className="mailto";q.appendChild(m);var h=document.createElement("a");var l=j.appendChild(h);var s=document.createTextNode(" | X");l.appendChild(s);var n='javascript:removeToken("'+p+'")';l.setAttribute("href",n);a.value=""}function removeToken(a){var b=document.getElementById(a);b.parentNode.removeChild(b)}function selectAll(d,f){var c=document.getElementsByTagName("input");var a=d.checked;for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].name==f){c[b].checked=a}}}}function script(a){url="/editor?resource_id="+a;window.open(url)}function deleteScript(b){var a=document.getElementById(b);a.style.backgroundColor="#ccc";a.style.opacity="0.5";$.post("/delete",{resource_id:b},function(){a.parentNode.removeChild(a)})}function batchProcess(a){var c=document.getElementsByTagName("input");for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].checked==true){if(c[b].name=="listItems"||c[b].name=="sharedListItems"){if(a=="delete"){deleteScript(c[b].value)}}}}}}function emailComplete(a){document.getElementById("emailS").disabled=false;document.getElementById("emailS").value="Send";if(a=="sent"){alert("Email Sent");hideEmailPrompt()}else{alert("There was a problem sending your email. Please try again later.")}}function emailScript(){tokenize("recipient");var b=new Array();var h=document.getElementsByTagName("span");for(var f=0;f<h.length;f++){if(h[f].className=="mailto"){b.push(h[f].innerHTML)}}var a=b.join(",");var d=document.getElementById("subject").value;var g=document.getElementById("message").innerHTML;$.post("/emailscript",{resource_id:resource_id,recipients:a,subject:d,body_message:g,fromPage:"scriptlist"},function(c){emailComplete(c)});document.getElementById("emailS").disabled=true;document.getElementById("emailS").value="Sending..."}var resource_id="";function emailPrompt(a){resource_id=a;document.getElementById("emailpopup").style.visibility="visible"}function hideEmailPrompt(){document.getElementById("emailpopup").style.visibility="hidden";document.getElementById("recipient").value="";document.getElementById("subject").value="";document.getElementById("message").innerHTML="";document.getElementById("recipients").innerHTML=""}function renamePrompt(){var a=0;var c=document.getElementsByTagName("input");for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].checked==true){if(c[b].name=="listItems"){var d=c[b].value;a++}}}}if(a>1){alert("select one at a time")}else{if(a==1){var f="name"+d;document.getElementById("renameTitle").innerHTML="Rename "+document.getElementById(f).innerHTML;document.getElementById("renameField").value=document.getElementById(f).innerHTML;document.getElementById("renamepopup").style.visibility="visible";document.getElementById("resource_id").value=d}}}function hideRenamePrompt(){document.getElementById("renameField").value="";document.getElementById("renamepopup").style.visibility="hidden"}function renameScript(){var b=document.getElementById("resource_id").value;var a=document.getElementById("renameField").value;if(a==""){return}var c="name"+b;document.getElementById(c).innerHTML=a;$.post("/rename",{resource_id:b,rename:a,fromPage:"scriptlist"});hideRenamePrompt()}function uploadPrompt(){document.getElementById("uploadpopup").style.visibility="visible"}function hideUploadPrompt(){document.getElementById("uploadFrame").src="/convert";document.getElementById("uploadpopup").style.visibility="hidden"}function titleChange(){var a=document.getElementById("script").value;var b=a.replace(".celtx","");document.getElementById("hidden").value=b}function uploadScript(){var b=document.getElementById("script").files[0].getAsBinary();var a=document.getElementById("filename");$.post("/convertprocess",{script:b,filename:a})}function newScriptPrompt(){document.getElementById("newscriptpopup").style.visibility="visible"}function hideNewScriptPrompt(){document.getElementById("newScript").value="";document.getElementById("newscriptpopup").style.visibility="hidden"}function createScript(){var a=document.getElementById("newScript").value;if(a!=""){$.post("/newscript",{filename:a},function(b){window.addEventListen("message",recieveMessage(e),false);var c=window.open("editor")})}hideNewScriptPrompt();setTimeout("refreshList()",10000)}function recieveMessage(a){}function hideExportPrompt(){document.getElementById("exportpopup").style.visibility="hidden";document.getElementById("exportList").innerHTML=""}function exportPrompt(){var a=0;var b=document.getElementsByTagName("input");for(var d=0;d<b.length;d++){if(b[d].type=="checkbox"){if(b[d].checked==true){if(b[d].name=="listItems"||b[d].name=="sharedListItems"){var j=document.createElement("tr");var k=document.getElementById("exportList").appendChild(j);var l=k.appendChild(document.createElement("td"));var c=document.createTextNode(document.getElementById("name"+b[d].value).innerHTML);l.appendChild(c);l=k.appendChild(document.createElement("td"));var h=document.createElement("select");var g=l.appendChild(h);g.name=b[d].value;var f=g.appendChild(document.createElement("option"));f.appendChild(document.createTextNode("Adobe PDF"));f=g.appendChild(document.createElement("option"));f.appendChild(document.createTextNode(".txt (for Celtx or FD)"));a++}}}}if(a>0){document.getElementById("exportpopup").style.visibility="visible"}}function exportScripts(){var d;var c;var a=document.getElementsByTagName("select");for(var b=0;b<a.length;b++){d=a[b].name;if(a[b].selectedIndex==0){c="pdf"}else{c="txt"}url="/export?resource_id="+d+"&export_format="+c+"&fromPage=scriptlist";window.open(url)}hideExportPrompt()}function removeAccess(b){var a=confirm("Are you sure you want to take away access from "+b+"?");if(a==true){var c=document.getElementById("shareResource_id").value;$.post("/removeaccess",{resource_id:c,fromPage:"scriptlist",removePerson:b},function(d){removeShareUser(d)});document.getElementById("shared"+b.toLowerCase()).style.opacity="0.5";document.getElementById("shared"+b.toLowerCase()).style.backgroundColor="#ddd"}}function removeShareUser(a){document.getElementById("shared"+a).parentNode.removeChild(document.getElementById("shared"+a));refreshList()}function sharePrompt(j){document.getElementById("shareS").disabled=false;document.getElementById("shareS").value="Send Invitation";var c=document.getElementById("share"+j).title.split("&");var d=document.getElementById("hasAccess");document.getElementById("collaborator").value="";document.getElementById("collaborators").innerHTML="";d.innerHTML="";for(var g=0;g<c.length;g++){if(c[g]!="none"){var k=d.appendChild(document.createElement("tr"));k.id="shared"+c[g].toLowerCase();var f=k.appendChild(document.createElement("td"));f.appendChild(document.createTextNode(c[g]));var h=k.appendChild(document.createElement("td"));h.align="right";var a=h.appendChild(document.createElement("a"));a.appendChild(document.createTextNode("Remove Access"));var b="javascript:removeAccess('"+c[g]+"')";a.href=b}}document.getElementById("shareTitle").innerHTML=document.getElementById("name"+j).innerHTML;document.getElementById("sharepopup").style.visibility="visible";document.getElementById("shareResource_id").value=j}function hideSharePrompt(){document.getElementById("sharepopup").style.visibility="hidden";document.getElementById("collaborator").value="";document.getElementById("collaborators").innerHTML="";document.getElementById("hasAccess").innerHTML=""}function shareScript(){tokenize("collaborator");var a=new Array();var g=document.getElementsByTagName("span");for(var b=0;b<g.length;b++){if(g[b].className=="mailto"){a.push(g[b].innerHTML)}}var f=a.join(",");var d=document.getElementById("shareResource_id").value;$.post("/share",{resource_id:d,collaborators:f,fromPage:"scriptlist"},function(c){refreshList(d)});document.getElementById("shareS").disabled=true;document.getElementById("shareS").value="Sending Invites..."};