<!DOCTYPE html> 
<html> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<title>Script Editor</title> 
 
<link href="css/viewer.css" rel="stylesheet" type="text/css" /> 
<link href="css/jquery-ui.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script> 
<script type="text/javascript" src="js/jquery.scrollTo-min.js"></script>  
<SCRIPT type="text/javascript" src="js/jquery.effects.core.js"></SCRIPT> 
<SCRIPT type="text/javascript" src="js/jquery.effects.slide.js"></SCRIPT> 
<script type="text/javascript" src="js/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/viewer.js"></script>
<script>
$(document).ready(function(){
	var url = window.location.href;
	var resource_id = url.split('=')[1];
	$.post('/scriptcontent',
		   {resource_id:resource_id},
		   function(data){
			   if (data.split("&alternate_link&").length>1){
                    couldNotLoad(data);
                    return;
               }
			   document.getElementById('textEditor').innerHTML=data.split('&notes&')[0];
			   var titleDiv = document.getElementById('title');
			   var i=0;
			   while (i<titleDiv.childNodes.length){
				   titleDiv.removeChild(titleDiv.firstChild);
			   }
			   titleDiv.appendChild(document.createTextNode(document.getElementById('ajaxTitle').firstChild.nodeValue));
			   document.getElementById('textEditor').removeChild(document.getElementById('ajaxTitle'));
			   var c = $(':header');
				if (c[0]!=null){
					for (var i = 0; i<c.length; i++)
						{c[i].innerHTML = c[i].innerHTML.replace(/^\s+|\s+$/g,"");
					}
				}
			   insertSharedNotes(String(data.split('&notes&')[1]));
			   viewerinit(resource_id);
			   
			   })
	});
</script>
<body> 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16492540-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<div id="wholeShebang">
<div id='demo' style="display:none"></div>
<div id="hidden" style="display:none"></div>
<div id="intExt" style="display:none"><p class="scene">1) INT. </p><p class="scene">1) EXT. </p><p class="scene">1) INT./EXT. </p></div>
<div id="updatedTextAlert" class="alerts">Updated Notes</div>
<div id="loading" style="position:absolute; width:100%; height:100%; top:0; left:0;  z-index:100">
	<div id="fade" style="background:#fff; opacity:0.5; height:100%; width:100%; position:fixed"></div>
	<div class="popup_block" style="background:#7694D8; width:450px; position:relative; margin:auto; top:20%; padding:10px; border:double">
		<div class="popup">
			<p style="margin-left:40%; font-size:25px">Loading...</p>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="images/uploading.gif" />
		</div>
	</div>
</div>

<div id="hideshow" style="visibility:hidden; position:absolute; width:100%; height:100%; top:0; left:0;  z-index:100">
	<div id="fade" style="background:#fff; opacity:0.5; height:100%; width:100%; position:fixed"></div>
	<div class="popup_block" style="background:#7694D8; width:450px; position:relative; margin:auto; top:20%; padding:10px; border:double">
		<div class="popup">
			<a href="javascript:hideDiv()" style="color:#333">Close</a>
			<br /><br />
            Send Script
            <br /><br />
			
			<label for="recipient">Recipients (max 5, comma seperated)</label>
			<br />
            <div id="recipients"></div>
			<input class="TEXT" type='text' name='recipient' id='recipient' />
			<br />
			<label for="subject">Subject</label>
			<br />
			<input class="TEXT" type='text' name='subject' id='subject' />
			<br />
			<label for="message">Message (optional)</label>
			<br />
			<div class="TEXT" contentEditable='true' name='message' id='message' style="width:400px; height:110px; overflow:auto;"></div>
			<br />
			<input type='button' id="emailS" onClick='emailScript()' value='Send' />
			
            <br />
			<b>Note:</b> you will automatically get a copy yourself
		</div>
	</div>
</div>
<div id="printpopup" style="visibility:hidden; position:absolute; width:100%; height:100%; top:0; left:0;  z-index:100">
	<div id="fade" style="background:#fff; opacity:0.5; height:100%; width:100%; position:fixed"></div>
	<div class="popup_block" style="background:#7694D8; width:400px; position:relative; margin:auto; top:20%; padding:10px; border:double">
		<div class="popup">
			<a href="javascript:hidePrintPrompt()" style="color:#333">Close</a>
			<br /><br />
            <p style="margin:auto">Print Script with Notes?</p>
			<br /><br />
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type='button' style="font-size:18pt;" onClick="printScript('1')" value='   Yes   ' />
            <input type='button' style="font-size:18pt; margin-left:15px;" onClick="printScript('0')" value='   No   ' />
            <br />
		</div>
	</div>
</div>
<div id="exportpopup" style="visibility:hidden; position:absolute; width:100%; height:100%; top:0; left:0;  z-index:100">
	<div id="fade" style="background:#fff; opacity:0.5; height:100%; width:100%; position:fixed"></div>
	<div class="popup_block" style="background:#7694D8; width:400px; position:relative; margin:auto; top:20%; padding:10px; border:double">
		<div class="popup">
			<a href="javascript:hideExportPrompt()" style="color:#333">Close</a>
			<br />
			<p>Export as...</p>
			<input class='exportList' type="checkbox" checked='true' name="pdf" /> Adobe Pdf<br>
			<input class='exportList' type="checkbox" name='txt' /> .txt for Celtx or FD
			<br />
			<input type='button' id="exportS" onClick='exportScripts()' value='Export' />
			
            <br />
		</div>
	</div>
</div>
<div id="couldnotloadpopup" style="visibility:hidden; position:absolute; width:100%; height:100%; top:0; left:0;  z-index:100">
	<div id="fade" style="background:#fff; opacity:0.5; height:100%; width:100%; position:fixed"></div>
	<div class="popup_block" style="background:#7694D8; width:450px; position:relative; margin:auto; top:20%; padding:10px; border:double">
		<div class="popup">
			<a href="javascript:refresh()" style="color:#333">Try Reloading</a>
			<br /><br />
            <b>Lights! Camera! ... wait, why did the lights go out...?</b>
            <br />
            <p>Sorry. There was a problem loading your script. <a id="alt_link" href="#" target="_blank">Check out your script in Google Docs</a>, then try <a href="javascript:refresh()">refreshing the page</a>.</p>
			<br />
			<br />
		</div>
	</div>
</div>
<div id="header" style="position:fixed; top:0; left:0; right:0; height:56pt;">
<div id="title" style="float:left; font-size:18pt; margin:5px 0 0 10px;">{{ script_title }}</div> 
<div style="float:right; margin:5px 10px 0 0;"><b id="user">{{  user  }}</b>  |  <a href="/">Home</a>  |  <a href="{{ sign_out }}">Sign Out</a></div>

<div style="width:100%; clear:both; background-color:#7694D8; padding:3px 0; position:absolute; bottom:0; border-top:2px groove; border-bottom:2px ridge;"> 
<input type="button" id="submit" onMouseUp="submitNotes()" value="Submit Notes" /> 


<div id="optionMenu" style="position:absolute; z-index:100; right:10px; top:2pt">
	<div class="menuItem" style="cursor:pointer">Options</div>
		<div id="hiddenMenu" style="display:none">
			<div class="menuItem"><table style="width:100%" cellpadding="0" cellspacing="0"><tr><td style="width:25px"></td><td><a href="javascript:exportPrompt()">Export as...</a></td><td id="printShortcut" align="right" style="width:35px"></td></tr></table></div>
            <div class="menuItem"><table style="width:100%" cellpadding="0" cellspacing="0"><tr><td style="width:25px"></td><td><a href="javascript:printPrompt()">Print</a></td><td align="right" style="width:35px"></td></tr></table></div>
			<div class="menuItem"><table style="width:100%" cellpadding="0" cellspacing="0"><tr><td style="width:25px"></td><td><a href="javascript:emailPrompt()">Email</a></td><td align="right" style="width:35px"></td></tr></table></div>
		</div>
	</div>
</div>
</div> 
<div id="container" style="position:absolute; top:59pt; left: 4px; right:13px; bottom:1px; overflow:auto;  border:4px #ccc ridge; "> 
	<div id="textEditor" style="padding:5px 10px 100px 10px; margin-top:0px; width:600px; min-height:100%; height:auto; margin-left:auto; margin-right:auto""> 
		{{ content }}
	</div> 
    <div id="info" style="position:fixed;right:32px; bottom:1px; left:4px; background-color:#ccc; border:ridge; padding:2px; padding-right:20px;">
    	<div id="onTabOrEnter" style="float:left; padding-left:20px;">read only access</div>
    	
    	<div id="pages" style="float:right">
        	Page: <b id="currentPage">1</b><b id="totalPages"></b>
        </div> 
    </div>
</div>
<div id="effect" style="position:fixed; top:59pt; right:-352px; bottom:5px; width:365px; overflow:hidden; z-index:0;"> 
	<div align="center" style="width:11px; position:absolute; top:0px; bottom:0px; border: 1px #bbb solid; background-Color: #ddd"> 
		<div id="sidebarButton" onMouseOver="this.style.backgroundColor = '#888888'" onMouseOut="this.style.backgroundColor = '#aaaaaa'" style="margin-top:45%; background-Color:#aaa; cursor:pointer;"> 
		<<br>>
		</div> 
	</div> 
    <div id="scriptInfo" style="position:absolute; top:0px; right: 0px; bottom:0; border:4px ridge; width:344px;">
        <div align="right" class="infoBox" id="scenebox">
            <div id='sceneBoxHandle' class="infoHandle">Scene Index</div>
            <div id="sceneindex" style="overflow:auto; padding:2px;" align="left"></div> 
        </div> 
        <div align="right" class="infoBox" id="notebox"> 
            <div id='noteBoxHandle' class="infoHandle">Notes</div>
            <div id="noteindex" style="overflow:auto;" align="left"></div> 
        </div> 
        <div align="right" class="infoBox" id="characterbox">
            <div id='characterBoxHandle' class="infoHandle">Characters</div>
            <div id="characterindex" style="overflow:auto; padding:2px;" align="left"></div> 
        </div> 
    </div>
</div>
<div id="mouseInfo" style="display:none">up?0?0</div>
</div>
  <script>
   CFInstall.check({
     mode: "overlay",
     destination: "http://www.rawscripts.com/scriptlist"
   });
  </script>
</body> 
</html>
