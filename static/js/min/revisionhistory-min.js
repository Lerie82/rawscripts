$(document).ready(function(){document.getElementById("script").style.height=$("#container").height()-65+"px";document.getElementById("script").style.width=$("#container").width()-300+"px";document.getElementById("sidebar").style.height=($("#container").height()-65)+"px";$(":radio").click(function(){radioClick(this)});var b=document.getElementsByTagName("input");var a=false;for(i in b){if(!a){if(b[i].type=="radio"){b[i].checked=true;a=true}}}});$(window).resize(function(){document.getElementById("script").style.height=$("#container").height()-65+"px";document.getElementById("script").style.width=$("#container").width()-300+"px";document.getElementById("sidebar").style.height=($("#container").height()-65)+"px"});function setup(){resource_id=window.location.href.split("=")[1];var b=document.getElementsByTagName("input");var a=b[b.length-1].value.substr(1);if(a!="1"){$.post("/revisionlist",{resource_id:resource_id,version:a},function(c){buildTable(c)})}$.post("/revisionget",{resource_id:resource_id,version:"latest"},function(c){if(c=="not found"){}document.getElementById("scriptcontent").innerHTML=c})}function radioClick(d){if(document.getElementById("sel").selectedIndex==0){var e=document.getElementsByTagName("input");for(i in e){if(e[i].type=="radio"&&e[i].parentNode.className=="viewScript"){e[i].checked=false}}d.checked=true;e=d;while(e.nodeName!="TR"){e=e.parentNode}console.log(e.id);changeVersion(d.value,e.id)}else{var b=this.value.substr(0,1);var e=document.getElementsByTagName("input");for(i in e){if(e[i].type=="radio"&&e[i].value.substr(0,1)==b){e[i].checked=false}if(e[i].type=="radio"&&e[i].value.substr(0,1)!=b&&e[i].checked){var a=e[i].value}}this.checked=true;compareVersions(this.value,a)}}function buildTable(g){var c=document.getElementById("tb");var e=JSON.parse(g);for(i in e){var f=c.appendChild(document.createElement("tr"));f.id=e[i][0];f.className=(e[i][3]==0?"manualsave":"autosave");var b=f.appendChild(document.createElement("td"));b.align="center";b.className="viewScript";var a=b.appendChild(document.createElement("input"));a.type="radio";a.value="1"+e[i][2];b=f.appendChild(document.createElement("td"));b.align="center";b.className="compare";a=b.appendChild(document.createElement("input"));a.type="radio";a.value="2"+e[i][2];b=f.appendChild(document.createElement("td"));b.align="center";b.appendChild(document.createTextNode(e[i][2]));b=f.appendChild(document.createElement("td"));b.align="center";b.appendChild(document.createTextNode(e[i][1]))}$(":radio").click(function(){radioClick(this)})}function changeVersion(a,b){console.log(a,b);$.post("/revisionget",{resource_id:b,version:String(a).substr(1)},function(c){if(c=="not found"){}document.getElementById("scriptcontent").innerHTML=c})}function compareVersions(c,b){var a=[c,b].sort();version_one=a[0].substr(1),version_two=a[1].substr(1);resource_id=window.location.href.split("=")[1];$.post("/revisioncompare",{resource_id:resource_id,version_one:version_one,version_two:version_two},function(d){if(d=="not found"){}document.getElementById("scriptcontent").innerHTML=d})}function compareToggle(b){console.log(b);if(b==1){$(".compare").css("display","block")}if(b==0){$(".compare").css("display","none");var d=document.getElementsByTagName("input");var a=[];for(i in d){if(d[i].type=="radio"&&d[i].checked){a.push(d[i].value)}}a=a.sort();changeVersion(a[0])}}function copyThisVersion(){var e=document.getElementsByTagName("input");for(i in e){if(e[i].type=="radio"&&e[i].value.substr(0,1)==1&&e[i].checked){var a=e[i].value;var b=e[i];while(b.nodeName!="TR"){b=b.parentNode}}}$.post("/revisionduplicate",{resource_id:b.id,version:a.substr(1)},function(c){window.open(c)})}function topMenuOut(a){if(document.getElementById(a+"Menu").style.display=="none"){document.getElementById(a).style.backgroundColor="#A2BAE9";document.getElementById(a).style.color="black"}}function duplicate(){$.post("/duplicate",{resource_id:resource_id,fromPage:"editor"},function(a){if(a=="fail"){return}else{window.open(a)}})}function exportPrompt(){save(0);document.getElementById("exportpopup").style.visibility="visible"}function hideExportPrompt(){typeToScript=true;document.getElementById("exportpopup").style.visibility="hidden"}function exportScripts(){var e=window.location.href;var g=e.split("=")[1];if(g=="demo"){nope();return}else{var j;var h="&title_page="+document.getElementById("et").selectedIndex;var f=document.getElementsByTagName("input");for(var k=0;k<f.length;k++){if(f[k].checked==true){if(f[k].className=="exportList"){j=f[k].name;e="/export?resource_id="+g+"&export_format="+j+"&fromPage=editor"+h;window.open(e)}}}}};