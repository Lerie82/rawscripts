<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>RawScripts - Title Page</title>
<link rel="shortcut icon" href="/favicon.ico">
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script>
        $('document').ready(function(){
        $(':input').keyup(function(){update()});
        $(':checkbox').click(function(){update()});
        });
        function closeTitlePage(){
            window.close()
        }
        function save(){
            var resource_id=window.location.href.split('=')[1];
            if (resource_id=='Demo'){
                alert("Sorry, but you'll have to login to use these functions!");
                return;
            }
            var i =[];
            var c = document.getElementsByTagName('input');
            for(x in c){
                if(c[x].type=='text')i.push(c[x].value)
                else if(c[x].type=='checkbox'){
                    if(c[x].checked==true)i.push('checked');
                    else{i.push('')}
                }
            }
            c = document.getElementsByTagName('textarea');
            for(x in c){
                if(c[x].value!=undefined){
                    var data = c[x].value;
                    var re = new RegExp( "\\n", "g" );
                    data=data.replace(re,'LINEBREAK');
                    i.push(data);
                }
            }
            $.post("/titlepagesave", {title: i[0] , authorOne: i[1] , authorTwo : i[2], authorTwoChecked : i[3], authorThree : i[4], authorThreeChecked : i[5], based_onChecked : i[6], addressChecked : i[7], phone : i[8], phoneChecked : i[9],  cell : i[10], cellChecked : i[11], email : i[12], emailChecked : i[13], registered : i[14], registeredChecked : i[15], other : i[16], otherChecked : i[17], based_on : i[18], address : i[19], resource_id : resource_id}, function(data){document.getElementById('saveButton').value="Saved"});
            document.getElementById('saveButton').disabled=true;
            document.getElementById('saveButton').value="Saving..."
        }
        
        
        function update(){
            document.getElementById('saveButton').value="Save";
            document.getElementById('saveButton').disabled=false;
            document.getElementById('title').innerHTML="";
            document.getElementById('title').appendChild(document.createTextNode(document.getElementById("title_input").value));
            document.getElementById('authorOne').innerHTML="";
            document.getElementById('authorOne').appendChild(document.createTextNode(document.getElementById("authorOne_input").value));
            var c=document.getElementsByTagName('input')
            for(i in c){
                if (c[i].type=='checkbox'){
                    var check = (c[i].checked==true ? true : false);
                    var n = c[i].parentNode;
                    n=n.previousSibling;
                    if(n.nodeName=='#text')n=n.previousSibling;
                    n=n.firstChild;
                    if(n.nodeName=='#text')n=n.nextSibling;
                    if(n.value=="" && !check)n.value="none";
                    var data = n.value;
                    if (c[i].id=="address_checkbox" || c[i].id=="based_on_checkbox"){
                        var re = new RegExp( "\\n", "g" );
                        data=data.replace(re,'<br>');
                        document.getElementById(c[i].id.replace('_checkbox',"")).innerHTML=data;
                    }
                    else{
                        document.getElementById(c[i].id.replace('_checkbox',"")).innerHTML="";
                        document.getElementById(c[i].id.replace('_checkbox',"")).appendChild(document.createTextNode(data));
                    }
                    if(check){
                        document.getElementById(c[i].id.replace('_checkbox',"_input")).disabled=false;
                        document.getElementById(c[i].id.replace('_checkbox',"")).style.visibility='visible';
                    }
                    else{
                        document.getElementById(c[i].id.replace('_checkbox',"_input")).disabled=true;
                        document.getElementById(c[i].id.replace('_checkbox',"")).style.visibility='hidden';
                    }
                }
            }
        }
    </script>
    <style>
    body{
        padding:0;
        margin:0;
        background-color:#666;
        font-family:Courier;
        font-size:10pt;
    }
    #controls{
        position:absolute;
        top:40px;
        left:0;
        bottom:0;
        width:200px;
        border-right:ridge;
        padding:20px;
        background-color:#ddd;
        font-family:serif;
    }
    #pageContainer{
        position: absolute;
        top:40px;
        bottom:0;
        right:0;
        left: 202px;
        
    }
    #page{
        border:1px black solid;
        background-color:white;
        margin:auto;
        margin-top:30px;
        margin-bottom:30px;
        width:600px;
        height:800px;
    }
    #header{
        background-color:#6484DF;
        padding:5px;
        height:29px;
    }
    #title{
        width:200px;
        margin:auto;
        margin-top:270px;
        text-decoration:underline;
    }
    #writtenBy{
        margin-top:25px;
    }
    #address{
        margin-top:60px;
    }
    .left{
        margin-left:60px;
    }
    </style>
</head>
<body onload="update()">
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-16492540-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
<div id="header">
    <input id="saveButton" type="button" value="Save" onclick='save()'>
    <input type="button" value="Close" onclick="closeTitlePage()">
</div>
<div id="container">
    <div id="controls">
        <table cellpadding=0 cellspacing=0>
            <tr><td colspan="2">Title</td></tr>
            <tr><td><input id="title_input" value="{{ title }}"></td></tr>
            <tr><td colspan="2">Author</td></tr>
            <tr><td><input id="authorOne_input" value="{{ authorOne }}"></td></tr>
            <tr><td colspan="2">Second Author (optional)</td></tr>
            <tr>
                <td><input id="authorTwo_input" value="{{ authorTwo }}"></td>
                <td><input id="authorTwo_checkbox" type="checkbox" {{ authorTwoChecked }}></td>
            <tr/>
            <tr><td colspan="2">Third Author (optional)</td></tr>
            <tr>
                <td><input id="authorThree_input" value="{{ authorThree }}"></td>
                <td><input id="authorThree_checkbox" type="checkbox" {{ authorThreeChecked }}></td>
            <tr/>
            <tr><td colspan="2">Based On</td></tr>
            <tr>
                <td><textarea id="based_on_input" rows=3>{{  based_on  }}</textarea></td>
                <td><input id="based_on_checkbox" type="checkbox"{{  based_onChecked  }}></td>
            <tr/>
            <tr><td colspan="2">Address</td></tr>
            <tr>
                <td><textarea id="address_input" rows=5>{{  address  }}</textarea></td>
                <td><input id="address_checkbox" type="checkbox" {{  addressChecked  }}></td>
            <tr/>
            <tr><td colspan="2">Phone</td></tr>
            <tr>
                <td><input id="phone_input" value="{{  phone  }}"></td>
                <td><input id="phone_checkbox" type="checkbox"{{  phoneChecked  }}></td>
            <tr/>
            <tr><td colspan="2">Cell</td></tr>
            <tr>
                <td><input id="cell_input" value="{{  cell  }}"></td>
                <td><input id="cell_checkbox" type="checkbox" {{  cellChecked  }}></td>
            <tr/>
            <tr><td colspan="2">Email</td></tr>
            <tr>
                <td><input id="email_input" value="{{  email  }}"></td>
                <td><input id="email_checkbox" type="checkbox" {{  emailChecked  }}></td>
            <tr/>
            <tr><td colspan="2">Registered</td></tr>
            <tr>
                <td><input id="registered_input" value="{{  registered  }}"></td>
                <td><input id="registered_checkbox" type="checkbox" {{  registeredChecked  }}></td>
            <tr/>
            <tr><td colspan="2">Other</td></tr>
            <tr>
                <td><input id="other_input" value="{{  other  }}"></td>
                <td><input id="other_checkbox" type="checkbox" {{  otherChecked  }}></td>
            <tr/>
        </table>
    </div>
    <div id="pageContainer">
    <div id="page">
        <div id="title" align="center"></div>
        <div id="writtenBy" align="center"></div>
        <br>
        <div id="authorOne" align="center"></div>
        <div id="authorTwo" align="center"></div>
        <div id="authorThree" align="center"></div>
        <br>
        <br>
        <div id="based_on" align="center"></div>
        <div id="address" class="left"></div>
        <br>
        <div id="phone" class="left"><span id="phoneS"></span></div>
        <div id="cell" class="left"><span id="cellS"></span></div>
        <br>
        <div id="email" class="left"></div>
        <br>
        <div id="registered" class="left"></div>
        <div id="other" class="left"></div>
    </div>
    </div>
</div>
</body>
</html>