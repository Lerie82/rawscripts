function uploadWindow(a){if(a.data=="uploading"){document.getElementById("uploadFrame").height="0px";document.getElementById("uploadFrame").width="0px";document.getElementById("uploading").style.display="block"}else{document.getElementById("uploadFrame").style.height="210px";document.getElementById("uploadFrame").style.width="250px";document.getElementById("uploading").style.display="none";window.open(a.data);refreshList()}}function refreshList(){$.post("/list",function(z){document.getElementById("loading").style.display="none";var h=z.split("?shared=")[0];if(h=="?owned=none"){document.getElementById("noentries").style.display="block"}else{var f=document.getElementById("content").childNodes;for(var v=0;v<f.length;v++){f[v].parentNode.removeChild(f[v]);v--}h=h.slice(19);var p=h.split("?scriptname=");for(var v=0;v<p.length;v++){var A=p[v].split("?resource_id=")[0];var c=p[v].split("?resource_id=")[1].split("?alternate_link=")[0];var q=p[v].split("?resource_id=")[1].split("?alternate_link=")[1].split("?updated=")[0];var x=p[v].split("?resource_id=")[1].split("?alternate_link=")[1].split("?updated=")[1].split("?shared_with=")[0];var m=document.getElementById("content").appendChild(document.createElement("div"));m.id="list";var g=m.appendChild(document.createElement("div"));g.id=c;g.className="entry";var w=g.appendChild(document.createElement("table"));var t=w.appendChild(document.createElement("tr"));var a=t.appendChild(document.createElement("td"));a.className="checkboxCell";var o=a.appendChild(document.createElement("input"));o.type="checkbox";o.name="listItems";o.value=c;var b=t.appendChild(document.createElement("td"));var k=b.appendChild(document.createElement("a"));k.id="name"+c;var u='javascript:script("'+c+'")';k.href=u;k.appendChild(document.createTextNode(A));var e=t.appendChild(document.createElement("td"));e.className="sharedCell";e.align="center";var r=t.appendChild(document.createElement("td"));r.className="emailCell";r.align="center";var j=r.appendChild(document.createElement("a"));j.className="emailLink";u='javascript:emailPrompt("'+c+'")';j.href=u;j.appendChild(document.createTextNode("Email"));var n=t.appendChild(document.createElement("td"));n.className="updatedCell";n.align="center";n.appendChild(document.createTextNode(x));var y=t.appendChild(document.createElement("td"));y.className="gdocsCell";y.align="center";var l=y.appendChild(document.createElement("a"));l.href=alertnate_link;l.target="_blank";var s=l.appendChild(document.getElementById("img"));s.src="images/docs.gif";var d=l.appendChild(document.getElementById("img"));d.src="images/popup.png"}}})}function tokenize(){var h=0;var t=document.getElementsByTagName("div");for(var p=0;p<t.length;p++){if(t[p].className=="token"){h++}}if(h>4){alert("You can only have 5 recipients at a time for now. Only the first five will be sent.");return}var a=document.getElementById("recipient");var u=a.value.replace(",","");var r=u.replace(/ /g,"");if(r==""){return}var b=u.split(" ");var n=b.pop();var v="";if(b.length==0){v=n}else{v=b.join(" ").replace(/"/g,"")}var d=document.createElement("div");var f=document.getElementById("recipients").appendChild(d);f.className="token";f.id=n;var e=document.createElement("span");var s=f.appendChild(e);var m=document.createTextNode(v);s.appendChild(m);var e=document.createElement("span");var o=f.appendChild(e);var k=document.createTextNode(n);o.className="mailto";o.appendChild(k);var g=document.createElement("a");var j=f.appendChild(g);var q=document.createTextNode(" | X");j.appendChild(q);var l='javascript:removeToken("'+n+'")';j.setAttribute("href",l);a.value=""}function removeToken(a){var b=document.getElementById(a);b.parentNode.removeChild(b)}function selectAll(d){var c=document.getElementsByTagName("input");var a=d.checked;for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){c[b].checked=a}}}function script(a){url="/editor?resource_id="+a;window.open(url)}function deleteScript(b){var a=document.getElementById(b);a.style.backgroundColor="#ccc";a.style.opacity="0.5";$.post("/delete",{resource_id:b},function(){a.parentNode.removeChild(a)})}function batchProcess(a){var c=document.getElementsByTagName("input");for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].checked==true){if(c[b].name=="listItems"){if(a=="delete"){deleteScript(c[b].value)}}}}}}function emailScript(){tokenize();var b=new Array();var g=document.getElementsByTagName("span");for(var e=0;e<g.length;e++){if(g[e].className=="mailto"){b.push(g[e].innerHTML)}}var a=b.join(",");var d=document.getElementById("subject").value;var f=document.getElementById("message").innerHTML;$.post("/emailscript",{resource_id:resource_id,recipients:a,subject:d,body_message:f,fromPage:"scriptlist"});document.getElementById("emailpopup").style.visibility="hidden";document.getElementById("recipient").value="";document.getElementById("subject").value="";document.getElementById("message").innerHTML="";document.getElementById("recipients").innerHTML=""}var resource_id="";function emailPrompt(a){resource_id=a;document.getElementById("emailpopup").style.visibility="visible"}function hideEmailPrompt(){document.getElementById("emailpopup").style.visibility="hidden";document.getElementById("recipient").value="";document.getElementById("subject").value="";document.getElementById("message").innerHTML="";document.getElementById("recipients").innerHTML=""}function renamePrompt(){var a=0;var c=document.getElementsByTagName("input");for(var b=0;b<c.length;b++){if(c[b].type=="checkbox"){if(c[b].checked==true){if(c[b].name=="listItems"){var d=c[b].value;a++}}}}if(a>1){alert("select one at a time")}else{if(a==1){var e="name"+d;document.getElementById("renameTitle").innerHTML="Rename "+document.getElementById(e).innerHTML;document.getElementById("renameField").value=document.getElementById(e).innerHTML;document.getElementById("renamepopup").style.visibility="visible";document.getElementById("resource_id").value=d}}}function hideRenamePrompt(){document.getElementById("renameField").value="";document.getElementById("renamepopup").style.visibility="hidden"}function renameScript(){var b=document.getElementById("resource_id").value;var a=document.getElementById("renameField").value;if(a==""){return}var c="name"+b;document.getElementById(c).innerHTML=a;$.post("/rename",{resource_id:b,rename:a,fromPage:"scriptlist"});hideRenamePrompt()}function uploadPrompt(){document.getElementById("uploadpopup").style.visibility="visible"}function hideUploadPrompt(){document.getElementById("uploadFrame").src="/convert";document.getElementById("uploadpopup").style.visibility="hidden"}function titleChange(){var a=document.getElementById("script").value;var b=a.replace(".celtx","");document.getElementById("hidden").value=b}function uploadScript(){var b=document.getElementById("script").files[0].getAsBinary();var a=document.getElementById("filename");$.post("/convertprocess",{script:b,filename:a})}function newScriptPrompt(){document.getElementById("newscriptpopup").style.visibility="visible"}function hideNewScriptPrompt(){document.getElementById("newScript").value="";document.getElementById("newscriptpopup").style.visibility="hidden"}function createScript(){var a=document.getElementById("newScript").value;if(a!=""){var b="/loading?filename="+a;window.open(b)}hideNewScriptPrompt();setTimeout("refreshList()",10000)}function hideExportPrompt(){document.getElementById("exportpopup").style.visibility="hidden";document.getElementById("exportList").innerHTML=""}function exportPrompt(){var a=0;var b=document.getElementsByTagName("input");for(var d=0;d<b.length;d++){if(b[d].type=="checkbox"){if(b[d].checked==true){if(b[d].name=="listItems"){var h=document.createElement("tr");var j=document.getElementById("exportList").appendChild(h);var k=j.appendChild(document.createElement("td"));var c=document.createTextNode(document.getElementById("name"+b[d].value).innerHTML);k.appendChild(c);k=j.appendChild(document.createElement("td"));var g=document.createElement("select");var f=k.appendChild(g);f.name=b[d].value;var e=f.appendChild(document.createElement("option"));e.appendChild(document.createTextNode("Adobe PDF"));e=f.appendChild(document.createElement("option"));e.appendChild(document.createTextNode(".txt (for Celtx or FD)"));a++}}}}if(a>0){document.getElementById("exportpopup").style.visibility="visible"}}function exportScripts(){var d;var c;var a=document.getElementsByTagName("select");for(var b=0;b<a.length;b++){d=a[b].name;if(a[b].selectedIndex==0){c="pdf"}else{c="txt"}url="/export?resource_id="+d+"&export_format="+c+"&fromPage=scriptlist";window.open(url)}hideExportPrompt()};